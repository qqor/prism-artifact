[2;36m[01/06/26 18:20:34][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=2602;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=850187;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpbgkl8xdg[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-delta-01_vuln_9/[0m[95magent[0m [2m               [0m
[2;36m                    [0m         [95m-output-1767723634.7804425[0m                                                           [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-no-delta/tika_tk-delta-01_vuln_9.toml   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=247311;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=639582;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:22:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Took [1;36m93.24[0m  ]8;id=360921;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=872856;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=576254;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=711086;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=918958;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=397594;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=981614;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=71587;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m93[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=793974;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=764460;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.89[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=269527;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=863422;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/06/26 18:22:10][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=159389;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=296022;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=60839;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=608407;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=781508;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=512954;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=704200;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=40262;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:22:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.18[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=114209;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=771027;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/06/26 18:22:12][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=664129;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=803584;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:22:13][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.89[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=133297;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=635728;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/06/26 18:22:24][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=632411;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=657471;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.jav[1;92ma:63[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.Runtime.exec[0m[1m([0mRuntime.jav[1;92ma:594[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.Runtime.exec[0m[1m([0mRuntime.jav[1;92ma:453[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1m([0mExternalParser.jav[1;92ma:314[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1m([0mExternalParser.jav[1;92ma:274[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1m([0mParserDecorator.jav[1;92ma:153[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1m([0mDelegatingParser.jav[1;92ma:71[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mParsingEmb [2m                [0m
[2;36m                    [0m         eddedDocumentExtractor.jav[1;92ma:101[0m[1m)[0m                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1m([0mHtmlHandler.jav[1;92ma:377[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1m([0mHtmlHandler.jav[1;92ma:175[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1m([0mContentHandlerDecorator.ja [2m                [0m
[2;36m                    [0m         v[1;92ma:125[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1m([0mXHTMLDowngradeHandle [2m                [0m
[2;36m                    [0m         r.jav[1;92ma:59[0m[1m)[0m                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.parser.html.JSoupParser$[1;35mTikaNodeFilter.head[0m[1m([0mJSoupParser.jav[1;92ma:211[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.jsoup.select.NodeTraversor.filter[0m[1m([0mNodeTraversor.jav[1;92ma:92[0m[1m)[0m             [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1m([0mJSoupParser.jav[1;92ma:137[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1m([0mHtmlParserFuzzer.jav[1;92ma:69[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1m([0mHtmlParserFuzzer.jav[1;92ma:40[0m[1m)[0m           [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 3c99eeb1380e104c                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.jav[1;92ma:63[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.Runtime.exec[0m[1m([0mRuntime.jav[1;92ma:594[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.Runtime.exec[0m[1m([0mRuntime.jav[1;92ma:453[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1m([0mExternalParser.jav[1;92ma:314[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1m([0mExternalParser.jav[1;92ma:274[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1m([0mParserDecorator.jav[1;92ma:153[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1m([0mDelegatingParser.jav[1;92ma:71[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mParsingEmb [2m                [0m
[2;36m                    [0m         eddedDocumentExtractor.jav[1;92ma:101[0m[1m)[0m                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1m([0mHtmlHandler.jav[1;92ma:377[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1m([0mHtmlHandler.jav[1;92ma:175[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1m([0mContentHandlerDecorator.ja [2m                [0m
[2;36m                    [0m         v[1;92ma:125[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1m([0mXHTMLDowngradeHandle [2m                [0m
[2;36m                    [0m         r.jav[1;92ma:59[0m[1m)[0m                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.parser.html.JSoupParser$[1;35mTikaNodeFilter.head[0m[1m([0mJSoupParser.jav[1;92ma:211[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.jsoup.select.NodeTraversor.filter[0m[1m([0mNodeTraversor.jav[1;92ma:92[0m[1m)[0m             [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1m([0mJSoupParser.jav[1;92ma:137[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1m([0mHtmlParserFuzzer.jav[1;92ma:69[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1m([0mHtmlParserFuzzer.jav[1;92ma:40[0m[1m)[0m           [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 3c99eeb1380e104c                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 18:22:41][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=196899;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=829658;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 18:28:49][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=380759;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=730659;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/06/26 18:30:29][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=408606;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=905263;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=196341;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=507480;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:30:30][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.97[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=902422;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=913432;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/06/26 18:30:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=443200;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=288714;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmplg6g540i[0m                                                 ]8;id=37433;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=822517;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/06/26 18:31:13][0m[2;36m [0m[1;31mERROR   [0m Failed to build the challenge                                                         ]8;id=743349;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=212972;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#53\[2m53[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-delta-01_vuln_9/agent[0m ]8;id=325941;file:///home/user/crete/packages/crete/framework/agent/functions.py\[2mfunctions.py[0m]8;;\[2m:[0m]8;id=29869;file:///home/user/crete/packages/crete/framework/agent/functions.py#17\[2m17[0m]8;;\
[2;36m                    [0m         [35m-output-1767723634.7804425/[0m[95mbuild_failed_stdout.txt[0m: [35m/[0m[95msrc[0m [35m/src/project-parent/[0m[95mtika[0m    [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/[0m[95mtika[0m                                                             [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         [33mCC[0m=[35mclang[0m                                                                             [2m               [0m
[2;36m                    [0m         [33mCXX[0m=[35mclang[0m++                                                                          [2m               [0m
[2;36m                    [0m         [33mCFLAGS[0m=-O1   -fno-omit-frame-pointer   -gline-tables-only                            [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35menum[0m-constexpr-conversion                                                 [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mincompatible[0m-function-pointer-types   -Wno-[33merror[0m=[35mint[0m-conversion           [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mdeprecated[0m-declarations   -Wno-[33merror[0m=[35mimplicit[0m-function-declaration        [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mimplicit[0m-int   -Wno-[33merror[0m=[35mvla[0m-cxx-extension                               [2m               [0m
[2;36m                    [0m         -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -[33mfsanitize[0m=[35maddress[0m                        [2m               [0m
[2;36m                    [0m         -fsanitize-address-use-after-scope -[33mfsanitize[0m=[35mfuzzer[0m-no-link -fno-[33msanitize[0m=[35mleak[0m      [2m               [0m
[2;36m                    [0m         [33mCXXFLAGS[0m=-O1   -fno-omit-frame-pointer   -gline-tables-only                          [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35menum[0m-constexpr-conversion                                                 [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mincompatible[0m-function-pointer-types   -Wno-[33merror[0m=[35mint[0m-conversion           [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mdeprecated[0m-declarations   -Wno-[33merror[0m=[35mimplicit[0m-function-declaration        [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mimplicit[0m-int   -Wno-[33merror[0m=[35mvla[0m-cxx-extension                               [2m               [0m
[2;36m                    [0m         -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -[33mfsanitize[0m=[35maddress[0m                        [2m               [0m
[2;36m                    [0m         -fsanitize-address-use-after-scope -[33mfsanitize[0m=[35mfuzzer[0m-no-link -[33mstdlib[0m=[35mlibc[0m++          [2m               [0m
[2;36m                    [0m         -fno-[33msanitize[0m=[35mleak[0m                                                                   [2m               [0m
[2;36m                    [0m         [33mRUSTFLAGS[0m=--cfg fuzzing -[33mZsanitizer[0m=[35maddress[0m -[33mCdebuginfo[0m=[1;36m1[0m -Cforce-frame-pointers     [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         + [33m__REAL_MAVEN_REPO[0m=[35m/root/.m2/[0m[95mrepository[0m                                             [2m               [0m
[2;36m                    [0m         + [33m__SHARED_MAVEN_REPO[0m=[35m/work/[0m[95mmavencache[0m                                               [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -L [35m/root/.m2/[0m[95mrepository[0m [32m'[0m[32m][0m[32m'[0m                                                [2m               [0m
[2;36m                    [0m         + unset __REAL_MAVEN_REPO                                                            [2m               [0m
[2;36m                    [0m         + unset __SHARED_MAVEN_REPO                                                          [2m               [0m
[2;36m                    [0m         + [33mPROJECT[0m=[35mtika[0m                                                                       [2m               [0m
[2;36m                    [0m         + [33mMAIN_REPOSITORY[0m=[4;94mhttps[0m[4;94m://github.com/apache/tika/[0m                                    [2m               [0m
[2;36m                    [0m         + [33mMAVEN_ARGS[0m=[32m'-Djavac.src.[0m[32mversion[0m[32m=[0m[32m17[0m[32m -Djavac.target.[0m[32mversion[0m[32m=[0m[32m17[0m[32m -DskipTests [0m          [2m               [0m
[2;36m                    [0m         [32m-Dcheckstyle.skip -Dossindex.skip -am -pl :tika-app'[0m                                 [2m               [0m
[2;36m                    [0m         + cd [35m/src/[0m[95mproject-parent[0m                                                             [2m               [0m
[2;36m                    [0m         + set_project_version_in_fuzz_targets_dependency                                     [2m               [0m
[2;36m                    [0m         ++ cd tika                                                                           [2m               [0m
[2;36m                    [0m         ++ [35m/src/maven/apache-maven-3.9.9/bin/[0m[95mmvn[0m                                             [2m               [0m
[2;36m                    [0m         org.apache.maven.plugins:maven-help-plugin:[1;36m3.2[0m.[1;92m0:e[0mvaluate                            [2m               [0m
[2;36m                    [0m         -[33mDexpression[0m=[35mproject[0m.version -q -DforceStdout                                        [2m               [0m
[2;36m                    [0m         + [33mPROJECT_VERSION[0m=[1;36m4[0m[1;36m.0[0m.[1;36m0[0m-SNAPSHOT                                                     [2m               [0m
[2;36m                    [0m         + cd fuzz-targets                                                                    [2m               [0m
[2;36m                    [0m         + [35m/src/maven/apache-maven-3.9.9/bin/[0m[95mmvn[0m versions:use-dep-version                     [2m               [0m
[2;36m                    [0m         -[33mDexcludes[0m=[35mcom[0m.code-intelligence:jazzer -[33mDdepVersion[0m=[1;36m4[0m[1;36m.0[0m.[1;36m0[0m-SNAPSHOT                  [2m               [0m
[2;36m                    [0m         -[33mDforceVersion[0m=[35mtrue[0m                                                                  [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Scanning for projects[33m...[0m                                                      [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m                                                                               [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m ----------------------[1m<[0m[39m com.fuzzer:fuzz-targets >-----------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building fuzz [0m[1;36m0.0[0m[39m.[0m[1;36m1[0m[39m-SNAPSHOT[0m                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from pom.xml[0m                                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m jar [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- versions:[0m[1;36m2.20[0m[39m.[0m[1;36m1[0m[39m:use-dep-version [0m[1;39m([0m[39mdefault-cli[0m[1;39m)[0m[39m @ fuzz-targets ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Updated org.apache.tika:tika-app:jar:[0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT to version [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD SUCCESS[0m                                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m0.697[0m[39m s[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-06T[0m[1;92m18:30:38[0m[39mZ[0m                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [39m+ cd tika[0m                                                                            [2m               [0m
[2;36m                    [0m         [39m+ [0m[35m/src/maven/apache-maven-3.9.9/bin/[0m[95mmvn[0m[39m install -Djavac.src.[0m[33mversion[0m[39m=[0m[1;36m17[0m[39m [0m              [2m               [0m
[2;36m                    [0m         [39m-Djavac.target.[0m[33mversion[0m[39m=[0m[1;36m17[0m[39m -DskipTests -Dcheckstyle.skip -Dossindex.skip -am -pl [0m     [2m               [0m
[2;36m                    [0m         [39m:tika-app -Dmaven.repo.[0m[33mlocal[0m[39m=[0m[35m/out/[0m[95mm2[0m                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for projects[0m[33m...[0m                                                      [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Build Order:[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent                                                 [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core                                                [0m[1;39m[[0m[39mbundle[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization                                          [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules                                         [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package                    [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules                                [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module                                    [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module                               [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons                                           [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module                                    [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module                                [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module                                   [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons                                         [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module              [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module                                  [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers                                               [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package                                [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP                                                 [0m[1;39m[[0m[39mbundle[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection                                     [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons                                [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect                                   [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes                                                  [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters                                               [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI                                              [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------< org.apache.tika:tika-parent >---------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT                        [0m[1;39m[[0m[1;36m1[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from pom.xml[0m                                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m pom [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-parent ---[0m               [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; POM module[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-parent ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-parent ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-parent ---[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m1[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ tika-parent ---[0m         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ tika-parent ---[0m        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-parent ---[0m                       [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parent ---[0m                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ tika-parent [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:report [0m[1;39m([0m[39mreport[0m[1;39m)[0m[39m @ tika-parent ---[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:check [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parent ---[0m                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping execution for packaging [0m[32m"pom"[0m                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:testCheck [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parent ---[0m                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping execution for packaging [0m[32m"pom"[0m                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- install:[0m[1;36m3.1[0m[39m.[0m[1;36m4[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ tika-parent ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m[35m/src/project-parent/tika/tika-parent/[0m[95mpom.xml[0m[39m to [0m                   [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parent/4.0.0-SNAPSHOT/[0m[95mtika-parent-4.0.0-SNAPSHOT.pom[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ---------------------< org.apache.tika:tika-core >----------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika core [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT                          [0m[1;39m[[0m[1;36m2[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from [0m[35m/src/project-parent/tika/tika-core/[0m[95mpom.xml[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------[0m[1;39m[[0m[39m bundle [0m[1;39m][0m[39m-------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-core ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; configured[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-core ---[0m            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-core ---[0m             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-core ---[0m                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m1[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ tika-core ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ tika-core ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-core ---[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-core ---[0m                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ tika-core ---[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying appended resource: META-INF/LICENSE[0m                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:resources [0m[1;39m([0m[39mdefault-resources[0m[1;39m)[0m[39m @ tika-core ---[0m             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m5[0m[39m resources from src/main/resources to target/classes[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m @ tika-core ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed source code.[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m361[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m      [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/config/[0m[95mpackage-info[0m [2m               [0m
[2;36m                    [0m         [95m.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m         [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mpackage-info[0m [2m               [0m
[2;36m                    [0m         [95m.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m         [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/exception/[0m[95mpackage-i[0m [2m               [0m
[2;36m                    [0m         [95mnfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m      [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mpackage-i[0m [2m               [0m
[2;36m                    [0m         [95mnfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m      [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/fork/[0m[95mpackage-info.j[0m [2m               [0m
[2;36m                    [0m         [95mava[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated[0m [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/io/[0m[95mpackage-info.jav[0m [2m               [0m
[2;36m                    [0m         [95ma[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated [0m  [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/metadata/[0m[95mpackage-in[0m [2m               [0m
[2;36m                    [0m         [95mfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m       [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/mime/[0m[95mpackage-info.j[0m [2m               [0m
[2;36m                    [0m         [95mava[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated[0m [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/[0m[95mpackage-info.java[0m[39m:[0m[1;39m[[0m [2m               [0m
[2;36m                    [0m         [1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated and [0m [2m               [0m
[2;36m                    [0m         [39mmarked for removal[0m                                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/external/[0m[95mpac[0m [2m               [0m
[2;36m                    [0m         [95mkage-info.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been[0m [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mpackage-info[0m [2m               [0m
[2;36m                    [0m         [95m.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m         [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/sax/[0m[95mpackage-info.ja[0m [2m               [0m
[2;36m                    [0m         [95mva[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated [0m [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/sax/xpath/[0m[95mpackage-i[0m [2m               [0m
[2;36m                    [0m         [95mnfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m      [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/utils/[0m[95mpackage-info.[0m [2m               [0m
[2;36m                    [0m         [95mjava[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m          [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/io/[0m[95mTikaInputStream.[0m [2m               [0m
[2;36m                    [0m         [95mjava[0m[39m:[0m[1;39m[[0m[1;36m342[0m[39m,[0m[1;36m36[0m[1;39m][0m[39m [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m in [0m                         [2m               [0m
[2;36m                    [0m         [39morg.apache.commons.io.input.UnsynchronizedByteArrayInputStream has been deprecated[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mDefaultDetec[0m [2m               [0m
[2;36m                    [0m         [95mtor.java[0m[39m:[0m[1;39m[[0m[1;36m97[0m[39m,[0m[1;36m37[0m[1;39m][0m[39m org.apache.tika.detect.OverrideDetector in org.apache.tika.detect [0m  [2m               [0m
[2;36m                    [0m         [39mhas been deprecated[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/mime/[0m[95mProbabilisticM[0m [2m               [0m
[2;36m                    [0m         [95mimeDetectionSelector.java[0m[39m:[0m[1;39m[[0m[1;36m162[0m[39m,[0m[1;36m36[0m[1;39m][0m[39m [0m[1;35mgetMimeType[0m[1;39m([0m[39mjava.lang.String[0m[1;39m)[0m[39m in [0m                 [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.mime.MimeTypes has been deprecated[0m                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mXmlRootExtra[0m [2m               [0m
[2;36m                    [0m         [95mctor.java[0m[39m:[0m[1;39m[[0m[1;36m46[0m[39m,[0m[1;36m43[0m[1;39m][0m[39m [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m in [0m                     [2m               [0m
[2;36m                    [0m         [39morg.apache.commons.io.input.UnsynchronizedByteArrayInputStream has been deprecated[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/embedder/[0m[95mExternalEm[0m [2m               [0m
[2;36m                    [0m         [95mbedder.java[0m[39m:[0m[1;39m[[0m[1;36m428[0m[39m,[0m[1;36m72[0m[1;39m][0m[39m [0m[1;35mget[0m[1;39m([0m[39mjava.io.File[0m[1;39m)[0m[39m in org.apache.tika.io.TikaInputStream has [0m    [2m               [0m
[2;36m                    [0m         [39mbeen deprecated[0m                                                                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParserCon[0m [2m               [0m
[2;36m                    [0m         [95mtainerExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m128[0m[39m,[0m[1;36m61[0m[1;39m][0m[39m [0m[1;35mget[0m[1;39m([0m[39mjava.io.File[0m[1;39m)[0m[39m in [0m                                  [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.io.TikaInputStream has been deprecated[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/mime/[0m[95mMimeTypesReade[0m [2m               [0m
[2;36m                    [0m         [95mr.java[0m[39m:[0m[1;39m[[0m[1;36m257[0m[39m,[0m[1;36m32[0m[1;39m][0m[39m [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m in [0m                       [2m               [0m
[2;36m                    [0m         [39morg.apache.commons.io.input.UnsynchronizedByteArrayInputStream has been deprecated[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/config/[0m[95mServiceLoade[0m [2m               [0m
[2;36m                    [0m         [95mr.java[0m[39m: Some input files use unchecked or unsafe operations.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/config/[0m[95mServiceLoade[0m [2m               [0m
[2;36m                    [0m         [95mr.java[0m[39m: Recompile with -Xlint:unchecked for details.[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:testResources [0m[1;39m([0m[39mdefault-testResources[0m[1;39m)[0m[39m @ tika-core ---[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m122[0m[39m resources from src/test/resources to target/test-classes[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/test-classes[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;36m0[0m[39m:testCompile [0m[1;39m([0m[39mdefault-testCompile[0m[1;39m)[0m[39m @ tika-core ---[0m         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed dependency.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m95[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m       [2m               [0m
[2;36m                    [0m         [39mtarget/test-classes[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/test/java/org/apache/tika/mime/[0m[95mMimeTypesReade[0m [2m               [0m
[2;36m                    [0m         [95mrTest.java[0m[39m:[0m[1;39m[[0m[1;36m294[0m[39m,[0m[1;36m37[0m[1;39m][0m[39m [0m[1;35mgetMimeType[0m[1;39m([0m[39mjava.lang.String[0m[1;39m)[0m[39m in org.apache.tika.mime.MimeTypes [0m [2m               [0m
[2;36m                    [0m         [39mhas been deprecated[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/test/java/org/apache/tika/mime/[0m[95mMimeTypesReade[0m [2m               [0m
[2;36m                    [0m         [95mrTest.java[0m[39m:[0m[1;39m[[0m[1;36m302[0m[39m,[0m[1;36m37[0m[1;39m][0m[39m [0m[1;35mgetMimeType[0m[1;39m([0m[39mjava.lang.String[0m[1;39m)[0m[39m in org.apache.tika.mime.MimeTypes [0m [2m               [0m
[2;36m                    [0m         [39mhas been deprecated[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/test/java/org/apache/tika/parser/[0m[95mParserDecora[0m [2m               [0m
[2;36m                    [0m         [95mtorTest.java[0m[39m:[0m[1;39m[[0m[1;36m117[0m[39m,[0m[1;36m28[0m[1;39m][0m[39m [0m[1;35mwithFallbacks[0m[1;39m([0m[39mjava.util.Collection<? extends [0m                  [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.parser.Parser>,java.util.Set<org.apache.tika.mime.MediaType>[0m[1;39m)[0m[39m in [0m    [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.parser.ParserDecorator has been deprecated[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/test/java/org/apache/tika/utils/[0m[95mServiceLoader[0m [2m               [0m
[2;36m                    [0m         [95mUtilsTest.java[0m[39m:[0m[1;39m[[0m[1;36m45[0m[39m,[0m[1;36m48[0m[1;39m][0m[39m org.apache.tika.detect.OverrideDetector in [0m                   [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.detect has been deprecated[0m                                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/test/java/org/apache/tika/metadata/writefilte[0m [2m               [0m
[2;36m                    [0m         [35mr/[0m[95mStandardWriteFilterTest.java[0m[39m: [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/test/java/org/apache/tika/metadata/writefilte[0m [2m               [0m
[2;36m                    [0m         [35mr/[0m[95mStandardWriteFilterTest.java[0m[39m uses unchecked or unsafe operations.[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/test/java/org/apache/tika/metadata/writefilte[0m [2m               [0m
[2;36m                    [0m         [35mr/[0m[95mStandardWriteFilterTest.java[0m[39m: Recompile with -Xlint:unchecked for details.[0m         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- surefir[0m[1;92me:3[0m[39m.[0m[1;36m5.3[0m[39m:test [0m[1;39m([0m[39mdefault-test[0m[1;39m)[0m[39m @ tika-core ---[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Tests are skipped.[0m                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:report [0m[1;39m([0m[39mreport[0m[1;39m)[0m[39m @ tika-core ---[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- bundl[0m[1;92me:6[0m[39m.[0m[1;36m0.0[0m[39m:bundle [0m[1;39m([0m[39mdefault-bundle[0m[1;39m)[0m[39m @ tika-core ---[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building bundle: [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/target/[0m[95mtika-core-4.0.0-SNAPSHOT.jar[0m               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Writing manifest: [0m                                                            [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/target/classes/META-INF/[0m[95mMANIFEST.MF[0m               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jar:[0m[1;36m3.4[0m[39m.[0m[1;36m2[0m[39m:test-jar [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-core ---[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building jar: [0m                                                                [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/target/[0m[95mtika-core-4.0.0-SNAPSHOT-tests.jar[0m         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- assembly:[0m[1;36m3.7[0m[39m.[0m[1;36m1[0m[39m:single [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-core ---[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading assembly descriptor: src/main/assembly/test-jar-with-dependencies.xml[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building jar: [0m                                                                [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/target/[0m[95mtika-core-4.0.0-SNAPSHOT-test-jar-with-dep[0m [2m               [0m
[2;36m                    [0m         [95mendencies.jar[0m                                                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- fails[0m[1;92mafe:3[0m[39m.[0m[1;36m5.3[0m[39m:integration-test [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-core ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Tests are skipped.[0m                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:check [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-core ---[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for classes to check[0m[33m...[0m                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-unsafe-[0m[1;36m17[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-deprecated-[0m[1;36m17[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-non-portable[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-internal-[0m[1;36m17[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: commons-io-unsafe-[0m[1;36m2.11[0m[39m.[0m[1;36m0[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Loading classes to check[0m[33m...[0m                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning classes for violations[0m[33m...[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanned [0m[1;36m456[0m[39m class [0m[1;35mfile[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m for forbidden API invocations [0m[1;39m([0m[39min [0m[1;36m0.[0m[39m24s[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m [0m        [2m               [0m
[2;36m                    [0m         [1;35merror[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m.[0m                                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:testCheck [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-core ---[0m                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for classes to check[0m[33m...[0m                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-unsafe-[0m[1;36m17[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-deprecated-[0m[1;36m17[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-non-portable[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-internal-[0m[1;36m17[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: commons-io-unsafe-[0m[1;36m2.11[0m[39m.[0m[1;36m0[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Loading classes to check[0m[33m...[0m                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning classes for violations[0m[33m...[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanned [0m[1;36m131[0m[39m class [0m[1;35mfile[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m for forbidden API invocations [0m[1;39m([0m[39min [0m[1;36m0.[0m[39m08s[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m [0m        [2m               [0m
[2;36m                    [0m         [1;35merror[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m.[0m                                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- fails[0m[1;92mafe:3[0m[39m.[0m[1;36m5.3[0m[39m:verify [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-core ---[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Tests are skipped.[0m                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- install:[0m[1;36m3.1[0m[39m.[0m[1;36m4[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ tika-core ---[0m                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m[35m/src/project-parent/tika/tika-core/[0m[95mpom.xml[0m[39m to [0m                     [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-core/4.0.0-SNAPSHOT/[0m[95mtika-core-4.0.0-SNAPSHOT.pom[0m        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/target/[0m[95mtika-core-4.0.0-SNAPSHOT.jar[0m[39m to [0m           [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-core/4.0.0-SNAPSHOT/[0m[95mtika-core-4.0.0-SNAPSHOT.jar[0m        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/target/[0m[95mtika-core-4.0.0-SNAPSHOT-tests.jar[0m[39m to [0m     [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-core/4.0.0-SNAPSHOT/[0m[95mtika-core-4.0.0-SNAPSHOT-tests.jar[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/target/[0m[95mtika-core-4.0.0-SNAPSHOT-test-jar-with-dep[0m [2m               [0m
[2;36m                    [0m         [95mendencies.jar[0m[39m to [0m                                                                    [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-core/4.0.0-SNAPSHOT/[0m[95mtika-core-4.0.0-SNAPSHOT-test-jar-w[0m [2m               [0m
[2;36m                    [0m         [95mith-dependencies.jar[0m                                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- bundl[0m[1;92me:6[0m[39m.[0m[1;36m0.0[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ tika-core ---[0m                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Writing OBR metadata[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [39morg/apache/tika/tika-core/[0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT/tika-core-[0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT.jar[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [39morg/apache/tika/tika-core/[0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT/tika-core-[0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT-test-jar-with-depe[0m [2m               [0m
[2;36m                    [0m         [39mndencies.jar[0m                                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Writing OBR metadata[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -----------------< org.apache.tika:tika-serialization >-----------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika serialization [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT                 [0m[1;39m[[0m[1;36m3[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from [0m[35m/src/project-parent/tika/tika-serialization/[0m[95mpom.xml[0m                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m jar [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-serialization ---[0m        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; configured[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-serialization ---[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-serialization ---[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-serialization ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ tika-serialization ---[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ tika-serialization ---[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-serialization ---[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-serialization ---[0m            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ [0m              [2m               [0m
[2;36m                    [0m         [39mtika-serialization ---[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:resources [0m[1;39m([0m[39mdefault-resources[0m[1;39m)[0m[39m @ tika-serialization ---[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m skip non existing resourceDirectory [0m                                          [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-serialization/src/main/[0m[95mresources[0m                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m @ tika-serialization ---[0m        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed dependency.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m12[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m       [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-serialization/src/main/java/org/apache/tika/serializat[0m [2m               [0m
[2;36m                    [0m         [35mion/[0m[95mParseContextDeserializer.java[0m[39m:[0m[1;39m[[0m[1;36m51[0m[39m,[0m[1;36m63[0m[1;39m][0m[39m [0m[1;35mfields[0m[1;39m([0m[1;39m)[0m[39m in [0m                               [2m               [0m
[2;36m                    [0m         [39mcom.fasterxml.jackson.databind.JsonNode has been deprecated[0m                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-serialization/src/main/java/org/apache/tika/serializat[0m [2m               [0m
[2;36m                    [0m         [35mion/[0m[95mTikaJsonDeserializer.java[0m[39m:[0m[1;39m[[0m[1;36m66[0m[39m,[0m[1;36m60[0m[1;39m][0m[39m [0m[1;35mfields[0m[1;39m([0m[1;39m)[0m[39m in [0m                                   [2m               [0m
[2;36m                    [0m         [39mcom.fasterxml.jackson.databind.JsonNode has been deprecated[0m                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-serialization/src/main/java/org/apache/tika/serializat[0m [2m               [0m
[2;36m                    [0m         [35mion/[0m[95mTikaJsonDeserializer.java[0m[39m:[0m[1;39m[[0m[1;36m217[0m[39m,[0m[1;36m56[0m[1;39m][0m[39m [0m[1;35mfields[0m[1;39m([0m[1;39m)[0m[39m in [0m                                  [2m               [0m
[2;36m                    [0m         [39mcom.fasterxml.jackson.databind.JsonNode has been deprecated[0m                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-serialization/src/main/java/org/apache/tika/serializat[0m [2m               [0m
[2;36m                    [0m         [35mion/pipes/[0m[95mJsonFetchEmitTuple.java[0m[39m:[0m[1;39m[[0m[1;36m100[0m[39m,[0m[1;36m64[0m[1;39m][0m[39m [0m[1;35mfields[0m[1;39m([0m[1;39m)[0m[39m in [0m                              [2m               [0m
[2;36m                    [0m         [39mcom.fasterxml.jackson.databind.JsonNode has been deprecated[0m                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-serialization/src/main/java/org/apache/tika/serializat[0m [2m               [0m
[2;36m                    [0m         [35mion/[0m[95mParseContextSerializer.java[0m[39m: Some input files use unchecked or unsafe [0m           [2m               [0m
[2;36m                    [0m         [39moperations.[0m                                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-serialization/src/main/java/org/apache/tika/serializat[0m [2m               [0m
[2;36m                    [0m         [35mion/[0m[95mParseContextSerializer.java[0m[39m: Recompile with -Xlint:unchecked for details.[0m        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:testResources [0m[1;39m([0m[39mdefault-testResources[0m[1;39m)[0m[39m @ [0m                  [2m               [0m
[2;36m                    [0m         [39mtika-serialization ---[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m1[0m[39m resource from src/test/resources to target/test-classes[0m             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/test-classes[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;36m0[0m[39m:testCompile [0m[1;39m([0m[39mdefault-testCompile[0m[1;39m)[0m[39m @ tika-serialization [0m   [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed dependency.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m9[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m        [2m               [0m
[2;36m                    [0m         [39mtarget/test-classes[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- surefir[0m[1;92me:3[0m[39m.[0m[1;36m5.3[0m[39m:test [0m[1;39m([0m[39mdefault-test[0m[1;39m)[0m[39m @ tika-serialization ---[0m               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Tests are skipped.[0m                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:report [0m[1;39m([0m[39mreport[0m[1;39m)[0m[39m @ tika-serialization ---[0m                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jar:[0m[1;36m3.4[0m[39m.[0m[1;36m2[0m[39m:jar [0m[1;39m([0m[39mdefault-jar[0m[1;39m)[0m[39m @ tika-serialization ---[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building jar: [0m                                                                [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-serialization/target/[0m[95mtika-serialization-4.0.0-SNAPSHOT[0m [2m               [0m
[2;36m                    [0m         [95m.jar[0m                                                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jar:[0m[1;36m3.4[0m[39m.[0m[1;36m2[0m[39m:test-jar [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-serialization ---[0m                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building jar: [0m                                                                [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-serialization/target/[0m[95mtika-serialization-4.0.0-SNAPSHOT[0m [2m               [0m
[2;36m                    [0m         [95m-tests.jar[0m                                                                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:check [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-serialization ---[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for classes to check[0m[33m...[0m                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-unsafe-[0m[1;36m17[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-deprecated-[0m[1;36m17[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-non-portable[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-internal-[0m[1;36m17[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: commons-io-unsafe-[0m[1;36m2.11[0m[39m.[0m[1;36m0[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Loading classes to check[0m[33m...[0m                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning classes for violations[0m[33m...[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanned [0m[1;36m12[0m[39m class [0m[1;35mfile[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m for forbidden API invocations [0m[1;39m([0m[39min [0m[1;36m0.[0m[39m07s[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m [0m         [2m               [0m
[2;36m                    [0m         [1;35merror[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m.[0m                                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:testCheck [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-serialization ---[0m            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for classes to check[0m[33m...[0m                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-unsafe-[0m[1;36m17[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-deprecated-[0m[1;36m17[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-non-portable[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-internal-[0m[1;36m17[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: commons-io-unsafe-[0m[1;36m2.11[0m[39m.[0m[1;36m0[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Loading classes to check[0m[33m...[0m                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning classes for violations[0m[33m...[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanned [0m[1;36m9[0m[39m class [0m[1;35mfile[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m for forbidden API invocations [0m[1;39m([0m[39min [0m[1;36m0.[0m[39m03s[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m [0m[1;35merror[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m.[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- install:[0m[1;36m3.1[0m[39m.[0m[1;36m4[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ tika-serialization ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m[35m/src/project-parent/tika/tika-serialization/[0m[95mpom.xml[0m[39m to [0m            [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-serialization/4.0.0-SNAPSHOT/[0m[95mtika-serialization-4.0.0-S[0m [2m               [0m
[2;36m                    [0m         [95mNAPSHOT.pom[0m                                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-serialization/target/[0m[95mtika-serialization-4.0.0-SNAPSHOT[0m [2m               [0m
[2;36m                    [0m         [95m.jar[0m[39m to [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-serialization/4.0.0-SNAPSHOT/[0m[95mtika-serialization-4.0.0-S[0m [2m               [0m
[2;36m                    [0m         [95mNAPSHOT.jar[0m                                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-serialization/target/[0m[95mtika-serialization-4.0.0-SNAPSHOT[0m [2m               [0m
[2;36m                    [0m         [95m-tests.jar[0m[39m to [0m                                                                       [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-serialization/4.0.0-SNAPSHOT/[0m[95mtika-serialization-4.0.0-S[0m [2m               [0m
[2;36m                    [0m         [95mNAPSHOT-tests.jar[0m                                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------< org.apache.tika:tika-parsers >--------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika parser modules [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT                [0m[1;39m[[0m[1;36m4[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from [0m[35m/src/project-parent/tika/tika-parsers/[0m[95mpom.xml[0m                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m pom [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-parsers ---[0m              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; POM module[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-parsers ---[0m         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-parsers ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-parsers ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ tika-parsers ---[0m        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ tika-parsers ---[0m       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-parsers ---[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parsers ---[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ tika-parsers [0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:report [0m[1;39m([0m[39mreport[0m[1;39m)[0m[39m @ tika-parsers ---[0m                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:check [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parsers ---[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping execution for packaging [0m[32m"pom"[0m                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:testCheck [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parsers ---[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping execution for packaging [0m[32m"pom"[0m                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- install:[0m[1;36m3.1[0m[39m.[0m[1;36m4[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ tika-parsers ---[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m[35m/src/project-parent/tika/tika-parsers/[0m[95mpom.xml[0m[39m to [0m                  [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parsers/4.0.0-SNAPSHOT/[0m[95mtika-parsers-4.0.0-SNAPSHOT.pom[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ---------------< org.apache.tika:tika-parsers-standard >----------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika standard parser modules and package [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT [0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m5[0m[39m/[0m[1;36m40[0m[1;39m][0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from [0m[35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/[0m[95mpom.xml[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m pom [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-parsers-standard ---[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; POM module[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-parsers-standard [0m   [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-parsers-standard ---[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-parsers-standard ---[0m        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ tika-parsers-standard [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ tika-parsers-standard [0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-parsers-standard ---[0m             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parsers-standard ---[0m         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ [0m              [2m               [0m
[2;36m                    [0m         [39mtika-parsers-standard ---[0m                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- bundl[0m[1;92me:6[0m[39m.[0m[1;36m0.0[0m[39m:manifest [0m[1;39m([0m[39mbundle-manifest[0m[1;39m)[0m[39m @ tika-parsers-standard ---[0m       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m Ignoring project type pom - supportedProjectTypes = [0m[1;39m[[0m[39mjar, bundle[0m[1;39m][0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:report [0m[1;39m([0m[39mreport[0m[1;39m)[0m[39m @ tika-parsers-standard ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:check [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parsers-standard ---[0m             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping execution for packaging [0m[32m"pom"[0m                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:testCheck [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parsers-standard ---[0m         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping execution for packaging [0m[32m"pom"[0m                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- install:[0m[1;36m3.1[0m[39m.[0m[1;36m4[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ tika-parsers-standard ---[0m       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/[0m[95mpom.xml[0m[39m to [0m              [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parsers-standard/4.0.0-SNAPSHOT/[0m[95mtika-parsers-standard-4[0m [2m               [0m
[2;36m                    [0m         [95m.0.0-SNAPSHOT.pom[0m                                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -----------< org.apache.tika:tika-parsers-standard-modules >------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika standard parser modules [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT       [0m[1;39m[[0m[1;36m6[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from [0m                                                                       [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/[0m[95mpom.xml[0m                                                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m pom [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-parsers-standard-modules[0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; POM module[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ [0m                         [2m               [0m
[2;36m                    [0m         [39mtika-parsers-standard-modules ---[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ [0m                          [2m               [0m
[2;36m                    [0m         [39mtika-parsers-standard-modules ---[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-parsers-standard-modules [0m   [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ [0m                        [2m               [0m
[2;36m                    [0m         [39mtika-parsers-standard-modules ---[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ [0m                       [2m               [0m
[2;36m                    [0m         [39mtika-parsers-standard-modules ---[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-parsers-standard-modules ---[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parsers-standard-modules ---[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ [0m              [2m               [0m
[2;36m                    [0m         [39mtika-parsers-standard-modules ---[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- bundl[0m[1;92me:6[0m[39m.[0m[1;36m0.0[0m[39m:manifest [0m[1;39m([0m[39mbundle-manifest[0m[1;39m)[0m[39m @ tika-parsers-standard-modules [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m Ignoring project type pom - supportedProjectTypes = [0m[1;39m[[0m[39mjar, bundle[0m[1;39m][0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:report [0m[1;39m([0m[39mreport[0m[1;39m)[0m[39m @ tika-parsers-standard-modules ---[0m         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:check [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parsers-standard-modules ---[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping execution for packaging [0m[32m"pom"[0m                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:testCheck [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parsers-standard-modules ---[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping execution for packaging [0m[32m"pom"[0m                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- install:[0m[1;36m3.1[0m[39m.[0m[1;36m4[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ tika-parsers-standard-modules [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/[0m[95mpom.xml[0m[39m to [0m                                                                    [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parsers-standard-modules/4.0.0-SNAPSHOT/[0m[95mtika-parsers-st[0m [2m               [0m
[2;36m                    [0m         [95mandard-modules-4.0.0-SNAPSHOT.pom[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------< org.apache.tika:tika-parser-zip-commons >---------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika ZIP commons [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT                   [0m[1;39m[[0m[1;36m7[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from [0m                                                                       [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-zip-commons/[0m[95mpom.xml[0m                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m jar [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-parser-zip-commons ---[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; configured[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-parser-zip-commons [0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-parser-zip-commons [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-parser-zip-commons ---[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ tika-parser-zip-commons[0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ [0m                       [2m               [0m
[2;36m                    [0m         [39mtika-parser-zip-commons ---[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-parser-zip-commons ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-zip-commons ---[0m       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ [0m              [2m               [0m
[2;36m                    [0m         [39mtika-parser-zip-commons ---[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:resources [0m[1;39m([0m[39mdefault-resources[0m[1;39m)[0m[39m @ tika-parser-zip-commons [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m2[0m[39m resources from src/main/resources to target/classes[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m @ tika-parser-zip-commons ---[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed dependency.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m16[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m       [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-zip-commons/src/main/java/org/apache/tika/detect/zip/[0m[95mIPADetector.j[0m [2m               [0m
[2;36m                    [0m         [95mava[0m[39m: [0m                                                                                [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-zip-commons/src/main/java/org/apache/tika/detect/zip/[0m[95mIPADetector.j[0m [2m               [0m
[2;36m                    [0m         [95mava[0m[39m uses unchecked or unsafe operations.[0m                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-zip-commons/src/main/java/org/apache/tika/detect/zip/[0m[95mIPADetector.j[0m [2m               [0m
[2;36m                    [0m         [95mava[0m[39m: Recompile with -Xlint:unchecked for details.[0m                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- bundl[0m[1;92me:6[0m[39m.[0m[1;36m0.0[0m[39m:manifest [0m[1;39m([0m[39mbundle-manifest[0m[1;39m)[0m[39m @ tika-parser-zip-commons ---[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m No MANIFEST.MF file found, generating manifest.[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Writing manifest: [0m                                                            [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-zip-commons/target/classes/META-INF/[0m[95mMANIFEST.MF[0m                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:testResources [0m[1;39m([0m[39mdefault-testResources[0m[1;39m)[0m[39m @ [0m                  [2m               [0m
[2;36m                    [0m         [39mtika-parser-zip-commons ---[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from src/test/resources to target/test-classes[0m            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/test-classes[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;36m0[0m[39m:testCompile [0m[1;39m([0m[39mdefault-testCompile[0m[1;39m)[0m[39m @ [0m                      [2m               [0m
[2;36m                    [0m         [39mtika-parser-zip-commons ---[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed dependency.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m2[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m        [2m               [0m
[2;36m                    [0m         [39mtarget/test-classes[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- surefir[0m[1;92me:3[0m[39m.[0m[1;36m5.3[0m[39m:test [0m[1;39m([0m[39mdefault-test[0m[1;39m)[0m[39m @ tika-parser-zip-commons ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Tests are skipped.[0m                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:report [0m[1;39m([0m[39mreport[0m[1;39m)[0m[39m @ tika-parser-zip-commons ---[0m               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jar:[0m[1;36m3.4[0m[39m.[0m[1;36m2[0m[39m:jar [0m[1;39m([0m[39mdefault-jar[0m[1;39m)[0m[39m @ tika-parser-zip-commons ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building jar: [0m                                                                [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-zip-commons/target/[0m[95mtika-parser-zip-commons-4.0.0-SNAPSHOT.jar[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jar:[0m[1;36m3.4[0m[39m.[0m[1;36m2[0m[39m:test-jar [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-zip-commons ---[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building jar: [0m                                                                [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-zip-commons/target/[0m[95mtika-parser-zip-commons-4.0.0-SNAPSHOT-tests.ja[0m [2m               [0m
[2;36m                    [0m         [95mr[0m                                                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:check [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-zip-commons ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for classes to check[0m[33m...[0m                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-unsafe-[0m[1;36m17[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-deprecated-[0m[1;36m17[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-non-portable[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-internal-[0m[1;36m17[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: commons-io-unsafe-[0m[1;36m2.11[0m[39m.[0m[1;36m0[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Loading classes to check[0m[33m...[0m                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning classes for violations[0m[33m...[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanned [0m[1;36m24[0m[39m class [0m[1;35mfile[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m for forbidden API invocations [0m[1;39m([0m[39min [0m[1;36m0.[0m[39m04s[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m [0m         [2m               [0m
[2;36m                    [0m         [1;35merror[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m.[0m                                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:testCheck [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-zip-commons ---[0m       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for classes to check[0m[33m...[0m                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-unsafe-[0m[1;36m17[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-deprecated-[0m[1;36m17[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-non-portable[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-internal-[0m[1;36m17[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: commons-io-unsafe-[0m[1;36m2.11[0m[39m.[0m[1;36m0[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Loading classes to check[0m[33m...[0m                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning classes for violations[0m[33m...[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanned [0m[1;36m2[0m[39m class [0m[1;35mfile[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m for forbidden API invocations [0m[1;39m([0m[39min [0m[1;36m0.[0m[39m02s[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m [0m[1;35merror[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m.[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- install:[0m[1;36m3.1[0m[39m.[0m[1;36m4[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ tika-parser-zip-commons ---[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-zip-commons/[0m[95mpom.xml[0m[39m to [0m                                            [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parser-zip-commons/4.0.0-SNAPSHOT/[0m[95mtika-parser-zip-commo[0m [2m               [0m
[2;36m                    [0m         [95mns-4.0.0-SNAPSHOT.pom[0m                                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-zip-commons/target/[0m[95mtika-parser-zip-commons-4.0.0-SNAPSHOT.jar[0m[39m to [0m  [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parser-zip-commons/4.0.0-SNAPSHOT/[0m[95mtika-parser-zip-commo[0m [2m               [0m
[2;36m                    [0m         [95mns-4.0.0-SNAPSHOT.jar[0m                                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-zip-commons/target/[0m[95mtika-parser-zip-commons-4.0.0-SNAPSHOT-tests.ja[0m [2m               [0m
[2;36m                    [0m         [95mr[0m[39m to [0m                                                                                [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parser-zip-commons/4.0.0-SNAPSHOT/[0m[95mtika-parser-zip-commo[0m [2m               [0m
[2;36m                    [0m         [95mns-4.0.0-SNAPSHOT-tests.jar[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------< org.apache.tika:tika-parser-apple-module >--------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika Apple parser module [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT           [0m[1;39m[[0m[1;36m8[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from [0m                                                                       [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-apple-module/[0m[95mpom.xml[0m                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m jar [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-parser-apple-module ---[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; configured[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-parser-apple-module[0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-parser-apple-module [0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-parser-apple-module ---[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ [0m                        [2m               [0m
[2;36m                    [0m         [39mtika-parser-apple-module ---[0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ [0m                       [2m               [0m
[2;36m                    [0m         [39mtika-parser-apple-module ---[0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-parser-apple-module ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-apple-module ---[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ [0m              [2m               [0m
[2;36m                    [0m         [39mtika-parser-apple-module ---[0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:resources [0m[1;39m([0m[39mdefault-resources[0m[1;39m)[0m[39m @ tika-parser-apple-module [0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from src/main/resources to target/classes[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m @ tika-parser-apple-module ---[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed dependency.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m11[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m       [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- bundl[0m[1;92me:6[0m[39m.[0m[1;36m0.0[0m[39m:manifest [0m[1;39m([0m[39mbundle-manifest[0m[1;39m)[0m[39m @ tika-parser-apple-module ---[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m No MANIFEST.MF file found, generating manifest.[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Writing manifest: [0m                                                            [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-apple-module/target/classes/META-INF/[0m[95mMANIFEST.MF[0m                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:testResources [0m[1;39m([0m[39mdefault-testResources[0m[1;39m)[0m[39m @ [0m                  [2m               [0m
[2;36m                    [0m         [39mtika-parser-apple-module ---[0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m27[0m[39m resources from src/test/resources to target/test-classes[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/test-classes[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;36m0[0m[39m:testCompile [0m[1;39m([0m[39mdefault-testCompile[0m[1;39m)[0m[39m @ [0m                      [2m               [0m
[2;36m                    [0m         [39mtika-parser-apple-module ---[0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed dependency.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m5[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m        [2m               [0m
[2;36m                    [0m         [39mtarget/test-classes[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- surefir[0m[1;92me:3[0m[39m.[0m[1;36m5.3[0m[39m:test [0m[1;39m([0m[39mdefault-test[0m[1;39m)[0m[39m @ tika-parser-apple-module ---[0m         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Tests are skipped.[0m                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:report [0m[1;39m([0m[39mreport[0m[1;39m)[0m[39m @ tika-parser-apple-module ---[0m              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jar:[0m[1;36m3.4[0m[39m.[0m[1;36m2[0m[39m:jar [0m[1;39m([0m[39mdefault-jar[0m[1;39m)[0m[39m @ tika-parser-apple-module ---[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building jar: [0m                                                                [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-apple-module/target/[0m[95mtika-parser-apple-module-4.0.0-SNAPSHOT.jar[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jar:[0m[1;36m3.4[0m[39m.[0m[1;36m2[0m[39m:test-jar [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-apple-module ---[0m               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building jar: [0m                                                                [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-apple-module/target/[0m[95mtika-parser-apple-module-4.0.0-SNAPSHOT-tests.[0m [2m               [0m
[2;36m                    [0m         [95mjar[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:check [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-apple-module ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for classes to check[0m[33m...[0m                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-unsafe-[0m[1;36m17[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-deprecated-[0m[1;36m17[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-non-portable[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-internal-[0m[1;36m17[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: commons-io-unsafe-[0m[1;36m2.11[0m[39m.[0m[1;36m0[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Loading classes to check[0m[33m...[0m                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning classes for violations[0m[33m...[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanned [0m[1;36m22[0m[39m class [0m[1;35mfile[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m for forbidden API invocations [0m[1;39m([0m[39min [0m[1;36m0.[0m[39m04s[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m [0m         [2m               [0m
[2;36m                    [0m         [1;35merror[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m.[0m                                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:testCheck [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-apple-module ---[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for classes to check[0m[33m...[0m                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-unsafe-[0m[1;36m17[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-deprecated-[0m[1;36m17[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-non-portable[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-internal-[0m[1;36m17[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: commons-io-unsafe-[0m[1;36m2.11[0m[39m.[0m[1;36m0[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Loading classes to check[0m[33m...[0m                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning classes for violations[0m[33m...[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanned [0m[1;36m5[0m[39m class [0m[1;35mfile[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m for forbidden API invocations [0m[1;39m([0m[39min [0m[1;36m0.[0m[39m02s[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m [0m[1;35merror[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m.[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- install:[0m[1;36m3.1[0m[39m.[0m[1;36m4[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ tika-parser-apple-module ---[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-apple-module/[0m[95mpom.xml[0m[39m to [0m                                           [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parser-apple-module/4.0.0-SNAPSHOT/[0m[95mtika-parser-apple-mo[0m [2m               [0m
[2;36m                    [0m         [95mdule-4.0.0-SNAPSHOT.pom[0m                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-apple-module/target/[0m[95mtika-parser-apple-module-4.0.0-SNAPSHOT.jar[0m[39m to[0m [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parser-apple-module/4.0.0-SNAPSHOT/[0m[95mtika-parser-apple-mo[0m [2m               [0m
[2;36m                    [0m         [95mdule-4.0.0-SNAPSHOT.jar[0m                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-apple-module/target/[0m[95mtika-parser-apple-module-4.0.0-SNAPSHOT-tests.[0m [2m               [0m
[2;36m                    [0m         [95mjar[0m[39m to [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parser-apple-module/4.0.0-SNAPSHOT/[0m[95mtika-parser-apple-mo[0m [2m               [0m
[2;36m                    [0m         [95mdule-4.0.0-SNAPSHOT-tests.jar[0m                                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -----------< org.apache.tika:tika-parser-audiovideo-module >------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika audiovideo parser module [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT      [0m[1;39m[[0m[1;36m9[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from [0m                                                                       [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-audiovideo-module/[0m[95mpom.xml[0m                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m jar [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-parser-audiovideo-module[0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; configured[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ [0m                         [2m               [0m
[2;36m                    [0m         [39mtika-parser-audiovideo-module ---[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ [0m                          [2m               [0m
[2;36m                    [0m         [39mtika-parser-audiovideo-module ---[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-parser-audiovideo-module [0m   [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ [0m                        [2m               [0m
[2;36m                    [0m         [39mtika-parser-audiovideo-module ---[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ [0m                       [2m               [0m
[2;36m                    [0m         [39mtika-parser-audiovideo-module ---[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-parser-audiovideo-module ---[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-audiovideo-module ---[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ [0m              [2m               [0m
[2;36m                    [0m         [39mtika-parser-audiovideo-module ---[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:resources [0m[1;39m([0m[39mdefault-resources[0m[1;39m)[0m[39m @ [0m                          [2m               [0m
[2;36m                    [0m         [39mtika-parser-audiovideo-module ---[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m1[0m[39m resource from src/main/resources to target/classes[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m @ tika-parser-audiovideo-module[0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed dependency.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m18[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m       [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-audiovideo-module/src/main/java/org/apache/tika/parser/video/[0m[95mFLVPa[0m [2m               [0m
[2;36m                    [0m         [95mrser.java[0m[39m: [0m                                                                          [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-audiovideo-module/src/main/java/org/apache/tika/parser/video/[0m[95mFLVPa[0m [2m               [0m
[2;36m                    [0m         [95mrser.java[0m[39m uses unchecked or unsafe operations.[0m                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-audiovideo-module/src/main/java/org/apache/tika/parser/video/[0m[95mFLVPa[0m [2m               [0m
[2;36m                    [0m         [95mrser.java[0m[39m: Recompile with -Xlint:unchecked for details.[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- bundl[0m[1;92me:6[0m[39m.[0m[1;36m0.0[0m[39m:manifest [0m[1;39m([0m[39mbundle-manifest[0m[1;39m)[0m[39m @ tika-parser-audiovideo-module [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m No MANIFEST.MF file found, generating manifest.[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Writing manifest: [0m                                                            [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-audiovideo-module/target/classes/META-INF/[0m[95mMANIFEST.MF[0m              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:testResources [0m[1;39m([0m[39mdefault-testResources[0m[1;39m)[0m[39m @ [0m                  [2m               [0m
[2;36m                    [0m         [39mtika-parser-audiovideo-module ---[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m18[0m[39m resources from src/test/resources to target/test-classes[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/test-classes[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;36m0[0m[39m:testCompile [0m[1;39m([0m[39mdefault-testCompile[0m[1;39m)[0m[39m @ [0m                      [2m               [0m
[2;36m                    [0m         [39mtika-parser-audiovideo-module ---[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed dependency.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m6[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m        [2m               [0m
[2;36m                    [0m         [39mtarget/test-classes[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- surefir[0m[1;92me:3[0m[39m.[0m[1;36m5.3[0m[39m:test [0m[1;39m([0m[39mdefault-test[0m[1;39m)[0m[39m @ tika-parser-audiovideo-module ---[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Tests are skipped.[0m                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:report [0m[1;39m([0m[39mreport[0m[1;39m)[0m[39m @ tika-parser-audiovideo-module ---[0m         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jar:[0m[1;36m3.4[0m[39m.[0m[1;36m2[0m[39m:jar [0m[1;39m([0m[39mdefault-jar[0m[1;39m)[0m[39m @ tika-parser-audiovideo-module ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building jar: [0m                                                                [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-audiovideo-module/target/[0m[95mtika-parser-audiovideo-module-4.0.0-SNAPS[0m [2m               [0m
[2;36m                    [0m         [95mHOT.jar[0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jar:[0m[1;36m3.4[0m[39m.[0m[1;36m2[0m[39m:test-jar [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-audiovideo-module ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building jar: [0m                                                                [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-audiovideo-module/target/[0m[95mtika-parser-audiovideo-module-4.0.0-SNAPS[0m [2m               [0m
[2;36m                    [0m         [95mHOT-tests.jar[0m                                                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:check [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-audiovideo-module ---[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for classes to check[0m[33m...[0m                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-unsafe-[0m[1;36m17[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-deprecated-[0m[1;36m17[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-non-portable[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-internal-[0m[1;36m17[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: commons-io-unsafe-[0m[1;36m2.11[0m[39m.[0m[1;36m0[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Loading classes to check[0m[33m...[0m                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning classes for violations[0m[33m...[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanned [0m[1;36m28[0m[39m class [0m[1;35mfile[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m for forbidden API invocations [0m[1;39m([0m[39min [0m[1;36m0.[0m[39m04s[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m [0m         [2m               [0m
[2;36m                    [0m         [1;35merror[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m.[0m                                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:testCheck [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-audiovideo-module ---[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for classes to check[0m[33m...[0m                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-unsafe-[0m[1;36m17[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-deprecated-[0m[1;36m17[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-non-portable[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-internal-[0m[1;36m17[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: commons-io-unsafe-[0m[1;36m2.11[0m[39m.[0m[1;36m0[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Loading classes to check[0m[33m...[0m                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning classes for violations[0m[33m...[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanned [0m[1;36m6[0m[39m class [0m[1;35mfile[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m for forbidden API invocations [0m[1;39m([0m[39min [0m[1;36m0.[0m[39m02s[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m [0m[1;35merror[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m.[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- install:[0m[1;36m3.1[0m[39m.[0m[1;36m4[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ tika-parser-audiovideo-module [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-audiovideo-module/[0m[95mpom.xml[0m[39m to [0m                                      [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parser-audiovideo-module/4.0.0-SNAPSHOT/[0m[95mtika-parser-aud[0m [2m               [0m
[2;36m                    [0m         [95miovideo-module-4.0.0-SNAPSHOT.pom[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-audiovideo-module/target/[0m[95mtika-parser-audiovideo-module-4.0.0-SNAPS[0m [2m               [0m
[2;36m                    [0m         [95mHOT.jar[0m[39m to [0m                                                                          [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parser-audiovideo-module/4.0.0-SNAPSHOT/[0m[95mtika-parser-aud[0m [2m               [0m
[2;36m                    [0m         [95miovideo-module-4.0.0-SNAPSHOT.jar[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-audiovideo-module/target/[0m[95mtika-parser-audiovideo-module-4.0.0-SNAPS[0m [2m               [0m
[2;36m                    [0m         [95mHOT-tests.jar[0m[39m to [0m                                                                    [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parser-audiovideo-module/4.0.0-SNAPSHOT/[0m[95mtika-parser-aud[0m [2m               [0m
[2;36m                    [0m         [95miovideo-module-4.0.0-SNAPSHOT-tests.jar[0m                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------< org.apache.tika:tika-parser-text-module >---------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika text parser module [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT           [0m[1;39m[[0m[1;36m10[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from [0m                                                                       [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-text-module/[0m[95mpom.xml[0m                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m jar [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-parser-text-module ---[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; configured[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-parser-text-module [0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-parser-text-module [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-parser-text-module ---[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ tika-parser-text-module[0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ [0m                       [2m               [0m
[2;36m                    [0m         [39mtika-parser-text-module ---[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-parser-text-module ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-text-module ---[0m       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ [0m              [2m               [0m
[2;36m                    [0m         [39mtika-parser-text-module ---[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:resources [0m[1;39m([0m[39mdefault-resources[0m[1;39m)[0m[39m @ tika-parser-text-module [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m2[0m[39m resources from src/main/resources to target/classes[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m @ tika-parser-text-module ---[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed dependency.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m22[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m       [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- bundl[0m[1;92me:6[0m[39m.[0m[1;36m0.0[0m[39m:manifest [0m[1;39m([0m[39mbundle-manifest[0m[1;39m)[0m[39m @ tika-parser-text-module ---[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m No MANIFEST.MF file found, generating manifest.[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Writing manifest: [0m                                                            [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-text-module/target/classes/META-INF/[0m[95mMANIFEST.MF[0m                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:testResources [0m[1;39m([0m[39mdefault-testResources[0m[1;39m)[0m[39m @ [0m                  [2m               [0m
[2;36m                    [0m         [39mtika-parser-text-module ---[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m15[0m[39m resources from src/test/resources to target/test-classes[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/test-classes[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;36m0[0m[39m:testCompile [0m[1;39m([0m[39mdefault-testCompile[0m[1;39m)[0m[39m @ [0m                      [2m               [0m
[2;36m                    [0m         [39mtika-parser-text-module ---[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed dependency.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m8[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m        [2m               [0m
[2;36m                    [0m         [39mtarget/test-classes[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- surefir[0m[1;92me:3[0m[39m.[0m[1;36m5.3[0m[39m:test [0m[1;39m([0m[39mdefault-test[0m[1;39m)[0m[39m @ tika-parser-text-module ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Tests are skipped.[0m                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:report [0m[1;39m([0m[39mreport[0m[1;39m)[0m[39m @ tika-parser-text-module ---[0m               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jar:[0m[1;36m3.4[0m[39m.[0m[1;36m2[0m[39m:jar [0m[1;39m([0m[39mdefault-jar[0m[1;39m)[0m[39m @ tika-parser-text-module ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building jar: [0m                                                                [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-text-module/target/[0m[95mtika-parser-text-module-4.0.0-SNAPSHOT.jar[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jar:[0m[1;36m3.4[0m[39m.[0m[1;36m2[0m[39m:test-jar [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-text-module ---[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building jar: [0m                                                                [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-text-module/target/[0m[95mtika-parser-text-module-4.0.0-SNAPSHOT-tests.ja[0m [2m               [0m
[2;36m                    [0m         [95mr[0m                                                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:check [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-text-module ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for classes to check[0m[33m...[0m                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-unsafe-[0m[1;36m17[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-deprecated-[0m[1;36m17[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-non-portable[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-internal-[0m[1;36m17[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: commons-io-unsafe-[0m[1;36m2.11[0m[39m.[0m[1;36m0[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Loading classes to check[0m[33m...[0m                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning classes for violations[0m[33m...[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanned [0m[1;36m76[0m[39m class [0m[1;35mfile[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m for forbidden API invocations [0m[1;39m([0m[39min [0m[1;36m0.[0m[39m04s[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m [0m         [2m               [0m
[2;36m                    [0m         [1;35merror[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m.[0m                                                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:testCheck [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-text-module ---[0m       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for classes to check[0m[33m...[0m                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-unsafe-[0m[1;36m17[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-deprecated-[0m[1;36m17[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-non-portable[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: jdk-internal-[0m[1;36m17[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reading bundled API signatures: commons-io-unsafe-[0m[1;36m2.11[0m[39m.[0m[1;36m0[0m                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Loading classes to check[0m[33m...[0m                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning classes for violations[0m[33m...[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanned [0m[1;36m9[0m[39m class [0m[1;35mfile[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m for forbidden API invocations [0m[1;39m([0m[39min [0m[1;36m0.[0m[39m02s[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m [0m[1;35merror[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m.[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- install:[0m[1;36m3.1[0m[39m.[0m[1;36m4[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ tika-parser-text-module ---[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-text-module/[0m[95mpom.xml[0m[39m to [0m                                            [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parser-text-module/4.0.0-SNAPSHOT/[0m[95mtika-parser-text-modu[0m [2m               [0m
[2;36m                    [0m         [95mle-4.0.0-SNAPSHOT.pom[0m                                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-text-module/target/[0m[95mtika-parser-text-module-4.0.0-SNAPSHOT.jar[0m[39m to [0m  [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parser-text-module/4.0.0-SNAPSHOT/[0m[95mtika-parser-text-modu[0m [2m               [0m
[2;36m                    [0m         [95mle-4.0.0-SNAPSHOT.jar[0m                                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m                                                                   [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-text-module/target/[0m[95mtika-parser-text-module-4.0.0-SNAPSHOT-tests.ja[0m [2m               [0m
[2;36m                    [0m         [95mr[0m[39m to [0m                                                                                [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parser-text-module/4.0.0-SNAPSHOT/[0m[95mtika-parser-text-modu[0m [2m               [0m
[2;36m                    [0m         [95mle-4.0.0-SNAPSHOT-tests.jar[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------< org.apache.tika:tika-parser-html-module >---------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika html parser module [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT           [0m[1;39m[[0m[1;36m11[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from [0m                                                                       [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-html-module/[0m[95mpom.xml[0m                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m jar [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-parser-html-module ---[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; configured[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-parser-html-module [0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-parser-html-module [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-parser-html-module ---[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ tika-parser-html-module[0m [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ [0m                       [2m               [0m
[2;36m                    [0m         [39mtika-parser-html-module ---[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-parser-html-module ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parser-html-module ---[0m       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ [0m              [2m               [0m
[2;36m                    [0m         [39mtika-parser-html-module ---[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:resources [0m[1;39m([0m[39mdefault-resources[0m[1;39m)[0m[39m @ tika-parser-html-module [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from src/main/resources to target/classes[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m @ tika-parser-html-module ---[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed dependency.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m17[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m       [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-html-module/src/main/java/org/apache/tika/parser/html/[0m[95mDataURISchem[0m [2m               [0m
[2;36m                    [0m         [95meUtil.java[0m[39m: [0m                                                                         [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-html-module/src/main/java/org/apache/tika/parser/html/[0m[95mDataURISchem[0m [2m               [0m
[2;36m                    [0m         [95meUtil.java[0m[39m uses unchecked or unsafe operations.[0m                                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-html-module/src/main/java/org/apache/tika/parser/html/[0m[95mDataURISchem[0m [2m               [0m
[2;36m                    [0m         [95meUtil.java[0m[39m: Recompile with -Xlint:unchecked for details.[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m COMPILATION WARNING : [0m                                                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-html-module/src/main/java/org/apache/tika/parser/html/[0m[95mDataURISchem[0m [2m               [0m
[2;36m                    [0m         [95me.java[0m[39m:[0m[1;39m[[0m[1;36m42[0m[39m,[0m[1;36m16[0m[1;39m][0m[39m [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m in [0m                        [2m               [0m
[2;36m                    [0m         [39morg.apache.commons.io.input.UnsynchronizedByteArrayInputStream has been deprecated[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m1[0m[39m warning[0m                                                                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m COMPILATION ERROR : [0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-html-module/src/main/java/org/apache/tika/parser/html/[0m[95mHtmlHandler.[0m [2m               [0m
[2;36m                    [0m         [95mjava[0m[39m:[0m[1;39m[[0m[1;36m203[0m[39m,[0m[1;36m13[0m[1;39m][0m[39m cannot find symbol[0m                                                     [2m               [0m
[2;36m                    [0m         [39m  symbol:   variable LOG[0m                                                             [2m               [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.html.HtmlHandler[0m                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m1[0m[39m error[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Summary for Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT:[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m [0m[1;36m11.643[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m9.606[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.755[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.038[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package [0m[33m...[0m[39m. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.114[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.019[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.736[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.503[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.621[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.541[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m FAILURE [0m[1;39m[[0m[39m  [0m[1;36m0.195[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module SKIPPED[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD FAILURE[0m                                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m33.503[0m[39m s[0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-06T[0m[1;92m18:31:12[0m[39mZ[0m                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Failed to execute goal [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.maven.plugins:maven-compiler-plugin:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m on [0m  [2m               [0m
[2;36m                    [0m         [39mproject tika-parser-html-module: Compilation failure[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-mo[0m [2m               [0m
[2;36m                    [0m         [35mdules/tika-parser-html-module/src/main/java/org/apache/tika/parser/html/[0m[95mHtmlHandler.[0m [2m               [0m
[2;36m                    [0m         [95mjava[0m[39m:[0m[1;39m[[0m[1;36m203[0m[39m,[0m[1;36m13[0m[1;39m][0m[39m cannot find symbol[0m                                                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   variable LOG[0m                                                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.html.HtmlHandler[0m                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m -> [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m To see the full stack trace of the errors, re-run Maven with the -e switch.[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Re-run Maven using the -X switch to enable full debug logging.[0m               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m For more information about the errors and possible solutions, please read [0m   [2m               [0m
[2;36m                    [0m         [39mthe following articles:[0m                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m[39m [0m                                                                    [2m               [0m
[2;36m                    [0m         [4;94mhttp://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m After correcting the problems, you can resume the build with the command[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   mvn <args[0m[1m>[0m -rf :tika-parser-html-module                                    [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-delta-01_vuln_9/agent[0m ]8;id=168412;file:///home/user/crete/packages/crete/framework/agent/functions.py\[2mfunctions.py[0m]8;;\[2m:[0m]8;id=175391;file:///home/user/crete/packages/crete/framework/agent/functions.py#17\[2m17[0m]8;;\
[2;36m                    [0m         [35m-output-1767723634.7804425/[0m[95mbuild_failed_stderr.txt[0m: INFO:__main__:Running: docker    [2m               [0m
[2;36m                    [0m         build -t aixcc-afc/tika:latest --file                                                [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/projects/tika/[0m[95mDockerfile[0m         [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/projects/[0m[95mtika.[0m                   [2m               [0m
[2;36m                    [0m         #[1;36m0[0m building with [32m"default"[0m instance using docker driver                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m1[0m [1m[[0minternal[1m][0m load build definition from Dockerfile                                  [2m               [0m
[2;36m                    [0m         #[1;36m1[0m transferring dockerfile: [1;36m1.[0m74kB done                                              [2m               [0m
[2;36m                    [0m         #[1;36m1[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m2[0m [1m[[0minternal[1m][0m load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.[1;36m2.1[0m         [2m               [0m
[2;36m                    [0m         #[1;36m2[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m3[0m [1m[[0minternal[1m][0m load .dockerignore                                                     [2m               [0m
[2;36m                    [0m         #[1;36m3[0m transferring context: 2B done                                                     [2m               [0m
[2;36m                    [0m         #[1;36m3[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m4[0m [1m[[0m [1;36m1[0m/[1;36m11[0m[1m][0m FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.[1;36m2.1[0m                         [2m               [0m
[2;36m                    [0m         #[1;36m4[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m5[0m [1m[[0minternal[1m][0m load build context                                                     [2m               [0m
[2;36m                    [0m         #[1;36m5[0m transferring context: [1;36m1.[0m73kB done                                                 [2m               [0m
[2;36m                    [0m         #[1;36m5[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m6[0m [1m[[0m [1;36m6[0m/[1;36m11[0m[1m][0m RUN unzip [35m/src/[0m[95mmaven.zip[0m -d [35m/src/[0m[95mmaven[0m && rm [35m/src/[0m[95mmaven.zip[0m               [2m               [0m
[2;36m                    [0m         #[1;36m6[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m7[0m [1m[[0m [1;36m7[0m/[1;36m11[0m[1m][0m COPY project-parent [35m/src/project-parent/[0m                                  [2m               [0m
[2;36m                    [0m         #[1;36m7[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m8[0m [1m[[0m [1;36m2[0m/[1;36m11[0m[1m][0m RUN set -eux     && apt-get update     && apt-get install --yes           [2m               [0m
[2;36m                    [0m         --no-install-recommends         tesseract-ocr         tesseract-ocr-eng              [2m               [0m
[2;36m                    [0m         exiftool                                                                             [2m               [0m
[2;36m                    [0m         #[1;36m8[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m9[0m [1m[[0m [1;36m9[0m/[1;36m11[0m[1m][0m RUN tar -zxf [35m/src/[0m[95mtika.tar.gz[0m -C [35m/src/[0m[95mproject-parent[0m && rm                [2m               [0m
[2;36m                    [0m         [35m/src/[0m[95mtika.tar.gz[0m                                                                     [2m               [0m
[2;36m                    [0m         #[1;36m9[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m10[0m [1m[[0m [1;36m3[0m/[1;36m11[0m[1m][0m RUN mkdir [35m/usr/[0m[95mmy-bin[0m && mv [35m/usr/bin/[0m[95mtesseract[0m [35m/usr/my-bin/[0m[95mtesseract[0m     [2m               [0m
[2;36m                    [0m         #[1;36m10[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m11[0m [1m[[0m [1;36m8[0m/[1;36m11[0m[1m][0m COPY pkgs/tika.tar.gz [35m/src/[0m[95mtika.tar.gz[0m                                   [2m               [0m
[2;36m                    [0m         #[1;36m11[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m12[0m [1m[[0m [1;36m4[0m/[1;36m11[0m[1m][0m RUN mkdir [35m/[0m[95mexif[0m && cp [35m/usr/bin/[0m[95mexiftool[0m [35m/[0m[95mexif[0m && chmod -R a+rwx [35m/[0m[95mexif[0m    [2m               [0m
[2;36m                    [0m         #[1;36m12[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m13[0m [1m[[0m [1;36m5[0m/[1;36m11[0m[1m][0m COPY pkgs/maven.zip [35m/src/[0m[95mmaven.zip[0m                                       [2m               [0m
[2;36m                    [0m         #[1;36m13[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m14[0m [1m[[0m[1;36m10[0m/[1;36m11[0m[1m][0m COPY build.sh [35m/src/[0m                                                      [2m               [0m
[2;36m                    [0m         #[1;36m14[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m15[0m [1m[[0m[1;36m11[0m/[1;36m11[0m[1m][0m WORKDIR [35m/src/project-parent/[0m[95mtika[0m                                         [2m               [0m
[2;36m                    [0m         #[1;36m15[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m16[0m exporting to image                                                               [2m               [0m
[2;36m                    [0m         #[1;36m16[0m exporting layers done                                                            [2m               [0m
[2;36m                    [0m         #[1;36m16[0m writing image                                                                    [2m               [0m
[2;36m                    [0m         sh[1;92ma256:d960[0me891282ff456c3e4bae3fede9b9849b941689517938e1f5e02d8a0c511c4 done         [2m               [0m
[2;36m                    [0m         #[1;36m16[0m naming to docker.io/aixcc-afc/tika:latest                                        [2m               [0m
[2;36m                    [0m         #[1;36m16[0m naming to docker.io/aixcc-afc/tika:latest done                                   [2m               [0m
[2;36m                    [0m         #[1;36m16[0m DONE [1;36m0.[0m0s                                                                        [2m               [0m
[2;36m                    [0m         INFO:__main__:Keeping existing build artifacts as-is [1m([0mif any[1m)[0m.                       [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m -e [33mSANITIZER[0m=[35maddress[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -e   [2m               [0m
[2;36m                    [0m         [33mPROJECT_NAME[0m=[35mtika[0m -e [33mHELPER[0m=[3;92mTrue[0m -e [33mFUZZING_LANGUAGE[0m=[35mjvm[0m -e [33mBASH_ENV[0m=[35m/work/[0m[95mbashrc0[0m   [2m               [0m
[2;36m                    [0m         -e [33mMAVEN_OPTS[0m=-Dmaven.repo.[33mlocal[0m=[35m/work/[0m[95mmavencache[0m -v                                 [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m:[35m/[0m[95mlocal-source-mount[0m:ro -v                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/tika/[0m:[35m/[0m[95mout[0m -v          [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m:[35m/[0m[95mwork[0m -t         [2m               [0m
[2;36m                    [0m         aixcc-afc/tika:latest [35m/bin/[0m[95mbash[0m -c [32m'pushd $SRC && rm -rf /src/project-parent/tika &&[0m [2m               [0m
[2;36m                    [0m         [32mcp -r /local-source-mount /src/project-parent/tika && popd && compile'[0m.              [2m               [0m
[2;36m                    [0m         ERROR:__main__:Building fuzzers failed.                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m42.56[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=649487;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=461834;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=541302;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=231272;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:31:14][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.92[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=675807;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=334325;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/06/26 18:31:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=411556;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=653185;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:31:16][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.02[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=848446;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=448514;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/06/26 18:31:17][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=863229;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=911206;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.UNCOMPILABLE                                                            [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         ---                                                                                 [2m                [0m
[2;36m                    [0m         a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html [2m                [0m
[2;36m                    [0m         -module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java                  [2m                [0m
[2;36m                    [0m         +++                                                                                 [2m                [0m
[2;36m                    [0m         b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html [2m                [0m
[2;36m                    [0m         -module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-62[0m,[1;36m6[0m +[1;36m62[0m,[1;36m9[0m @@                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              private static final Map[1m<[0m[1;95mString[0m[39m, Property> META_[0m[1;33mHEAD[0m[39mER_MAPPINGS = new [0m         [2m                [0m
[2;36m                    [0m         [39mHashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m     private static final MediaType JPEG = [0m[1;35mMediaType.image[0m[1;39m([0m[32m"jpeg"[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [39m+    private static final Set<String> DANGEROUS_METADATA_KEYS = new [0m                [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mArrays.asList[0m[1;39m([0m                                                            [2m                [0m
[2;36m                    [0m         [39m+        [0m[32m"exiftool_path"[0m[39m, [0m[32m"command"[0m[39m, [0m[32m"parser_command"[0m[39m, [0m[32m"external_command"[0m[39m, [0m[32m"exec"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [32m"shell"[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     static [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"author"[0m[39m, TikaCoreProperties.CREATOR[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"title"[0m[39m, TikaCoreProperties.TITLE[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-195[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m198[0m[39m,[0m[1;36m12[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m             return;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Security: Reject metadata keys that could influence parser [0m             [2m                [0m
[2;36m                    [0m         [39mconfiguration[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35misDangerousMetadataKey[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Rejected potentially dangerous HTML metadata key: [0m[32m{[0m[32m}[0m[32m"[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [39mname[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+            return;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[32m"ICBM"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m             Matcher m = [0m[1;35mICBM.matcher[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[1;35mm.matches[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-233[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m242[0m[39m,[0m[1;36m18[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + name, value[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    private boolean [0m[1;35misDangerousMetadataKey[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [39m+        String lcName = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.US[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Check exact matches[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35mDANGEROUS_METADATA_KEYS.contains[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [39m+            return true;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Check for patterns that suggest command configuration[0m                   [2m                [0m
[2;36m                    [0m         [39m+        return [0m[1;35mlcName.contains[0m[1;39m([0m[32m"command"[0m[1;39m)[0m[39m || [0m                                      [2m                [0m
[2;36m                    [0m         [39m+               [0m[1;35mlcName.contains[0m[1;39m([0m[32m"exec"[0m[1;39m)[0m[39m || [0m                                         [2m                [0m
[2;36m                    [0m         [39m+               [0m[1;39m([0m[1;35mlcName.contains[0m[1;39m([0m[32m"path"[0m[1;39m)[0m[39m && [0m[1;39m([0m[1;35mlcName.contains[0m[1;39m([0m[32m"tool"[0m[1;39m)[0m[39m || [0m            [2m                [0m
[2;36m                    [0m         [1;35mlcName.contains[0m[1;39m([0m[32m"parser"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     private void [0m[1;35mstartElementWithSafeAttributes[0m[1;39m([0m[39mString name, Attributes atts[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mthrows SAXException [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-359[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m380[0m[39m,[0m[1;36m6[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[95mswallow[0m                                                              [2m                [0m
[2;36m                    [0m         [39m             return;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-        int added = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m-        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [39m-            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                                  [2m                [0m
[2;36m                    [0m         [39m         Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                           [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-377[0m[39m,[0m[1;36m8[0m[39m +[0m[1;36m394[0m[39m,[0m[1;36m6[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, true[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, metadata[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [39m-                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- a/tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java[0m   [2m                [0m
[2;36m                    [0m         [39m+++ b/tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java[0m   [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-158[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m158[0m[39m,[0m[1;36m8[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         Process process = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m         try [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-            process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m+            [0m[35m/[0m[35m/[0m[39m Use ProcessBuilder to avoid shell interpretation[0m                    [2m                [0m
[2;36m                    [0m         [39m+            process = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[1;35m.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m             Thread stdErrSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m             Thread stdOutSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getInputStream[0m[1;39m([0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mstdErrSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-220[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m221[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m      * Sets the command to be run. This can include either of[0m                      [2m                [0m
[2;36m                    [0m         [39m      * [0m[1;39m{[0m[39m@link #IN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m[39m or [0m[1;39m{[0m[39m@link #OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m                     [2m                [0m
[2;36m                    [0m         [39m      * if the command needs filenames.[0m                                             [2m                [0m
[2;36m                    [0m         [39m+     * [0m                                                                            [2m                [0m
[2;36m                    [0m         [39m+     * <p><strong>Security Warning:<[0m[35m/[0m[95mstrong[0m[39m> The command must be from a trusted [0m   [2m                [0m
[2;36m                    [0m         [39msource.[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+     * Never set the command based on untrusted input such as document content or[0m  [2m                [0m
[2;36m                    [0m         [39m+     * user-controlled metadata. Doing so can lead to arbitrary command execution.[0m [2m                [0m
[2;36m                    [0m         [39m      *[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m      * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [39m      *[0m[35m/[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-286[0m[39m,[0m[1;36m13[0m[39m +[0m[1;36m291[0m[39m,[0m[1;36m8[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m         File output = null;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m Build our command[0m                                                       [2m                [0m
[2;36m                    [0m         [39m-        String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m-        if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m-            cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m-            cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        String[0m[1;39m[[0m[1;39m][0m[39m cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39m         for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [39m                 cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                         [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-308[0m[39m,[0m[1;36m11[0m[39m +[0m[1;36m308[0m[39m,[0m[1;36m8[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m Execute[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m         Process process = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m         try [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m-                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [39m-                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m[35m/[0m[35m/[0m[39m Always use array form to prevent shell injection[0m                    [2m                [0m
[2;36m                    [0m         [39m+            process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m COMPILATION ERROR : [0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-m[0m [2m                [0m
[2;36m                    [0m         [35modules/tika-parser-html-module/src/main/java/org/apache/tika/parser/html/[0m[95mHtmlHandle[0m [2m                [0m
[2;36m                    [0m         [95mr.java[0m[39m:[0m[1;39m[[0m[1;36m203[0m[39m,[0m[1;36m13[0m[1;39m][0m[39m cannot find symbol[0m                                                  [2m                [0m
[2;36m                    [0m         [39m  symbol:   variable LOG[0m                                                            [2m                [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.html.HtmlHandler[0m                           [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m1[0m[39m error[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Summary for Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT:[0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m [0m[1;36m11.643[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m9.606[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.755[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.038[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package [0m[33m...[0m[39m. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.114[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.019[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.736[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.503[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.621[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.541[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m FAILURE [0m[1;39m[[0m[39m  [0m[1;36m0.195[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module SKIPPED[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD FAILURE[0m                                                                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m33.503[0m[39m s[0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-06T[0m[1;92m18:31:12[0m[39mZ[0m                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Failed to execute goal [0m                                                     [2m                [0m
[2;36m                    [0m         [39morg.apache.maven.plugins:maven-compiler-plugin:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m on [0m [2m                [0m
[2;36m                    [0m         [39mproject tika-parser-html-module: Compilation failure[0m                                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-m[0m [2m                [0m
[2;36m                    [0m         [35modules/tika-parser-html-module/src/main/java/org/apache/tika/parser/html/[0m[95mHtmlHandle[0m [2m                [0m
[2;36m                    [0m         [95mr.java[0m[39m:[0m[1;39m[[0m[1;36m203[0m[39m,[0m[1;36m13[0m[1;39m][0m[39m cannot find symbol[0m                                                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   variable LOG[0m                                                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.html.HtmlHandler[0m                   [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m -> [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m                                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m To see the full stack trace of the errors, re-run Maven with the -e switch.[0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Re-run Maven using the -X switch to enable full debug logging.[0m              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m For more information about the errors[0m                                       [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.jav[0m[1;92ma:63[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:594[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:453[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:314[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:274[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1;39m([0m[39mParserDecorator.jav[0m[1;92ma:153[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1;39m([0m[39mDelegatingParser.jav[0m[1;92ma:71[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mParsingEmb[0m [2m                [0m
[2;36m                    [0m         [39meddedDocumentExtractor.jav[0m[1;92ma:101[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:377[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1;39m([0m[39mContentHandlerDecorator.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:125[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1;39m([0m[39mXHTMLDowngradeHandle[0m [2m                [0m
[2;36m                    [0m         [39mr.jav[0m[1;92ma:59[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.html.JSoupParser$[0m[1;35mTikaNodeFilter.head[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:211[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.jsoup.select.NodeTraversor.filter[0m[1;39m([0m[39mNodeTraversor.jav[0m[1;92ma:92[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:137[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:69[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 3c99eeb1380e104c[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA critical OS Command Injection vulnerability has been detected during fuzzing of [0m  [2m                [0m
[2;36m                    [0m         [39mthe Apache Tika HTML parser. The vulnerability allows attacker-controlled data to [0m  [2m                [0m
[2;36m                    [0m         [39mbe passed to OS command execution methods, which could lead to remote code [0m         [2m                [0m
[2;36m                    [0m         [39mexecution. The issue occurs when processing HTML content with embedded data URIs [0m   [2m                [0m
[2;36m                    [0m         [39mthat trigger external parser invocation.[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis is an **OS Command Injection** vulnerability classified as a critical security[0m [2m                [0m
[2;36m                    [0m         [39missue. The fuzzer has identified a code path where attacker-controlled input can [0m   [2m                [0m
[2;36m                    [0m         [39minfluence OS command execution without proper sanitization or validation.[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations:[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Vulnerability Type**: The issue is explicitly identified as an OS Command [0m     [2m                [0m
[2;36m                    [0m         [39mInjection vulnerability by the Jazzer security sanitizer [0m                           [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`com.code_intelligence.jazzer.sanitizers.OsCommandInjection`[0m[1;39m)[0m[39m.[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Attack Vector**: The vulnerability is triggered through HTML parsing, [0m         [2m                [0m
[2;36m                    [0m         [39mspecifically when processing data URI schemes embedded in HTML content. The stack [0m  [2m                [0m
[2;36m                    [0m         [39mtrace shows the following execution flow:[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - HTML content is parsed by `JSoupParser`[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - The parser encounters a data URI scheme in an HTML element[0m                     [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mHtmlHandler.handleDataURIScheme[0m[1;39m([0m[1;39m)[0m[39m` is invoked to process the embedded data[0m    [2m                [0m
[2;36m                    [0m         [39m   - This triggers the `ParsingEmbeddedDocumentExtractor` to parse the embedded [0m    [2m                [0m
[2;36m                    [0m         [39mcontent[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - Eventually, an `ExternalParser` is invoked, which executes OS commands via [0m    [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Execution Path**: The command injection occurs at:[0m                             [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mProcessBuilder.start[0m[1;39m([0m[1;39m)[0m[39m` is called, ultimately triggered from[0m                  [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m` in `[0m[1;35mExternalParser.parse[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m314[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Entry Point**: The fuzzing harness [0m[1;39m([0m[39m`[0m[1;35mHtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mserves as the test entry point, feeding malicious HTML input to [0m                    [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mAutoDetectParser.parse[0m[1;39m([0m[1;39m)[0m[39m`.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Components Requiring Investigation:[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo understand the full scope of this vulnerability, the following areas should be [0m  [2m                [0m
[2;36m                    [0m         [39mexamined:[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **`org.apache.tika.parser.external.ExternalParser`** [0m[1;39m([0m[39mline [0m[1;36m314[0m[39m and [0m[1;36m274[0m[1;39m)[0m[39m:[0m         [2m                [0m
[2;36m                    [0m         [39m   - How commands are constructed for execution[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Whether user input is incorporated into command strings[0m                        [2m                [0m
[2;36m                    [0m         [39m   - What validation or sanitization is performed before command execution[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **`[0m[1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1;39m([0m[1;39m)[0m[39m`** [0m[1;39m([0m[39mline [0m[1;36m377[0m[1;39m)[0m[39m:[0m  [2m                [0m
[2;36m                    [0m         [39m   - How data URIs are extracted and decoded[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - What content types trigger external parser invocation[0m                          [2m                [0m
[2;36m                    [0m         [39m   - Whether any validation is performed on the embedded data[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **`[0m[1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[1;39m)[0m[39m`**[0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mline [0m[1;36m101[0m[1;39m)[0m[39m:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   - How embedded documents are identified and routed to appropriate parsers[0m        [2m                [0m
[2;36m                    [0m         [39m   - The decision logic for invoking external parsers[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Parser Configuration**:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - The `AutoDetectParser` and `CompositeParser` configuration[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Which external parsers are registered and under what conditions they are [0m      [2m                [0m
[2;36m                    [0m         [39minvoked[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - Whether there are configuration options to disable external command execution[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Data URI Processing**:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - The complete pipeline for processing data URIs in HTML elements[0m                [2m                [0m
[2;36m                    [0m         [39m   - How MIME types from data URIs influence parser selection[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis vulnerability represents a critical security risk as it allows potential [0m      [2m                [0m
[2;36m                    [0m         [39mremote code execution through maliciously crafted HTML content containing specially[0m [2m                [0m
[2;36m                    [0m         [39mcrafted data URIs.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.jav[0m[1;92ma:63[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:594[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:453[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:314[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:274[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1;39m([0m[39mParserDecorator.jav[0m[1;92ma:153[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1;39m([0m[39mDelegatingParser.jav[0m[1;92ma:71[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mParsingEmb[0m [2m                [0m
[2;36m                    [0m         [39meddedDocumentExtractor.jav[0m[1;92ma:101[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:377[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1;39m([0m[39mContentHandlerDecorator.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:125[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1;39m([0m[39mXHTMLDowngradeHandle[0m [2m                [0m
[2;36m                    [0m         [39mr.jav[0m[1;92ma:59[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.html.JSoupParser$[0m[1;35mTikaNodeFilter.head[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:211[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.jsoup.select.NodeTraversor.filter[0m[1;39m([0m[39mNodeTraversor.jav[0m[1;92ma:92[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:137[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:69[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 3c99eeb1380e104c[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:260[0m[39m-[0m[1;36m320[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:     * Executes the configured external command and passes the given document[0m   [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:     * stream as a simple XHTML document to the given SAX content handler.[0m      [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:     * Metadata is only extracted if [0m[1;39m{[0m[39m@link [0m                                    [2m                [0m
[2;36m                    [0m         [39m#[0m[1;35msetMetadataExtractionPatterns[0m[1;39m([0m[39mMap[0m[1;39m)[0m[1;39m}[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:     * has been called to set patterns.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:        XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, metadata[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        TemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            [0m[1;35mparse[0m[1;39m([0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mstream, tmp, metadata[0m[1;39m)[0m[39m, xhtml, metadata, [0m [2m                [0m
[2;36m                    [0m         [39mtmp[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:            [0m[1;35mtmp.dispose[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    private void [0m[1;35mparse[0m[1;39m([0m[39mTikaInputStream stream, XHTMLContentHandler xhtml, [0m      [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                       TemporaryResources tmp[0m[1;39m)[0m[39m throws IOException, [0m             [2m                [0m
[2;36m                    [0m         [39mSAXException, TikaException [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        boolean inputToStdIn = true;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        boolean outputFromStdOut = true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        boolean hasPatterns = [0m[1;39m([0m[39mmetadataPatterns != null && [0m                     [2m                [0m
[2;36m                    [0m         [39m![0m[1;35mmetadataPatterns.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:        File output = null;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build our command[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                inputToStdIn = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                output = [0m[1;35mtmp.createTemporaryFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                outputFromStdOut = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m[1;35moutput.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:19[0m[39m-[0m[1;36m53[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.net.MalformedURLException;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.xml.sax.Attributes;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.xml.sax.helpers.AttributesImpl;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.metadata.HTML;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.metadata.Office;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.parser.external.CompositeExternalParser;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.parser.external.ExternalParser;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.sax.TextContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:354[0m[39m-[0m[1;36m408[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    private void [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        DataURIScheme dataURIScheme = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            dataURIScheme = [0m[1;35mdataURISchemeUtil.parse[0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mDataURISchemeParseException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    private int [0m[1;35mconfigureExifTool[0m[1;39m([0m[39mString path[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:        int retVal = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:            CompositeExternalParser exParser =[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:                    [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:                            context[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:            if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:                [0m[35m/[0m[35m/[0m[95mlasciate[0m[39m ogne speranza[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:                return [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:            exifToolParser = new [0m[1;35mExternalParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:            retVal = [0m[1;36m1[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:            [0m[1;35mparsers.put[0m[1;39m([0m[39mJPEG, exifToolParser[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:            [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:        Set<MediaType> supported = new [0m                                         [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:        [0m[1;35msupported.add[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[39mpath, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39msupported[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:        return retVal;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/DataURIScheme.jav[0m[1;92ma:1[0m[39m-[0m[1;36m81[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:package org.apache.tika.parser.html;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.commons.io.input.UnsynchronizedByteArrayInputStream;[0m           [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:public class DataURIScheme [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    private final String rawMediaTypeString;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    private final boolean isBase64;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    private final byte[0m[1;39m[[0m[1;39m][0m[39m data;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    [0m[1;35mDataURIScheme[0m[1;39m([0m[39mString mediaTypeString, boolean isBase64, byte[0m[1;39m[[0m[1;39m][0m[39m data[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:        this.rawMediaTypeString = mediaTypeString;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        this.isBase64 = isBase64;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:        this.data = data;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public InputStream [0m[1;35mgetInputStream[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        return new [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * @return parsed media type or <code>null<[0m[35m/[0m[95mcode[0m[39m> if parse fails or if media[0m [2m                [0m
[2;36m                    [0m         [39mtype string was[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * not specified[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    public MediaType [0m[1;35mgetMediaType[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        if [0m[1;39m([0m[39mrawMediaTypeString != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            return [0m[1;35mMediaType.parse[0m[1;39m([0m[39mrawMediaTypeString[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        return null;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    public boolean [0m[1;35misBase64[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        return isBase64;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public boolean [0m[1;35mequals[0m[1;39m([0m[39mObject o[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        if [0m[1;39m([0m[39mthis == o[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            return true;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        if [0m[1;39m([0m[39m![0m[1;39m([0m[39mo instanceof DataURIScheme[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            return false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        DataURIScheme that = [0m[1;39m([0m[39mDataURIScheme[0m[1;39m)[0m[39m o;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        return [0m[1;35misBase64[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;35mthat.isBase64[0m[1;39m([0m[1;39m)[0m[39m &&[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                [0m[1;35mObjects.equals[0m[1;39m([0m[39mrawMediaTypeString, that.rawMediaTypeString[0m[1;39m)[0m[39m &&[0m   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                [0m[1;35mArrays.equals[0m[1;39m([0m[39mdata, that.data[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    public int [0m[1;35mhashCode[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        int result = [0m[1;35mObjects.hash[0m[1;39m([0m[39mrawMediaTypeString, [0m[1;35misBase64[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        result = [0m[1;36m31[0m[39m * result + [0m[1;35mArrays.hashCode[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        return result;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:80[0m[39m-[0m[1;36m120[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public void [0m[1;35mparseEmbedded[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            TikaInputStream tis, ContentHandler handler, Metadata metadata, [0m     [2m                [0m
[2;36m                    [0m         [39mboolean outputHtml[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            throws SAXException, IOException [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            AttributesImpl attributes = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            [0m[1;35mattributes.addAttribute[0m[1;39m([0m[32m""[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"CDATA"[0m[39m, [0m              [2m                [0m
[2;36m                    [0m         [32m"package-entry"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            [0m[1;35mhandler.startElement[0m[1;39m([0m[39mXHTML, [0m[32m"div"[0m[39m, [0m[32m"div"[0m[39m, attributes[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        if [0m[1;39m([0m[39mwriteFileNameToContent && name != null && [0m[1;35mname.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[39m && [0m      [2m                [0m
[2;36m                    [0m         [39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            [0m[1;35mhandler.startElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[39m, new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            char[0m[1;39m[[0m[1;39m][0m[39m chars = [0m[1;35mname.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            [0m[1;35mhandler.characters[0m[1;39m([0m[39mchars, [0m[1;36m0[0m[39m, chars.length[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[35m/[0m[35m/[0m[39m Use the delegate parser to parse this entry[0m                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            [0m[1;35mtis.setCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            [0m[1;35mDELEGATING_PARSER.parse[0m[1;39m([0m[39mtis, new [0m[1;35mEmbeddedContentHandler[0m[1;39m([0m[39mnew [0m        [2m                [0m
[2;36m                    [0m         [1;35mBodyContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[1;39m)[0m[39m,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                    metadata, context[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mEncryptedDocumentException ede[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[1;35mrecordException[0m[1;39m([0m[39mede, context[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mCorruptedFileException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[35m/[0m[35m/[0m[95mnecessary[0m[39m to stop the parse to avoid infinite loops[0m               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            [0m[35m/[0m[35m/[0m[95mon[0m[39m corrupt sqlite3 files[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            [0m[1;35mrecordException[0m[1;39m([0m[39me, context[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[1;35mtis.removeCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"div"[0m[39m, [0m[32m"div"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    void [0m[1;35mrecordException[0m[1;39m([0m[39mException e, ParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m150[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.external;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedReader;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.FileInputStream;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.InputStreamReader;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.Reader;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.concurrent.TimeoutException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.io.output.NullOutputStream;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.io.TemporaryResources;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m: * Parser that uses an external program [0m[1;39m([0m[39mlike catdoc or pdf2txt[0m[1;39m)[0m[39m to extract[0m      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m: * text content and metadata from a given document.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:public class ExternalParser implements Parser [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final Logger LOG = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mExternalParser.class[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * The token, which if present in the Command string, will[0m                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * be replaced with the input filename.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * Alternately, the input data can be streamed over STDIN.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    public static final String IN[0m[1;33mPUT[0m[39m_FILE_TOKEN = [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * The token, which if present in the Command string, will[0m                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * be replaced with the output filename.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * Alternately, the output data can be collected on STDOUT.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public static final String OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN = [0m[32m"$[0m[32m{[0m[32mOUT[0m[1;33mPUT[0m[32m}[0m[32m"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private static final long serialVersionUID = -1079128990650687037L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[35m/[0m[35m/[0m[95mmake[0m[39m this parameterizable[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private final long timeoutMs = [0m[1;36m60000[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * Media types supported by the external program.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private Set<MediaType> supportedTypes = [0m[1;35mCollections.emptySet[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     * Regular Expressions to run over STDOUT to[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * extract Metadata.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    private Map<Pattern, String> metadataPatterns = null;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * The external command to invoke.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    private String[0m[1;39m[[0m[1;39m][0m[39m command = new String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[32m"cat"[0m[1;39m}[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     * A consumer for ignored Lines[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    private LineConsumer ignoredLineConsumer = LineConsumer.NULL;[0m                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * Starts a thread that reads and discards the contents of the[0m              [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     * standard stream of the given process. Potential exceptions[0m               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:     * are ignored, and the stream is closed once fully processed.[0m              [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:     * Note: calling this starts a new thread and blocks the [0m[1;35mcurrent[0m[1;39m([0m[39mcaller[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:     * thread until the new thread dies[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:     * @param stream stream to be ignored[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    private static void [0m[1;35mignoreStream[0m[1;39m([0m[39mfinal InputStream stream[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;35mignoreStream[0m[1;39m([0m[39mstream, true[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:     * Starts a thread that reads and discards the contents of the[0m              [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:     * standard stream of the given process. Potential exceptions[0m               [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:     * are ignored, and the stream is closed once fully processed.[0m              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:     * @param stream       stream to sent to black hole [0m[1;39m([0m[39ma k a null[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:     * @param waitForDeath when [0m[1;39m{[0m[39m@code true[0m[1;39m}[0m[39m the caller thread will be[0m          [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:     *                     blocked till the death of new thread.[0m                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     * @return The thread that is created and started[0m                           [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    private static Thread [0m[1;35mignoreStream[0m[1;39m([0m[39mfinal InputStream stream, boolean [0m       [2m                [0m
[2;36m                    [0m         [39mwaitForDeath[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        Thread t = new [0m[1;35mThread[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mstream, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:                [0m[35m/[0m[35m/[0m[95mswallow[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:                [0m[1;35mIOUtils.closeQuietly[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;39m}[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        [0m[1;35mt.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        if [0m[1;39m([0m[39mwaitForDeath[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                [0m[1;35mt.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException ignore[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        return t;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:     * Checks to see if the command can be run. Typically used with[0m             [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:     * something like [0m[32m"myapp --version"[0m[39m to check to see if [0m[32m"myapp"[0m              [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:     * is installed and on the path.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:     * @param checkCmd   The check command to run[0m                               [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:     * @param errorValue What is considered an error value?[0m                     [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:190[0m[39m-[0m[1;36m260[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:                [0m[35m/[0m[35m/[0m[39m"Error forking command due to JVM locale bug[0m                  [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                [0m[35m/[0m[35m/[0m[1;39m([0m[39msee TIKA-[0m[1;36m1526[0m[39m and SOLR-[0m[1;36m6387[0m[1;39m)[0m[39m"[0m                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                return false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            [0m[35m/[0m[35m/[0m[95mthrow[0m[39m if a different kind of error[0m                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            throw err;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:            if [0m[1;39m([0m[39mprocess != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;35mprocess.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:        return [0m[1;35mgetSupportedTypes[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        return supportedTypes;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    public void [0m[1;35msetSupportedTypes[0m[1;39m([0m[39mSet<MediaType> supportedTypes[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:        this.supportedTypes = [0m[1;35mCollections.unmodifiableSet[0m[1;39m([0m[39mnew [0m                  [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[39msupportedTypes[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    public String[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetCommand[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        return command;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:     * Sets the command to be run. This can include either of[0m                   [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:     * [0m[1;39m{[0m[39m@link #IN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m[39m or [0m[1;39m{[0m[39m@link #OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m                  [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:     * if the command needs filenames.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:     * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    public void [0m[1;35msetCommand[0m[1;39m([0m[39mString[0m[33m...[0m[39m command[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        this.command = command;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:     * Gets lines consumer[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:     * @return consumer instance[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:    public LineConsumer [0m[1;35mgetIgnoredLineConsumer[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:        return ignoredLineConsumer;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:     * Set a consumer for the lines ignored by the parse functions[0m              [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:     * @param ignoredLineConsumer consumer instance[0m                             [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:    public void [0m[1;35msetIgnoredLineConsumer[0m[1;39m([0m[39mLineConsumer ignoredLineConsumer[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:        this.ignoredLineConsumer = ignoredLineConsumer;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:    public Map<Pattern, String> [0m[1;35mgetMetadataExtractionPatterns[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:        return metadataPatterns;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:     * Sets the map of regular expression patterns and Metadata[0m                 [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:     * keys. Any matching patterns will have the matching[0m                       [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:     * metadata entries set.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:     * Set this to null to disable Metadata extraction.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:    public void [0m[1;35msetMetadataExtractionPatterns[0m[1;39m([0m[39mMap<Pattern, String> patterns[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:        this.metadataPatterns = patterns;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/DelegatingParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m74[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: * Base class for parser implementations that want to delegate parts of the[0m      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * task of parsing an input document to another parser. The delegate parser[0m      [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: * is looked up from the parsing context using the [0m[1;39m{[0m[39m@link Parser[0m[1;39m}[0m[39m class as[0m       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * the key.[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: * @since Apache Tika [0m[1;36m0.4[0m[39m, major changes in Tika [0m[1;36m0.5[0m                             [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:public class DelegatingParser implements Parser [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * Returns the parser instance to which parsing tasks should be delegated.[0m   [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * The default implementation looks up the delegate parser from the given[0m    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * parse context, and uses an [0m[1;39m{[0m[39m@link EmptyParser[0m[1;39m}[0m[39m instance as a fallback.[0m    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Subclasses can override this method to implement alternative delegation[0m   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * strategies.[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param context parse context[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @return delegate parser[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @since Apache Tika [0m[1;36m0.7[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    protected Parser [0m[1;35mgetDelegateParser[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        return [0m[1;35mcontext.get[0m[1;39m([0m[39mParser.class, EmptyParser.INSTANCE[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mgetDelegateParser[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;35m.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Looks up the delegate parser from the parsing context and[0m                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * delegates the parse operation to it. If a delegate parser is not[0m          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * found, then an empty XHTML document is returned.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * Subclasses should override this method to parse the top level[0m             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * structure of the given document stream. Parsed sub-streams can[0m            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * be passed to this base class method to be parsed by the configured[0m        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * delegate parser.[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws SAXException, IOException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35mgetDelegateParser[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;35m.parse[0m[1;39m([0m[39mstream, handler, metadata, context[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:280[0m[39m-[0m[1;36m310[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        Parser parser = [0m[1;35mgetParser[0m[1;39m([0m[39mmetadata, context[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        TemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        ParseRecord parserRecord = [0m[1;35mcontext.get[0m[1;39m([0m[39mParseRecord.class[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:        if [0m[1;39m([0m[39mparserRecord == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:            parserRecord = new [0m[1;35mParseRecord[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:            [0m[1;35mcontext.set[0m[1;39m([0m[39mParseRecord.class, parserRecord[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:            TikaInputStream taggedStream = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mstream, tmp, [0m    [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            TaggedContentHandler taggedHandler =[0m                                [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:                    handler != null ? new [0m[1;35mTaggedContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[39m : null;[0m [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            String parserClassname = [0m[1;35mParserUtils.getParserClassname[0m[1;39m([0m[39mparser[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mparserRecord.addParserClass[0m[1;39m([0m[39mparserClassname[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:            [0m[1;35mParserUtils.recordParserDetails[0m[1;39m([0m[39mparserClassname, metadata[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:            [0m[1;35mparserRecord.beforeParse[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                [0m[1;35mparser.parse[0m[1;39m([0m[39mtaggedStream, taggedHandler, metadata, context[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSecurityException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:                [0m[35m/[0m[35m/[0m[95mrethrow[0m[39m security exceptions[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:                throw e;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                [0m[1;35mtaggedStream.throwIfCauseOf[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"TIKA-198: Illegal IOException from "[0m[39m +[0m [2m                [0m
[2;36m                    [0m         [39mparser, e[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:                [0m[1;35mWriteLimitReachedException.throwIfWriteLimitReached[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:                if [0m[1;39m([0m[39mtaggedHandler != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:                    [0m[1;35mtaggedHandler.throwIfCauseOf[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"TIKA-237: Illegal SAXException from "[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m+ parser, e[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/ProcessUtils.jav[0m[1;92ma:48[0m[39m-[0m[1;36m76[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * This should correctly put double-quotes around an argument if[0m             [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * ProcessBuilder doesn't seem to work [0m[1;39m([0m[39mas it doesn't[0m                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * on paths with spaces on Windows[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * @param arg[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * @return[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    public static String [0m[1;35mescapeCommandLine[0m[1;39m([0m[39mString arg[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        if [0m[1;39m([0m[39marg == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:            return arg;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        [0m[35m/[0m[35m/[0m[95mneed[0m[39m to test for [0m[32m" "[0m[39m on windows, can't just add double quotes[0m          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[35m/[0m[35m/[0m[95macross[0m[39m platforms.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        if [0m[1;39m([0m[1;35marg.contains[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m && SystemUtils.IS_OS_WINDOWS &&[0m                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:                [0m[1;39m([0m[39m![0m[1;35marg.startsWith[0m[1;39m([0m[32m"\""[0m[1;39m)[0m[39m && ![0m[1;35marg.endsWith[0m[1;39m([0m[32m"\""[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            arg = [0m[32m"\""[0m[39m + arg + [0m[32m"\""[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        return arg;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    public static String [0m[1;35munescapeCommandLine[0m[1;39m([0m[39mString arg[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        if [0m[1;39m([0m[1;35marg.contains[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m && SystemUtils.IS_OS_WINDOWS &&[0m                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                [0m[1;39m([0m[1;35marg.startsWith[0m[1;39m([0m[32m"\""[0m[1;39m)[0m[39m && [0m[1;35marg.endsWith[0m[1;39m([0m[32m"\""[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            arg = [0m[1;35marg.substring[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35marg.length[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        return arg;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external2/ExternalParser.jav[0m[1;92ma:100[0m[39m-[0m[1;36m14[0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[35m/[0m[35m/[0m[95mthis[0m[39m may remain null, depending on whether the external parser writes[0m [2m                [0m
[2;36m                    [0m         [39mto a file[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        Path outFile = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        try [0m[1;39m([0m[39mTemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            TikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mstream, tmp, metadata[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            Path p = [0m[1;35mtis.getPath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            List<String> thisCommandLine = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            Matcher inputMatcher = [0m[1;35mIN[0m[1;33mPUT[0m[1;35m_TOKEN_MATCHER.matcher[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            Matcher outputMatcher = [0m[1;35mOUT[0m[1;33mPUT[0m[1;35m_TOKEN_MATCHER.matcher[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            boolean outputFileInCommandline = false;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            for [0m[1;39m([0m[39mString c : commandLine[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                if [0m[1;39m([0m[1;35minputMatcher.reset[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;35m.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                    String updated = [0m[1;35mc.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN,[0m                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                            [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[1;35mp.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35moutputMatcher.reset[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;35m.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:                    outFile = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[32m"tika-external2-"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                    String updated = [0m[1;35mc.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN,[0m               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:                            [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[1;35moutFile.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                    outputFileInCommandline = true;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            FileProcessResult result = null;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            long localTimeoutMillis = [0m[1;35mTikaTaskTimeout.getTimeoutMillis[0m[1;39m([0m[39mcontext,[0m [2m                [0m
[2;36m                    [0m         [39mtimeoutMs[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            if [0m[1;39m([0m[39moutputFileInCommandline[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mnew [0m                              [2m                [0m
[2;36m                    [0m         [1;35mProcessBuilder[0m[1;39m([0m[39mthisCommandLine[0m[1;39m)[0m[39m,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                        localTimeoutMillis, maxStdOut, maxStdErr[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                outFile = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[32m"tika-external2-"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mnew [0m                              [2m                [0m
[2;36m                    [0m         [1;35mProcessBuilder[0m[1;39m([0m[39mthisCommandLine[0m[1;39m)[0m[39m,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                        localTimeoutMillis, outFile, maxStdErr[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.IS_TIMEOUT, [0m[1;35mresult.isTimeout[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.EXIT_VALUE, [0m[1;35mresult.getExitValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_OUT_LENGTH, [0m                       [2m                [0m
[2;36m                    [0m         [1;35mresult.getStdoutLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_OUT_IS_TRUNCATED,[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:230[0m[39m-[0m[1;36m280[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:     * type hierarchy information included in the configured media type[0m         [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:     * registry is used when looking for a matching parser instance.[0m            [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:     * Subclasses can override this method to provide more accurate[0m             [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:     * parser resolution.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:     * @param metadata document metadata[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:     * @return matching parser[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    protected Parser [0m[1;35mgetParser[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:        return [0m[1;35mgetParser[0m[1;39m([0m[39mmetadata, new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    protected Parser [0m[1;35mgetParser[0m[1;39m([0m[39mMetadata metadata, ParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:        Map<MediaType, Parser> map = [0m[1;35mgetParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:        [0m[35m/[0m[35m/[0m[95mcheck[0m[39m for parser override first[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:        String contentTypeString = [0m                                             [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        if [0m[1;39m([0m[39mcontentTypeString == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:            contentTypeString = [0m[1;35mmetadata.get[0m[1;39m([0m[39mMetadata.CONTENT_TYPE[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:        MediaType type = [0m[1;35mMediaType.parse[0m[1;39m([0m[39mcontentTypeString[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:        if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:            [0m[35m/[0m[35m/[0m[39m We always work on the normalised, canonical form[0m                 [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:            type = [0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:        while [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:            [0m[35m/[0m[35m/[0m[39m Try finding a parser for the type[0m                                [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:            Parser parser = [0m[1;35mmap.get[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:            if [0m[1;39m([0m[39mparser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:                return parser;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:            [0m[35m/[0m[35m/[0m[39m Failing that, try for the parent of the type[0m                     [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:            type = [0m[1;35mregistry.getSupertype[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        return fallback;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:        return [0m[1;35mgetParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;35m.keySet[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:     * Delegates the call to the matching component parser.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:     * Potential [0m[1;39m{[0m[39m@link RuntimeException[0m[1;39m}[0m[39ms, [0m[1;39m{[0m[39m@link IOException[0m[1;39m}[0m[39ms and[0m            [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:     * [0m[1;39m{[0m[39m@link SAXException[0m[1;39m}[0m[39ms unrelated to the given input stream and content[0m    [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:     * handler are automatically wrapped into [0m[1;39m{[0m[39m@link TikaException[0m[1;39m}[0m[39ms to better[0m  [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:     * honor the [0m[1;39m{[0m[39m@link Parser[0m[1;39m}[0m[39m contract.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:410[0m[39m-[0m[1;36m451[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:    private void [0m[1;35mresetExifTool[0m[1;39m([0m[39mint added[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:        if [0m[1;39m([0m[39madded == [0m[1;36m2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:        CompositeExternalParser exParser =[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:                [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:                        context[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:        if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        if [0m[1;39m([0m[39madded == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:            [0m[1;35mparsers.remove[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:        Set<MediaType> supported = new [0m                                         [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:        Set<MediaType> newSupported = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:        for [0m[1;39m([0m[39mMediaType m : supported[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mm.getSubtype[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"jpeg"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:                [0m[1;35mnewSupported.add[0m[1;39m([0m[39mm[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[32m"exiftool"[0m[39m, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39mnewSupported[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:        [0m[1;35mmetadata.remove[0m[1;39m([0m[32m"exiftool_path"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:        Map<MediaType, Parser> updated = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:        for [0m[1;39m([0m[39mMap.Entry<MediaType, Parser> e : [0m[1;35mexParser.getParsers[0m[1;39m([0m[1;39m)[0m[1;35m.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:            if [0m[1;39m([0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m instanceof ExternalParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:                ExternalParser p = [0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m [0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:                if [0m[1;39m([0m[1;35mExternalParser.check[0m[1;39m([0m[1;35mp.getCommand[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:                    for [0m[1;39m([0m[39mMediaType mediaType : [0m[1;35mp.getSupportedTypes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:                        [0m[1;35mupdated.put[0m[1;39m([0m[39mmediaType, p[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:        [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m451[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:453[0m[39m-[0m[1;36m471[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m453[0m[39m:    private ExternalParser [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m454[0m[39m:        CompositeExternalParser exParser =[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m455[0m[39m:                [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m456[0m[39m:                        context[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m457[0m[39m:        if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m458[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:        for [0m[1;39m([0m[39mParser p : [0m[1;35mexParser.getAllComponentParsers[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:            if [0m[1;39m([0m[39mp instanceof ExternalParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:                String[0m[1;39m[[0m[1;39m][0m[39m args = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m p[0m[1;39m)[0m[1;35m.getCommand[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m463[0m[39m:                for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < args.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m464[0m[39m:                    if [0m[1;39m([0m[39margs[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[32m"exiftool"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m465[0m[39m:                        return [0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m p;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m467[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:150[0m[39m-[0m[1;36m200[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[32m"BASE"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m && [0m[1;35matts.getValue[0m[1;39m([0m[32m"href"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:                [0m[1;35mstartElementWithSafeAttributes[0m[1;39m([0m[32m"base"[0m[39m, atts[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:                [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"base"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_LOCATION, [0m                        [2m                [0m
[2;36m                    [0m         [1;35mresolve[0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"href"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[32m"LINK"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                [0m[1;35mstartElementWithSafeAttributes[0m[1;39m([0m[32m"link"[0m[39m, atts[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"link"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[32m"SCRIPT"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:                scriptAtts = atts;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        if [0m[1;39m([0m[39mbodyLevel > [0m[1;36m0[0m[39m && discardLevel == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            String safe = [0m[1;35mmapper.mapSafeElement[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            if [0m[1;39m([0m[39msafe != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                [0m[1;35mstartElementWithSafeAttributes[0m[1;39m([0m[39msafe, atts[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        [0m[1;35mtitle.setLength[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        String value = [0m[1;35matts.getValue[0m[1;39m([0m[32m"src"[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:        if [0m[1;39m([0m[39mvalue != null && [0m[1;35mvalue.startsWith[0m[1;39m([0m[32m"data:"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[35m/[0m[35m/[0m[95mdon[0m[39m't extract data if we're in a script[0m                           [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[35m/[0m[35m/[0m[95mand[0m[39m the user doesn't want to extract scripts[0m                      [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            if [0m[1;39m([0m[39mscriptLevel == [0m[1;36m0[0m[39m || extractScripts[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        if [0m[1;39m([0m[32m"IFRAME"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:            String srcDoc = [0m[1;35matts.getValue[0m[1;39m([0m[32m"srcdoc"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39msrcDoc[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:                [0m[1;35mhandleSrcDoc[0m[1;39m([0m[39msrcDoc[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:     * Adds a metadata setting from the HTML <head/> to the Tika metadata[0m       [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:     * object. The name and value are normalized where possible.[0m                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    private void [0m[1;35maddHtmlMetadata[0m[1;39m([0m[39mString name, String value[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        [0m[35m/[0m[35m/[0m[95mnote[0m[39m that [0m[32m"name"[0m[39m derives from attributes and is not uppercased[0m        [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[35m/[0m[35m/[0m[95mlike[0m[39m the elements by the XHTMLDowngradeHandler[0m                        [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || [0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[32m"ICBM"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            Matcher m = [0m[1;35mICBM.matcher[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            if [0m[1;39m([0m[1;35mm.matches[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:190[0m[39m-[0m[1;36m236[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    private void [0m[1;35maddHtmlMetadata[0m[1;39m([0m[39mString name, String value[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        [0m[35m/[0m[35m/[0m[95mnote[0m[39m that [0m[32m"name"[0m[39m derives from attributes and is not uppercased[0m        [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[35m/[0m[35m/[0m[95mlike[0m[39m the elements by the XHTMLDowngradeHandler[0m                        [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || [0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[32m"ICBM"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            Matcher m = [0m[1;35mICBM.matcher[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            if [0m[1;39m([0m[1;35mm.matches[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[32m"ICBM"[0m[39m, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m + [0m[32m", "[0m[39m + [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.LATITUDE, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.LONGITUDE, [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[32m"ICBM"[0m[39m, value[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[39mMetadata.CONTENT_TYPE[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[35m/[0m[35m/[0m[95mdon[0m[39m't overwrite Metadata.CONTENT_TYPE![0m                            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            MediaType type = [0m[1;35mMediaType.parse[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_HINT, [0m             [2m                [0m
[2;36m                    [0m         [1;35mtype.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_HINT, value[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        String lcName = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.US[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        if [0m[1;39m([0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.containsKey[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            Property property = [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.get[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            if [0m[1;39m([0m[1;35mproperty.equals[0m[1;39m([0m[39mTikaCoreProperties.TITLE[0m[1;39m)[0m[39m && [0m                   [2m                [0m
[2;36m                    [0m         [39misTitleSetToMetadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                [0m[35m/[0m[35m/[0m[95mprefer[0m[39m the title element if it is already set[0m                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                [0m[35m/[0m[35m/[0m[95mdo[0m[39m nothing[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + [0m                           [2m                [0m
[2;36m                    [0m         [1;35mTikaCoreProperties.TITLE.getName[0m[1;39m([0m[1;39m)[0m[39m, value[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mproperty.isMultiValuePermitted[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + name, value[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:100[0m[39m-[0m[1;36m150[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                name = [0m[1;35mname.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                try [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                    new [0m[1;35mURL[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m test URL format[0m                           [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                    [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_LOCATION, name[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mMalformedURLException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                    [0m[35m/[0m[35m/[0m[39m The resource name is not a valid URL, ignore it[0m          [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    public [0m[1;35mHtmlHandler[0m[1;39m([0m[39mHtmlMapper mapper, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                       ParseContext context, boolean extractScripts[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mmapper, new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, metadata[0m[1;39m)[0m[39m, metadata, [0m     [2m                [0m
[2;36m                    [0m         [39mcontext, extractScripts[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    public void [0m[1;35mstartElement[0m[1;39m([0m[39mString uri, String local, String name, Attributes [0m [2m                [0m
[2;36m                    [0m         [39matts[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            throws SAXException [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        if [0m[1;39m([0m[32m"HTML"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m && [0m[1;35matts.getValue[0m[1;39m([0m[32m"lang"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_LANGUAGE, [0m[1;35matts.getValue[0m[1;39m([0m[32m"lang"[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        if [0m[1;39m([0m[32m"SCRIPT"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            scriptLevel++;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[32m"TITLE"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || titleLevel > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            titleLevel++;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        if [0m[1;39m([0m[32m"BODY"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || [0m[1;39m([0m[32m"FRAMESET"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m || bodyLevel > [0m[1;36m0[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            bodyLevel++;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        if [0m[1;39m([0m[1;35mmapper.isDiscardElement[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || discardLevel > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            discardLevel++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        if [0m[1;39m([0m[39mbodyLevel == [0m[1;36m0[0m[39m && discardLevel == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            if [0m[1;39m([0m[32m"META"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m && [0m[1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                [0m[35m/[0m[35m/[0m[39m TIKA-[0m[1;36m478[0m[39m: For cases where we have either a name or[0m           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                [0m[35m/[0m[35m/[0m[39m [0m[32m"http-equiv"[0m[39m, assume that XHTMLContentHandler will emit[0m      [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                [0m[35m/[0m[35m/[0m[39m these in the <head>, thus passing them through safely.[0m       [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                if [0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"http-equiv"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:                    [0m[1;35maddHtmlMetadata[0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"http-equiv"[0m[1;39m)[0m[39m, [0m               [2m                [0m
[2;36m                    [0m         [1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"name"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                    [0m[35m/[0m[35m/[0m[39m Record the meta tag in the metadata[0m                      [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:                    [0m[1;35maddHtmlMetadata[0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"name"[0m[1;39m)[0m[39m, [0m                     [2m                [0m
[2;36m                    [0m         [1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"property"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                    [0m[35m/[0m[35m/[0m[39m TIKA-[0m[1;36m983[0m[39m: Handle <meta [0m[33mproperty[0m[39m=[0m[32m"og[0m[32m:xxx"[0m[39m [0m[33mcontent[0m[39m=[0m[32m"yyy"[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [35m/[0m[39m> tags[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:                    [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + [0m                       [2m                [0m
[2;36m                    [0m         [1;35matts.getValue[0m[1;39m([0m[32m"property"[0m[1;39m)[0m[39m, [0m[1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[32m"BASE"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m && [0m[1;35matts.getValue[0m[1;39m([0m[32m"href"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/AutoDetectParserConfig.jav[0m[1;92ma:1[0m[39m-[0m[1;36m100[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.w3c.dom.Element;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.tika.config.ConfigBase;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.tika.exception.TikaConfigException;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractorFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.metadata.writefilter.MetadataWriteFilterFactory;[0m          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.sax.ContentHandlerDecoratorFactory;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: * This config object can be used to tune how conservative we want to be[0m         [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * when parsing data that is extremely compressible and resembles a ZIP[0m          [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * bomb. Null values will be ignored and will not affect the default values[0m      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: * in SecureContentHandler.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m: *     See <a [0m                                                                   [2m                [0m
[2;36m                    [0m         [33mhref[0m[39m=[0m[32m"https[0m[32m://cwiki.apache.org/confluence/display/TIKA/ModifyingContentWithHandlers[0m [2m                [0m
[2;36m                    [0m         [32mAndMetadataFilters"[0m[35m/[0m[39m>ModifyingContentWithHandlersAndMetadataFilters<[0m[35m/[0m[95ma[0m[39m>[0m             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m: *     for documentation and examples for configuring this with a [0m               [2m                [0m
[2;36m                    [0m         [39mtika-config.xml file.[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:public class AutoDetectParserConfig extends ConfigBase implements Serializable [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private static ContentHandlerDecoratorFactory [0m                               [2m                [0m
[2;36m                    [0m         [39mNOOP_CONTENT_HANDLER_DECORATOR_FACTORY =[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:            new [0m[1;35mContentHandlerDecoratorFactory[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                @Override[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                public ContentHandler [0m[1;35mdecorate[0m[1;39m([0m[39mContentHandler contentHandler, [0m   [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                                               ParseContext parseContext[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                    return contentHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            [0m[1;39m}[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public static AutoDetectParserConfig DEFAULT = new [0m[1;35mAutoDetectParserConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public static AutoDetectParserConfig [0m[1;35mload[0m[1;39m([0m[39mElement element[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            throws TikaConfigException, IOException [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mAutoDetectParserConfig.buildSingle[0m[1;39m([0m[32m"autoDetectParserConfig"[0m[39m,[0m      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:                AutoDetectParserConfig.class, element, [0m                          [2m                [0m
[2;36m                    [0m         [39mAutoDetectParserConfig.DEFAULT[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * If this is not null and greater than [0m[1;36m-1[0m[39m, the AutoDetectParser[0m             [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * will spool the stream to disk if the length of the stream is known[0m        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * ahead of time.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private Long spoolToDisk = null;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * SecureContentHandler -- Desired output threshold in characters.[0m           [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    private Long outputThreshold = null;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * SecureContentHandler -- Desired maximum compression ratio.[0m                [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private Long maximumCompressionRatio = null;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     * SecureContentHandler -- Desired maximum XML nesting level.[0m                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private Integer maximumDepth = null;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * SecureContentHandler -- Desired maximum package entry nesting level.[0m      [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private Integer maximumPackageEntryDepth = null;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    private MetadataWriteFilterFactory metadataWriteFilterFactory = null;[0m        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    private EmbeddedDocumentExtractorFactory embeddedDocumentExtractorFactory = [0m [2m                [0m
[2;36m                    [0m         [39mnull;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    private ContentHandlerDecoratorFactory contentHandlerDecoratorFactory =[0m      [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            NOOP_CONTENT_HANDLER_DECORATOR_FACTORY;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    private DigestingParser.DigesterFactory digesterFactory = null;[0m              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    private boolean throwOnZeroBytes = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * Creates a SecureContentHandlerConfig using the passed in parameters.[0m      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:150[0m[39m-[0m[1;36m190[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        return [0m[1;35mcheck[0m[1;39m([0m[39mnew String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[39mcheckCmd[0m[1;39m}[0m[39m, errorValue[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:        if [0m[1;39m([0m[39merrorValue.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            errorValue = new int[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[1;36m127[0m[1;39m}[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            Thread stdErrSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            Thread stdOutSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getInputStream[0m[1;39m([0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;35mstdErrSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:            [0m[1;35mstdOutSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            [0m[35m/[0m[35m/[0m[95mmake[0m[39m the timeout parameterizable[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            boolean finished = [0m[1;35mprocess.waitFor[0m[1;39m([0m[1;36m60000[0m[39m, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39m!finished[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                throw new [0m[1;35mTimeoutException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            int result = [0m[1;35mprocess.exitValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"exit value for [0m[32m{[0m[32m}[0m[32m: [0m[32m{[0m[32m}[0m[32m"[0m[39m, checkCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, result[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            for [0m[1;39m([0m[39mint err : errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                if [0m[1;39m([0m[39mresult == err[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                    return false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:            return true;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException | InterruptedException | TimeoutException e[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"exception trying to run  "[0m[39m + checkCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, e[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            [0m[35m/[0m[35m/[0m[39m Some problem, command is there or is broken[0m                      [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            return false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSecurityException se[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:            [0m[35m/[0m[35m/[0m[39m External process execution is banned by the security manager[0m     [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:            throw se;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mError err[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            if [0m[1;39m([0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[39m != null && [0m                                    [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"posix_spawn"[0m[1;39m)[0m[39m ||[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:                    [0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"UNIXProcess"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                [0m[1;35mLOG.debug[0m[1;39m([0m[32m"[0m[32m([0m[32mTIKA-1526[0m[32m)[0m[32m: exception trying to run: "[0m[39m + [0m           [2m                [0m
[2;36m                    [0m         [39mcheckCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, err[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:                [0m[35m/[0m[35m/[0m[39m"Error forking command due to JVM locale bug[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/metadata/HTML.jav[0m[1;92ma:1[0m[39m-[0m[1;36m29[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:package org.apache.tika.metadata; [0m[35m/[0m[39m*[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: * [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:public interface HTML [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:    String PREFIX_HTML_META = [0m[32m"html_meta"[0m[39m + [0m                                     [2m                [0m
[2;36m                    [0m         [39mTikaCoreProperties.NAMESPACE_PREFIX_DELIMITER;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:     * If a script element contains a src value, this value[0m                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:     * is set in the embedded document's metadata[0m                                [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:    Property SCRIPT_SOURCE = [0m[1;35mProperty.internalText[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:            PREFIX_HTML_META + [0m[32m"scriptSrc"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/CompositeExternalParser.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:19[0m[39m-[0m[1;36m44[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.tika.mime.MediaTypeRegistry;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.tika.parser.CompositeParser;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m: * A Composite Parser that wraps up all the available External Parsers,[0m          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: * and provides an easy way to access them.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * Parser that uses an external program [0m[1;39m([0m[39mlike catdoc or pdf2txt[0m[1;39m)[0m[39m to extract[0m      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: * text content and metadata from a given document.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:public class CompositeExternalParser extends CompositeParser [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private static final long serialVersionUID = 6962436916649024024L;[0m           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    public [0m[1;35mCompositeExternalParser[0m[1;39m([0m[1;39m)[0m[39m throws IOException, TikaException [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public [0m[1;35mCompositeExternalParser[0m[1;39m([0m[39mMediaTypeRegistry registry[0m[1;39m)[0m[39m throws [0m           [2m                [0m
[2;36m                    [0m         [39mIOException, TikaException [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mregistry, [0m[1;39m([0m[39mList<Parser>[0m[1;39m)[0m[39m [0m[1;39m([0m[39mList<? extends Parser>[0m[1;39m)[0m[39m [0m                 [2m                [0m
[2;36m                    [0m         [1;35mExternalParsersFactory.create[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParsersFactory.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:19[0m[39m-[0m[1;36m33[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.tika.config.ServiceLoader;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.config.TikaConfig;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.parser.CompositeParser;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParsersFactory.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:41[0m[39m-[0m[1;36m85[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:public class ExternalParsersFactory [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    public static List<ExternalParser> [0m[1;35mcreate[0m[1;39m([0m[1;39m)[0m[39m throws IOException, [0m             [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        return [0m[1;35mcreate[0m[1;39m([0m[39mnew [0m[1;35mServiceLoader[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    public static List<ExternalParser> [0m[1;35mcreate[0m[1;39m([0m[39mServiceLoader loader[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            throws IOException, TikaException [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        return [0m[1;35mcreate[0m[1;39m([0m[32m"tika-external-parsers.xml"[0m[39m, loader[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public static List<ExternalParser> [0m[1;35mcreate[0m[1;39m([0m[39mString filename, ServiceLoader [0m    [2m                [0m
[2;36m                    [0m         [39mloader[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            throws IOException, TikaException [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        String filepath =[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:                [0m[1;35mExternalParsersFactory.class.getPackage[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[32m'.'[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [32m'/'[0m[1;39m)[0m[39m + [0m[32m"/"[0m[39m +[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                        filename;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        Enumeration<URL> files = [0m[1;35mloader.findServiceResources[0m[1;39m([0m[39mfilepath[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        ArrayList<URL> list = [0m[1;35mCollections.list[0m[1;39m([0m[39mfiles[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        URL[0m[1;39m[[0m[1;39m][0m[39m urls = [0m[1;35mlist.toArray[0m[1;39m([0m[39mnew URL[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        return [0m[1;35mcreate[0m[1;39m([0m[39murls[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    public static List<ExternalParser> [0m[1;35mcreate[0m[1;39m([0m[39mURL[0m[33m...[0m[39m urls[0m[1;39m)[0m[39m throws IOException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        List<ExternalParser> parsers = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        for [0m[1;39m([0m[39mURL url : urls[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            try [0m[1;39m([0m[39mInputStream stream = [0m[1;35murl.openStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                [0m[1;35mparsers.addAll[0m[1;39m([0m[1;35mExternalParsersConfigReader.read[0m[1;39m([0m[39mstream[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        return parsers;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    public static void [0m[1;35mattachExternalParsers[0m[1;39m([0m[39mTikaConfig config[0m[1;39m)[0m[39m throws [0m          [2m                [0m
[2;36m                    [0m         [39mIOException, TikaException [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;35mattachExternalParsers[0m[1;39m([0m[1;35mcreate[0m[1;39m([0m[1;39m)[0m[39m, config[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    public static void [0m[1;35mattachExternalParsers[0m[1;39m([0m[39mList<ExternalParser> parsers, [0m      [2m                [0m
[2;36m                    [0m         [39mTikaConfig config[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        Parser parser = [0m[1;35mconfig.getParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        if [0m[1;39m([0m[39mparser instanceof CompositeParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:            CompositeParser cParser = [0m[1;39m([0m[39mCompositeParser[0m[1;39m)[0m[39m parser;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            Map<MediaType, Parser> parserMap = [0m[1;35mcParser.getParsers[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[35m/[0m[35m/[0m[39m TODO[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:280[0m[39m-[0m[1;36m350[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    private void [0m[1;35mparse[0m[1;39m([0m[39mTikaInputStream stream, XHTMLContentHandler xhtml, [0m      [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                       TemporaryResources tmp[0m[1;39m)[0m[39m throws IOException, [0m             [2m                [0m
[2;36m                    [0m         [39mSAXException, TikaException [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        boolean inputToStdIn = true;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        boolean outputFromStdOut = true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        boolean hasPatterns = [0m[1;39m([0m[39mmetadataPatterns != null && [0m                     [2m                [0m
[2;36m                    [0m         [39m![0m[1;35mmetadataPatterns.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:        File output = null;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build our command[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                inputToStdIn = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                output = [0m[1;35mtmp.createTemporaryFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                outputFromStdOut = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m[1;35moutput.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:            if [0m[1;39m([0m[39minputToStdIn[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:                [0m[1;35msendInput[0m[1;39m([0m[39mprocess, stream[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:                [0m[1;35mprocess.getOutputStream[0m[1;39m([0m[1;39m)[0m[1;35m.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:            InputStream out = [0m[1;35mprocess.getInputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:            InputStream err = [0m[1;35mprocess.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:            if [0m[1;39m([0m[39mhasPatterns[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:                [0m[1;35mextractMetadata[0m[1;39m([0m[39merr, metadata[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:                if [0m[1;39m([0m[39moutputFromStdOut[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:                    [0m[1;35mextractOutput[0m[1;39m([0m[39mout, xhtml[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:                    [0m[1;35mextractMetadata[0m[1;39m([0m[39mout, metadata[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:                [0m[1;35mignoreStream[0m[1;39m([0m[39merr[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:                if [0m[1;39m([0m[39moutputFromStdOut[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:                    [0m[1;35mextractOutput[0m[1;39m([0m[39mout, xhtml[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:                    [0m[1;35mignoreStream[0m[1;39m([0m[39mout[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:                [0m[1;35mprocess.waitFor[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException ignore[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/EmbeddedDocumentUtil.jav[0m[1;92ma:20[0m[39m-[0m[1;36m42[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.tika.config.TikaConfig;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.tika.detect.Detector;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.mime.MimeType;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.mime.MimeTypeException;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.mime.MimeTypes;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.parser.AutoDetectParser;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.parser.CompositeParser;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.parser.ParserDecorator;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.parser.PasswordProvider;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.parser.StatefulParser;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.utils.ExceptionUtils;[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/EmbeddedDocumentUtil.jav[0m[1;92ma:239[0m[39m-[0m[1;36m261[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    public static Parser [0m[1;35mtryToFindExistingLeafParser[0m[1;39m([0m[39mClass clazz, ParseContext [0m [2m                [0m
[2;36m                    [0m         [39mcontext[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:        Parser p = [0m[1;35mcontext.get[0m[1;39m([0m[39mParser.class[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:        if [0m[1;39m([0m[1;35mequals[0m[1;39m([0m[39mp, clazz[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:            return p;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:        Parser returnParser = null;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:        if [0m[1;39m([0m[39mp != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:            if [0m[1;39m([0m[39mp instanceof ParserDecorator[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:                p = [0m[1;35mfindInDecorated[0m[1;39m([0m[1;39m([0m[39mParserDecorator[0m[1;39m)[0m[39m p, clazz[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:            if [0m[1;39m([0m[1;35mequals[0m[1;39m([0m[39mp, clazz[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:                return p;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:            if [0m[1;39m([0m[39mp instanceof CompositeParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:                returnParser = [0m[1;35mfindInComposite[0m[1;39m([0m[1;39m([0m[39mCompositeParser[0m[1;39m)[0m[39m p, clazz, [0m     [2m                [0m
[2;36m                    [0m         [39mcontext[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:        if [0m[1;39m([0m[39mreturnParser != null && [0m[1;35mequals[0m[1;39m([0m[39mreturnParser, clazz[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:            return returnParser;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:55[0m[39m-[0m[1;36m100[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m55:c[0m[39mlass HtmlHandler extends TextContentHandler [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[35m/[0m[35m/[0m[39m List of attributes that need to be resolved.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    private static final Set<String> URI_ATTRIBUTES =[0m                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            new HashSet<>[0m[1;39m([0m[1;35mArrays.asList[0m[1;39m([0m[32m"src"[0m[39m, [0m[32m"href"[0m[39m, [0m[32m"longdesc"[0m[39m, [0m[32m"cite"[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private static final Pattern ICBM =[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            [0m[1;35mPattern.compile[0m[1;39m([0m[32m"\\s*[0m[32m([0m[32m-?\\d+\\.\\d+[0m[32m)[0m[32m[[0m[32m,\\s[0m[32m][0m[32m+[0m[32m([0m[32m-?\\d+\\.\\d+[0m[32m)[0m[32m\\s*"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final Map<String, Property> META_[0m[1;33mHEAD[0m[39mER_MAPPINGS = new [0m       [2m                [0m
[2;36m                    [0m         [39mHashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    private static final MediaType JPEG = [0m[1;35mMediaType.image[0m[1;39m([0m[32m"jpeg"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    static [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"author"[0m[39m, TikaCoreProperties.CREATOR[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"title"[0m[39m, TikaCoreProperties.TITLE[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"subject"[0m[39m, TikaCoreProperties.SUBJECT[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"keywords"[0m[39m, Office.KEYWORDS[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"description"[0m[39m, TikaCoreProperties.DESCRIPTION[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    private static final Attributes EMPTY_ATTS = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private final HtmlMapper mapper;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    private final XHTMLContentHandler xhtml;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private final Metadata metadata;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private final ParseContext context;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private final boolean extractScripts;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private final StringBuilder title = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    private final DataURISchemeUtil dataURISchemeUtil = new [0m[1;35mDataURISchemeUtil[0m[1;39m([0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private final StringBuilder script = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private int bodyLevel = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    private int discardLevel = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    private int titleLevel = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    private int scriptLevel = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private Attributes scriptAtts = EMPTY_ATTS;[0m[35m/[0m[35m/[0m[95mattributes[0m[39m from outermost [0m      [2m                [0m
[2;36m                    [0m         [39mscript element[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    private boolean isTitleSetToMetadata = false;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    private [0m[1;35mHtmlHandler[0m[1;39m([0m[39mHtmlMapper mapper, XHTMLContentHandler xhtml, Metadata [0m  [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                        ParseContext context, boolean extractScripts[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mxhtml[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        this.mapper = mapper;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        this.xhtml = xhtml;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        this.metadata = metadata;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        this.context = context;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        this.extractScripts = extractScripts;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[35m/[0m[35m/[0m[39m Try to determine the default base URL, if one has not been given[0m      [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[39mMetadata.CONTENT_LOCATION[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                name = [0m[1;35mname.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:354[0m[39m-[0m[1;36m471[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    private void [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        DataURIScheme dataURIScheme = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            dataURIScheme = [0m[1;35mdataURISchemeUtil.parse[0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mDataURISchemeParseException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    private int [0m[1;35mconfigureExifTool[0m[1;39m([0m[39mString path[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:        int retVal = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:            CompositeExternalParser exParser =[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:                    [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:                            context[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:            if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:                [0m[35m/[0m[35m/[0m[95mlasciate[0m[39m ogne speranza[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:                return [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:            exifToolParser = new [0m[1;35mExternalParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:            retVal = [0m[1;36m1[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:            [0m[1;35mparsers.put[0m[1;39m([0m[39mJPEG, exifToolParser[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:            [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:        Set<MediaType> supported = new [0m                                         [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:        [0m[1;35msupported.add[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[39mpath, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39msupported[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:        return retVal;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:    private void [0m[1;35mresetExifTool[0m[1;39m([0m[39mint added[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:        if [0m[1;39m([0m[39madded == [0m[1;36m2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:        CompositeExternalParser exParser =[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:                [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:                        context[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:        if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        if [0m[1;39m([0m[39madded == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:            [0m[1;35mparsers.remove[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:        Set<MediaType> supported = new [0m                                         [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:        Set<MediaType> newSupported = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:        for [0m[1;39m([0m[39mMediaType m : supported[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mm.getSubtype[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"jpeg"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:                [0m[1;35mnewSupported.add[0m[1;39m([0m[39mm[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[32m"exiftool"[0m[39m, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39mnewSupported[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:        [0m[1;35mmetadata.remove[0m[1;39m([0m[32m"exiftool_path"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:        Map<MediaType, Parser> updated = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:        for [0m[1;39m([0m[39mMap.Entry<MediaType, Parser> e : [0m[1;35mexParser.getParsers[0m[1;39m([0m[1;39m)[0m[1;35m.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:            if [0m[1;39m([0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m instanceof ExternalParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:                ExternalParser p = [0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m [0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:                if [0m[1;39m([0m[1;35mExternalParser.check[0m[1;39m([0m[1;35mp.getCommand[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:                    for [0m[1;39m([0m[39mMediaType mediaType : [0m[1;35mp.getSupportedTypes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:                        [0m[1;35mupdated.put[0m[1;39m([0m[39mmediaType, p[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:        [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m451[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m452[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m453[0m[39m:    private ExternalParser [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m454[0m[39m:        CompositeExternalParser exParser =[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m455[0m[39m:                [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m456[0m[39m:                        context[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m457[0m[39m:        if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m458[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:        for [0m[1;39m([0m[39mParser p : [0m[1;35mexParser.getAllComponentParsers[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:            if [0m[1;39m([0m[39mp instanceof ExternalParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:                String[0m[1;39m[[0m[1;39m][0m[39m args = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m p[0m[1;39m)[0m[1;35m.getCommand[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m463[0m[39m:                for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < args.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m464[0m[39m:                    if [0m[1;39m([0m[39margs[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[32m"exiftool"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m465[0m[39m:                        return [0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m p;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m467[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:190[0m[39m-[0m[1;36m236[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    private void [0m[1;35maddHtmlMetadata[0m[1;39m([0m[39mString name, String value[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        [0m[35m/[0m[35m/[0m[95mnote[0m[39m that [0m[32m"name"[0m[39m derives from attributes and is not uppercased[0m        [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[35m/[0m[35m/[0m[95mlike[0m[39m the elements by the XHTMLDowngradeHandler[0m                        [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || [0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[32m"ICBM"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            Matcher m = [0m[1;35mICBM.matcher[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            if [0m[1;39m([0m[1;35mm.matches[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[32m"ICBM"[0m[39m, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m + [0m[32m", "[0m[39m + [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.LATITUDE, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.LONGITUDE, [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[32m"ICBM"[0m[39m, value[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[39mMetadata.CONTENT_TYPE[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[35m/[0m[35m/[0m[95mdon[0m[39m't overwrite Metadata.CONTENT_TYPE![0m                            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            MediaType type = [0m[1;35mMediaType.parse[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_HINT, [0m             [2m                [0m
[2;36m                    [0m         [1;35mtype.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_HINT, value[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        String lcName = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.US[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        if [0m[1;39m([0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.containsKey[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            Property property = [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.get[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            if [0m[1;39m([0m[1;35mproperty.equals[0m[1;39m([0m[39mTikaCoreProperties.TITLE[0m[1;39m)[0m[39m && [0m                   [2m                [0m
[2;36m                    [0m         [39misTitleSetToMetadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                [0m[35m/[0m[35m/[0m[95mprefer[0m[39m the title element if it is already set[0m                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                [0m[35m/[0m[35m/[0m[95mdo[0m[39m nothing[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + [0m                           [2m                [0m
[2;36m                    [0m         [1;35mTikaCoreProperties.TITLE.getName[0m[1;39m([0m[1;39m)[0m[39m, value[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mproperty.isMultiValuePermitted[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + name, value[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:280[0m[39m-[0m[1;36m318[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    private void [0m[1;35mparse[0m[1;39m([0m[39mTikaInputStream stream, XHTMLContentHandler xhtml, [0m      [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                       TemporaryResources tmp[0m[1;39m)[0m[39m throws IOException, [0m             [2m                [0m
[2;36m                    [0m         [39mSAXException, TikaException [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        boolean inputToStdIn = true;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        boolean outputFromStdOut = true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        boolean hasPatterns = [0m[1;39m([0m[39mmetadataPatterns != null && [0m                     [2m                [0m
[2;36m                    [0m         [39m![0m[1;35mmetadataPatterns.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:        File output = null;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build our command[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                inputToStdIn = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                output = [0m[1;35mtmp.createTemporaryFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                outputFromStdOut = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m[1;35moutput.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:150[0m[39m-[0m[1;36m200[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        return [0m[1;35mcheck[0m[1;39m([0m[39mnew String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[39mcheckCmd[0m[1;39m}[0m[39m, errorValue[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:        if [0m[1;39m([0m[39merrorValue.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            errorValue = new int[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[1;36m127[0m[1;39m}[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            Thread stdErrSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            Thread stdOutSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getInputStream[0m[1;39m([0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;35mstdErrSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:            [0m[1;35mstdOutSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            [0m[35m/[0m[35m/[0m[95mmake[0m[39m the timeout parameterizable[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            boolean finished = [0m[1;35mprocess.waitFor[0m[1;39m([0m[1;36m60000[0m[39m, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39m!finished[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                throw new [0m[1;35mTimeoutException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            int result = [0m[1;35mprocess.exitValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"exit value for [0m[32m{[0m[32m}[0m[32m: [0m[32m{[0m[32m}[0m[32m"[0m[39m, checkCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, result[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            for [0m[1;39m([0m[39mint err : errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                if [0m[1;39m([0m[39mresult == err[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                    return false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:            return true;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException | InterruptedException | TimeoutException e[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"exception trying to run  "[0m[39m + checkCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, e[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            [0m[35m/[0m[35m/[0m[39m Some problem, command is there or is broken[0m                      [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            return false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSecurityException se[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:            [0m[35m/[0m[35m/[0m[39m External process execution is banned by the security manager[0m     [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:            throw se;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mError err[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            if [0m[1;39m([0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[39m != null && [0m                                    [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"posix_spawn"[0m[1;39m)[0m[39m ||[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:                    [0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"UNIXProcess"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                [0m[1;35mLOG.debug[0m[1;39m([0m[32m"[0m[32m([0m[32mTIKA-1526[0m[32m)[0m[32m: exception trying to run: "[0m[39m + [0m           [2m                [0m
[2;36m                    [0m         [39mcheckCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, err[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:                [0m[35m/[0m[35m/[0m[39m"Error forking command due to JVM locale bug[0m                  [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                [0m[35m/[0m[35m/[0m[1;39m([0m[39msee TIKA-[0m[1;36m1526[0m[39m and SOLR-[0m[1;36m6387[0m[1;39m)[0m[39m"[0m                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                return false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            [0m[35m/[0m[35m/[0m[95mthrow[0m[39m if a different kind of error[0m                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            throw err;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:            if [0m[1;39m([0m[39mprocess != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;35mprocess.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:226[0m[39m-[0m[1;36m228[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    public void [0m[1;35msetCommand[0m[1;39m([0m[39mString[0m[33m...[0m[39m command[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        this.command = command;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:354[0m[39m-[0m[1;36m408[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    private void [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        DataURIScheme dataURIScheme = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            dataURIScheme = [0m[1;35mdataURISchemeUtil.parse[0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mDataURISchemeParseException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    private int [0m[1;35mconfigureExifTool[0m[1;39m([0m[39mString path[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:        int retVal = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:            CompositeExternalParser exParser =[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:                    [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:                            context[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:            if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:                [0m[35m/[0m[35m/[0m[95mlasciate[0m[39m ogne speranza[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:                return [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:            exifToolParser = new [0m[1;35mExternalParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:            retVal = [0m[1;36m1[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:            [0m[1;35mparsers.put[0m[1;39m([0m[39mJPEG, exifToolParser[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:            [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:        Set<MediaType> supported = new [0m                                         [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:        [0m[1;35msupported.add[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[39mpath, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39msupported[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:        return retVal;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:410[0m[39m-[0m[1;36m471[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:    private void [0m[1;35mresetExifTool[0m[1;39m([0m[39mint added[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:        if [0m[1;39m([0m[39madded == [0m[1;36m2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:        CompositeExternalParser exParser =[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:                [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:                        context[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:        if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        if [0m[1;39m([0m[39madded == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:            [0m[1;35mparsers.remove[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:        Set<MediaType> supported = new [0m                                         [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:        Set<MediaType> newSupported = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:        for [0m[1;39m([0m[39mMediaType m : supported[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mm.getSubtype[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"jpeg"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:                [0m[1;35mnewSupported.add[0m[1;39m([0m[39mm[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[32m"exiftool"[0m[39m, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39mnewSupported[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:        [0m[1;35mmetadata.remove[0m[1;39m([0m[32m"exiftool_path"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:        Map<MediaType, Parser> updated = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:        for [0m[1;39m([0m[39mMap.Entry<MediaType, Parser> e : [0m[1;35mexParser.getParsers[0m[1;39m([0m[1;39m)[0m[1;35m.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:            if [0m[1;39m([0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m instanceof ExternalParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:                ExternalParser p = [0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m [0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:                if [0m[1;39m([0m[1;35mExternalParser.check[0m[1;39m([0m[1;35mp.getCommand[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:                    for [0m[1;39m([0m[39mMediaType mediaType : [0m[1;35mp.getSupportedTypes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:                        [0m[1;35mupdated.put[0m[1;39m([0m[39mmediaType, p[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:        [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m451[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m452[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m453[0m[39m:    private ExternalParser [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m454[0m[39m:        CompositeExternalParser exParser =[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m455[0m[39m:                [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m456[0m[39m:                        context[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m457[0m[39m:        if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m458[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:        for [0m[1;39m([0m[39mParser p : [0m[1;35mexParser.getAllComponentParsers[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:            if [0m[1;39m([0m[39mp instanceof ExternalParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:                String[0m[1;39m[[0m[1;39m][0m[39m args = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m p[0m[1;39m)[0m[1;35m.getCommand[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m463[0m[39m:                for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < args.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m464[0m[39m:                    if [0m[1;39m([0m[39margs[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[32m"exiftool"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m465[0m[39m:                        return [0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m p;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m467[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:190[0m[39m-[0m[1;36m236[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    private void [0m[1;35maddHtmlMetadata[0m[1;39m([0m[39mString name, String value[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        [0m[35m/[0m[35m/[0m[95mnote[0m[39m that [0m[32m"name"[0m[39m derives from attributes and is not uppercased[0m        [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[35m/[0m[35m/[0m[95mlike[0m[39m the elements by the XHTMLDowngradeHandler[0m                        [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || [0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[32m"ICBM"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            Matcher m = [0m[1;35mICBM.matcher[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            if [0m[1;39m([0m[1;35mm.matches[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[32m"ICBM"[0m[39m, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m + [0m[32m", "[0m[39m + [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.LATITUDE, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.LONGITUDE, [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[32m"ICBM"[0m[39m, value[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[39mMetadata.CONTENT_TYPE[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[35m/[0m[35m/[0m[95mdon[0m[39m't overwrite Metadata.CONTENT_TYPE![0m                            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            MediaType type = [0m[1;35mMediaType.parse[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_HINT, [0m             [2m                [0m
[2;36m                    [0m         [1;35mtype.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_HINT, value[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        String lcName = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.US[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        if [0m[1;39m([0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.containsKey[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            Property property = [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.get[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            if [0m[1;39m([0m[1;35mproperty.equals[0m[1;39m([0m[39mTikaCoreProperties.TITLE[0m[1;39m)[0m[39m && [0m                   [2m                [0m
[2;36m                    [0m         [39misTitleSetToMetadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                [0m[35m/[0m[35m/[0m[95mprefer[0m[39m the title element if it is already set[0m                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                [0m[35m/[0m[35m/[0m[95mdo[0m[39m nothing[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + [0m                           [2m                [0m
[2;36m                    [0m         [1;35mTikaCoreProperties.TITLE.getName[0m[1;39m([0m[1;39m)[0m[39m, value[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mproperty.isMultiValuePermitted[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + name, value[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and evaluation report, I've identified the [0m       [2m                [0m
[2;36m                    [0m         [39mcritical OS Command Injection vulnerability. The issue stems from multiple design [0m  [2m                [0m
[2;36m                    [0m         [39mflaws:[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Causes[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Untrusted Metadata as Configuration** [0m[1;39m([0m[39mPrimary Issue[0m[1;39m)[0m[39m:[0m                         [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mHtmlHandler.addHtmlMetadata[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m234[0m[39m stores ANY HTML meta tag as [0m       [2m                [0m
[2;36m                    [0m         [39mmetadata with prefix [0m[32m"html_meta:"[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mHtmlHandler.configureExifTool[0m[1;39m([0m[1;39m)[0m[39m` at lines [0m[1;36m363[0m[39m-[0m[1;36m364[0m[39m reads [0m                      [2m                [0m
[2;36m                    [0m         [32m"html_meta:exiftool_path"[0m[39m and uses it to configure `ExternalParser` commands[0m        [2m                [0m
[2;36m                    [0m         [39m   - No validation occurs between untrusted HTML input and sensitive command [0m       [2m                [0m
[2;36m                    [0m         [39mconfiguration[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Command Injection in ExternalParser** [0m[1;39m([0m[39mSecondary Issue[0m[1;39m)[0m[39m:[0m                       [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mExternalParser.parse[0m[1;39m([0m[1;39m)[0m[39m` at lines [0m[1;36m290[0m[39m-[0m[1;36m291[0m[39m splits single commands by spaces: [0m   [2m                [0m
[2;36m                    [0m         [39m`cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;`[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - `[0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m` at lines [0m[1;36m311[0m[39m-[0m[1;36m314[0m[39m executes these commands[0m                      [2m                [0m
[2;36m                    [0m         [39m   - Simple string replacement for IN[0m[1;33mPUT[0m[39m_FILE_TOKEN/OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN without [0m      [2m                [0m
[2;36m                    [0m         [39mproper escaping[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Runtime Parser Modification**:[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - HtmlHandler dynamically modifies parser configuration during parsing based on [0m [2m                [0m
[2;36m                    [0m         [39mdocument content[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - This violates the security principle that configuration should be static and [0m  [2m                [0m
[2;36m                    [0m         [39mfrom trusted sources[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Attack Vector[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```html[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<meta [0m[33mname[0m[39m=[0m[32m"exiftool_path"[0m[39m [0m[33mcontent[0m[39m=[0m[32m"malicious_command[0m[32m ; evil_command"[0m[39m>[0m              [2m                [0m
[2;36m                    [0m         [39m<img [0m[33msrc[0m[39m=[0m[32m"data[0m[32m:image/jpeg;base64,..."[0m[39m>[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe meta tag sets `metadata[0m[1;39m[[0m[32m"html_meta:exiftool_path"[0m[1;39m][0m[39m`, which is then used to [0m     [2m                [0m
[2;36m                    [0m         [39mconfigure an ExternalParser that executes the attacker-controlled command when [0m     [2m                [0m
[2;36m                    [0m         [39mprocessing the data URI.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must address the root cause while preserving legitimate functionality. I [0m   [2m                [0m
[2;36m                    [0m         [39mneed to examine the security boundaries and validation points.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<file>tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-[0m [2m                [0m
[2;36m                    [0m         [39mhtml-module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:354[0m[39m-[0m[1;36m408[0m[39m<[0m[35m/[0m[95mfil[0m [2m                [0m
[2;36m                    [0m         [95me[0m[39m>[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m<file>tika-core/src/main/java/org/apache/tika/config/TikaConfig.jav[0m[1;92ma:1[0m[39m-[0m[1;36m100[0m[39m<[0m[35m/[0m[95mfile[0m[39m>[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m---[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mBased on the retrieved context and analysis, here is the comprehensive fix [0m         [2m                [0m
[2;36m                    [0m         [39mstrategy:[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m1[0m[39m: Remove Dynamic External Parser Configuration from HTML Metadata[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Target File**: [0m                                                                   [2m                [0m
[2;36m                    [0m         [39m`tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-[0m [2m                [0m
[2;36m                    [0m         [39mmodule/src/main/java/org/apache/tika/parser/html/HtmlHandler.java`[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes in `[0m[1;35mhandleDataURIScheme[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m354[0m[39m-[0m[1;36m384[0m[1;39m)[0m[39m**:[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Remove the configureExifTool call entirely** [0m[1;39m([0m[39mlines [0m[1;36m363[0m[39m-[0m[1;36m365[0m[1;39m)[0m[39m:[0m                  [2m                [0m
[2;36m                    [0m         [39m   - Delete the code that reads [0m[32m"html_meta:exiftool_path"[0m[39m from metadata[0m             [2m                [0m
[2;36m                    [0m         [39m   - Delete the call to [0m                                                            [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m`[0m                        [2m                [0m
[2;36m                    [0m         [39m   - Delete the corresponding cleanup in finally block [0m[1;39m([0m[39mline [0m[1;36m381[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Remove the `added` variable and cleanup logic**:[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Remove `int added = [0m[1;36m0[0m[39m;` declaration [0m[1;39m([0m[39mline [0m[1;36m362[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [39m   - Remove `[0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;` call [0m[1;39m([0m[39mline [0m[1;36m381[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale**: This eliminates the attack vector where untrusted HTML metadata [0m     [2m                [0m
[2;36m                    [0m         [39mcontrols external command execution. The legitimate use case [0m[1;39m([0m[39mallowing users to [0m    [2m                [0m
[2;36m                    [0m         [39mconfigure exiftool path[0m[1;39m)[0m[39m should be handled through proper configuration mechanisms,[0m [2m                [0m
[2;36m                    [0m         [39mnot through document content.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m2[0m[39m: Remove Supporting Methods for Dynamic Configuration[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Target File**: Same file as Step [0m[1;36m1[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Remove these methods entirely**:[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **`[0m[1;35mconfigureExifTool[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m386[0m[39m-[0m[1;36m408[0m[1;39m)[0m[39m**:[0m                                [2m                [0m
[2;36m                    [0m         [39m   - This method directly enables the vulnerability by accepting a path from [0m       [2m                [0m
[2;36m                    [0m         [39mmetadata[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - Complete removal prevents any future use of this dangerous pattern[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **`[0m[1;35mresetExifTool[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m410[0m[39m-[0m[1;36m451[0m[1;39m)[0m[39m**:[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - This cleanup method is only needed for the dynamic configuration[0m               [2m                [0m
[2;36m                    [0m         [39m   - Remove it as it's no longer necessary[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **`[0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m453[0m[39m-[0m[1;36m471[0m[1;39m)[0m[39m**:[0m                        [2m                [0m
[2;36m                    [0m         [39m   - This helper is only used by the removed methods[0m                                [2m                [0m
[2;36m                    [0m         [39m   - Remove it to clean up unused code[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale**: Removing these methods prevents any resurrection of this [0m            [2m                [0m
[2;36m                    [0m         [39mvulnerability pattern and makes it clear that dynamic parser configuration from [0m    [2m                [0m
[2;36m                    [0m         [39mdocument content is not supported.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m3[0m[39m: Prevent Similar Vulnerabilities in [0m[1;35maddHtmlMetadata[0m[1;39m([0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Target File**: Same file as above[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes in `[0m[1;35maddHtmlMetadata[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m190[0m[39m-[0m[1;36m236[0m[1;39m)[0m[39m**:[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd validation to reject dangerous metadata keys that could influence parser [0m       [2m                [0m
[2;36m                    [0m         [39mbehavior:[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **After line [0m[1;36m196[0m[39m [0m[1;39m([0m[39mblank value check[0m[1;39m)[0m[39m, add a security check**:[0m                    [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   [0m[35m/[0m[35m/[0m[39m Security: Reject metadata keys that could influence parser configuration[0m      [2m                [0m
[2;36m                    [0m         [39m   String lcName = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.US[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[1;35misDangerousMetadataKey[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Rejected potentially dangerous HTML metadata key: [0m[32m{[0m[32m}[0m[32m"[0m[39m, name[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [39m       return;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Add a new private method** before or after [0m[1;35maddHtmlMetadata[0m[1;39m([0m[1;39m)[0m[39m:[0m                  [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   private static final Set<String> DANGEROUS_METADATA_KEYS = new [0m                  [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mArrays.asList[0m[1;39m([0m                                                            [2m                [0m
[2;36m                    [0m         [39m       [0m[32m"exiftool_path"[0m[39m,[0m                                                             [2m                [0m
[2;36m                    [0m         [39m       [0m[32m"command"[0m[39m,[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m       [0m[32m"parser_command"[0m[39m,[0m                                                            [2m                [0m
[2;36m                    [0m         [39m       [0m[32m"external_command"[0m[39m,[0m                                                          [2m                [0m
[2;36m                    [0m         [39m       [0m[32m"exec"[0m[39m,[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m       [0m[32m"shell"[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   private boolean [0m[1;35misDangerousMetadataKey[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [39m       [0m[35m/[0m[35m/[0m[39m Check exact matches[0m                                                       [2m                [0m
[2;36m                    [0m         [39m       if [0m[1;39m([0m[1;35mDANGEROUS_METADATA_KEYS.contains[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [39m           return true;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m       [0m[35m/[0m[35m/[0m[39m Check for patterns that suggest command configuration[0m                     [2m                [0m
[2;36m                    [0m         [39m       return [0m[1;35mname.contains[0m[1;39m([0m[32m"command"[0m[1;39m)[0m[39m || [0m                                          [2m                [0m
[2;36m                    [0m         [39m              [0m[1;35mname.contains[0m[1;39m([0m[32m"exec"[0m[1;39m)[0m[39m || [0m                                             [2m                [0m
[2;36m                    [0m         [39m              [0m[1;35mname.contains[0m[1;39m([0m[32m"path"[0m[1;39m)[0m[39m && [0m[1;39m([0m[1;35mname.contains[0m[1;39m([0m[32m"tool"[0m[1;39m)[0m[39m || [0m                   [2m                [0m
[2;36m                    [0m         [1;35mname.contains[0m[1;39m([0m[32m"parser"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale**: This provides defense-in-depth by preventing similar attacks using [0m  [2m                [0m
[2;36m                    [0m         [39mdifferent metadata key names. Even if someone tries to add similar functionality in[0m [2m                [0m
[2;36m                    [0m         [39mthe future, this check will block it.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m4[0m[39m: Fix ExternalParser Command Execution [0m[1;39m([0m[39mDefense in Depth[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Target File**: [0m                                                                   [2m                [0m
[2;36m                    [0m         [39m`tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java`[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Note**: While removing the HTML-based configuration eliminates the immediate [0m     [2m                [0m
[2;36m                    [0m         [39mthreat, we should still fix the underlying command execution vulnerability for [0m     [2m                [0m
[2;36m                    [0m         [39mdefense in depth.[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes in `[0m[1;35mparse[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m280[0m[39m-[0m[1;36m318[0m[1;39m)[0m[39m**:[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Replace the vulnerable command splitting logic [0m[1;39m([0m[39mlines [0m[1;36m289[0m[39m-[0m[1;36m295[0m[1;39m)[0m[39m**:[0m              [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   Remove:[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [39m       cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m       cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   Replace with:[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   String[0m[1;39m[[0m[1;39m][0m[39m cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m   [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Update the execution logic [0m[1;39m([0m[39mlines [0m[1;36m308[0m[39m-[0m[1;36m318[0m[1;39m)[0m[39m**:[0m                                  [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   Remove:[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [39m       process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m       process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   Replace with:[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   [0m[35m/[0m[35m/[0m[39m Always use array form to prevent shell injection[0m                              [2m                [0m
[2;36m                    [0m         [39m   process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale**: [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- The string splitting at line [0m[1;36m291[0m[39m [0m[1;39m([0m[39m`command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m treats a single [0m       [2m                [0m
[2;36m                    [0m         [39mcommand as a shell command, enabling shell metacharacter injection[0m                  [2m                [0m
[2;36m                    [0m         [39m- Always using the array form of [0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m prevents shell interpretation[0m       [2m                [0m
[2;36m                    [0m         [39m- This makes the command structure explicit and prevents injection even if the [0m     [2m                [0m
[2;36m                    [0m         [39mcommand array is somehow controlled by an attacker[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m5[0m[39m: Add Documentation and Warnings[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Target Files**: Multiple files[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **In `ExternalParser.java`**, add JavaDoc warnings to `[0m[1;35msetCommand[0m[1;39m([0m[1;39m)[0m[39m` method [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mline [0m[1;36m226[0m[1;39m)[0m[39m:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   [0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m    * Sets the command to be run. This can include either of[0m                        [2m                [0m
[2;36m                    [0m         [39m    * [0m[1;39m{[0m[39m@link #IN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m[39m or [0m[1;39m{[0m[39m@link #OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m                       [2m                [0m
[2;36m                    [0m         [39m    * if the command needs filenames.[0m                                               [2m                [0m
[2;36m                    [0m         [39m    * [0m                                                                              [2m                [0m
[2;36m                    [0m         [39m    * <p><strong>Security Warning:<[0m[35m/[0m[95mstrong[0m[39m> The command must be from a trusted [0m     [2m                [0m
[2;36m                    [0m         [39msource.[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    * Never set the command based on untrusted input such as document content or[0m    [2m                [0m
[2;36m                    [0m         [39m    * user-controlled metadata. Doing so can lead to arbitrary command execution.[0m   [2m                [0m
[2;36m                    [0m         [39m    * [0m                                                                              [2m                [0m
[2;36m                    [0m         [39m    * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   public void [0m[1;35msetCommand[0m[1;39m([0m[39mString[0m[33m...[0m[39m command[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [39m       this.command = command;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **In `HtmlHandler.java`**, add a class-level comment explaining the security [0m    [2m                [0m
[2;36m                    [0m         [39mconsiderations:[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   [0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m    * Handles HTML parsing and metadata extraction.[0m                                 [2m                [0m
[2;36m                    [0m         [39m    * [0m                                                                              [2m                [0m
[2;36m                    [0m         [39m    * <p><strong>Security Note:<[0m[35m/[0m[95mstrong[0m[39m> This handler processes untrusted HTML [0m     [2m                [0m
[2;36m                    [0m         [39mcontent.[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    * Metadata extracted from HTML [0m[1;39m([0m[39mwith prefix [0m[32m"html_meta:"[0m[1;39m)[0m[39m must never be used [0m   [2m                [0m
[2;36m                    [0m         [39mfor[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m    * security-sensitive operations such as command execution or parser [0m            [2m                [0m
[2;36m                    [0m         [39mconfiguration.[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m    *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   class HtmlHandler extends TextContentHandler [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m6[0m[39m: Update Related Check Methods[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Target File**: [0m                                                                   [2m                [0m
[2;36m                    [0m         [39m`tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java`[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fix the `[0m[1;35mcheck[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m150[0m[39m-[0m[1;36m200[0m[1;39m)[0m[39m** to also avoid shell interpretation:[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Update line [0m[1;36m161[0m[39m** from:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m   To:[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   ```java[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   [0m[35m/[0m[35m/[0m[39m Use ProcessBuilder to avoid shell interpretation[0m                              [2m                [0m
[2;36m                    [0m         [39m   process = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[1;35m.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale**: The [0m[1;35mcheck[0m[1;39m([0m[1;39m)[0m[39m method has the same vulnerability pattern. While it's [0m   [2m                [0m
[2;36m                    [0m         [39mtypically called with hardcoded commands, fixing it provides consistency and [0m       [2m                [0m
[2;36m                    [0m         [39mprevents future issues.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Why This Strategy is Optimal[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. **Addresses Root Cause**:[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - Completely removes the ability to configure external parsers from HTML [0m        [2m                [0m
[2;36m                    [0m         [39mmetadata[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - Eliminates the trust boundary violation where untrusted document content [0m      [2m                [0m
[2;36m                    [0m         [39minfluences security-sensitive configuration[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. **Preserves Existing Functionality**:[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - Data URI parsing still works correctly for legitimate use cases[0m                [2m                [0m
[2;36m                    [0m         [39m   - External parsers configured through proper channels [0m[1;39m([0m[39mXML config, programmatic [0m [2m                [0m
[2;36m                    [0m         [39mAPI[0m[1;39m)[0m[39m continue to function[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - Only removes the dangerous dynamic configuration path[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. **Defense in Depth**:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - Primary fix: Remove HTML-based parser configuration[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Secondary fix: Improve ExternalParser command execution to prevent shell [0m      [2m                [0m
[2;36m                    [0m         [39minjection[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - Tertiary fix: Add validation to reject dangerous metadata keys[0m                 [2m                [0m
[2;36m                    [0m         [39m   - Documentation: Warn future developers about security considerations[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. **No Breaking Changes to Core Functionality**:[0m                               [2m                [0m
[2;36m                    [0m         [39m   - The removed functionality [0m[1;39m([0m[39mconfiguring parsers via HTML meta tags[0m[1;39m)[0m[39m was never a[0m [2m                [0m
[2;36m                    [0m         [39mdocumented or intended feature[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - It appears to be a convenience hack that created a critical security [0m          [2m                [0m
[2;36m                    [0m         [39mvulnerability[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   - Proper external parser configuration should use TikaConfig or programmatic [0m    [2m                [0m
[2;36m                    [0m         [39mAPIs[0m                                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. **Prevents Similar Future Issues**:[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - The dangerous metadata key validation prevents similar attacks using different[0m [2m                [0m
[2;36m                    [0m         [39mkey names[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - Documentation warns developers about security boundaries[0m                       [2m                [0m
[2;36m                    [0m         [39m   - Command execution improvements prevent shell injection regardless of command [0m  [2m                [0m
[2;36m                    [0m         [39msource[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Potential Side Effects and Mitigation[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Side Effect [0m[1;36m1[0m[39m: Loss of Dynamic Exiftool Configuration[0m                           [2m                [0m
[2;36m                    [0m         [39m- **Impact**: Users cannot configure exiftool path via HTML meta tags[0m               [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: This was never intended functionality. Proper configuration [0m      [2m                [0m
[2;36m                    [0m         [39mshould use:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m  - TikaConfig XML configuration[0m                                                    [2m                [0m
[2;36m                    [0m         [39m  - Programmatic [0m[1;35mExternalParser.setCommand[0m[1;39m([0m[1;39m)[0m[39m before parsing[0m                         [2m                [0m
[2;36m                    [0m         [39m  - System properties or environment variables[0m                                      [2m                [0m
[2;36m                    [0m         [39m- **Assessment**: Acceptable - security takes precedence[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Side Effect [0m[1;36m2[0m[39m: Tests May Fail[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- **Impact**: If any tests rely on the html_met[0m[1;92ma:e[0m[39mxiftool_path feature, they will [0m  [2m                [0m
[2;36m                    [0m         [39mfail[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: Update tests to use proper configuration mechanisms[0m               [2m                [0m
[2;36m                    [0m         [39m- **Assessment**: Tests should be updated, not the fix[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Side Effect [0m[1;36m3[0m[39m: Performance Impact [0m[1;39m([0m[39mMinimal[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m- **Impact**: Additional validation in [0m[1;35maddHtmlMetadata[0m[1;39m([0m[1;39m)[0m[39m adds overhead[0m              [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: The check is simple string comparison/matching, negligible cost[0m   [2m                [0m
[2;36m                    [0m         [39m- **Assessment**: Negligible performance impact[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Code Ranges Used in Fix Strategy[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<code_range>tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-p[0m [2m                [0m
[2;36m                    [0m         [39marser-html-module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:354[0m[39m-[0m[1;36m47[0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m<code_range>tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-p[0m [2m                [0m
[2;36m                    [0m         [39marser-html-module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:190[0m[39m-[0m[1;36m23[0m [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m<code_range>tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:280[0m[39m-[0m[1;36m318[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_range>tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:150[0m[39m-[0m[1;36m200[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_range>tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:226[0m[39m-[0m[1;36m228[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/06/26 18:31:45][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=949292;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=87408;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[01/06/26 18:36:06][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=583259;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=857823;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[01/06/26 18:37:34][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=670125;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=685630;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=551653;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=957409;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:37:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.97[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=135815;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=570483;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/06/26 18:37:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=630314;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=442452;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpm3pxwakc[0m                                                 ]8;id=508421;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=358008;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/06/26 18:38:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m70.58[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=562085;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=334495;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Started[33m...[0m                          ]8;id=618756;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=293735;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:39:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Took [1;36m33.81[0m seconds;                ]8;id=176514;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=242010;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Started[33m...[0m                             ]8;id=509510;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=397840;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:39:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Took [1;36m13.56[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=201302;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=540265;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Started[33m...[0m                                 ]8;id=219642;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=657626;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=126877;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=545465;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=746878;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=912874;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:39:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.84[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=363797;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=110047;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/06/26 18:39:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=529265;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=977680;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:39:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.96[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=659317;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=7630;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=650585;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=620930;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/06/26 18:39:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.93[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=986468;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=545780;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/06/26 18:39:39][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=787793;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=322772;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         ---                                                                                 [2m                [0m
[2;36m                    [0m         a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html [2m                [0m
[2;36m                    [0m         -module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java                  [2m                [0m
[2;36m                    [0m         +++                                                                                 [2m                [0m
[2;36m                    [0m         b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html [2m                [0m
[2;36m                    [0m         -module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-30[0m,[1;36m6[0m +[1;36m30[0m,[1;36m8[0m @@                                                                   [2m                [0m
[2;36m                    [0m          import java.util.regex.Matcher;                                                    [2m                [0m
[2;36m                    [0m          import java.util.regex.Pattern;                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         +import org.slf4j.Logger;                                                           [2m                [0m
[2;36m                    [0m         +import org.slf4j.LoggerFactory;                                                    [2m                [0m
[2;36m                    [0m          import org.xml.sax.Attributes;                                                     [2m                [0m
[2;36m                    [0m          import org.xml.sax.ContentHandler;                                                 [2m                [0m
[2;36m                    [0m          import org.xml.sax.SAXException;                                                   [2m                [0m
[2;36m                    [0m         @@ [1;36m-54[0m,[1;36m6[0m +[1;36m56[0m,[1;36m8[0m @@                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          class HtmlHandler extends TextContentHandler [1m{[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         +    private static final Logger LOG = [1;35mLoggerFactory.getLogger[0m[1m([0mHtmlHandler.class[1m)[0m;  [2m                [0m
[2;36m                    [0m         +                                                                                   [2m                [0m
[2;36m                    [0m              [35m/[0m[35m/[0m List of attributes that need to be resolved.                                [2m                [0m
[2;36m                    [0m              private static final Set[1m<[0m[1;95mString[0m[39m> URI_ATTRIBUTES =[0m                              [2m                [0m
[2;36m                    [0m         [39m             new HashSet<>[0m[1;39m([0m[1;35mArrays.asList[0m[1;39m([0m[32m"src"[0m[39m, [0m[32m"href"[0m[39m, [0m[32m"longdesc"[0m[39m, [0m[32m"cite"[0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-62[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m66[0m[39m,[0m[1;36m9[0m[39m @@[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     private static final Map<String, Property> META_[0m[1;33mHEAD[0m[39mER_MAPPINGS = new [0m         [2m                [0m
[2;36m                    [0m         [39mHashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m     private static final MediaType JPEG = [0m[1;35mMediaType.image[0m[1;39m([0m[32m"jpeg"[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [39m+    private static final Set<String> DANGEROUS_METADATA_KEYS = new [0m                [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mArrays.asList[0m[1;39m([0m                                                            [2m                [0m
[2;36m                    [0m         [39m+        [0m[32m"exiftool_path"[0m[39m, [0m[32m"command"[0m[39m, [0m[32m"parser_command"[0m[39m, [0m[32m"external_command"[0m[39m, [0m[32m"exec"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [32m"shell"[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     static [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"author"[0m[39m, TikaCoreProperties.CREATOR[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"title"[0m[39m, TikaCoreProperties.TITLE[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-195[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m202[0m[39m,[0m[1;36m12[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m             return;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Security: Reject metadata keys that could influence parser [0m             [2m                [0m
[2;36m                    [0m         [39mconfiguration[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35misDangerousMetadataKey[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Rejected potentially dangerous HTML metadata key: [0m[32m{[0m[32m}[0m[32m"[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [39mname[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+            return;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[32m"ICBM"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m             Matcher m = [0m[1;35mICBM.matcher[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[1;35mm.matches[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-233[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m246[0m[39m,[0m[1;36m18[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + name, value[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+    private boolean [0m[1;35misDangerousMetadataKey[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [39m+        String lcName = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.US[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Check exact matches[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[1;35mDANGEROUS_METADATA_KEYS.contains[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [39m+            return true;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Check for patterns that suggest command configuration[0m                   [2m                [0m
[2;36m                    [0m         [39m+        return [0m[1;35mlcName.contains[0m[1;39m([0m[32m"command"[0m[1;39m)[0m[39m || [0m                                      [2m                [0m
[2;36m                    [0m         [39m+               [0m[1;35mlcName.contains[0m[1;39m([0m[32m"exec"[0m[1;39m)[0m[39m || [0m                                         [2m                [0m
[2;36m                    [0m         [39m+               [0m[1;39m([0m[1;35mlcName.contains[0m[1;39m([0m[32m"path"[0m[1;39m)[0m[39m && [0m[1;39m([0m[1;35mlcName.contains[0m[1;39m([0m[32m"tool"[0m[1;39m)[0m[39m || [0m            [2m                [0m
[2;36m                    [0m         [1;35mlcName.contains[0m[1;39m([0m[32m"parser"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     private void [0m[1;35mstartElementWithSafeAttributes[0m[1;39m([0m[39mString name, Attributes atts[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mthrows SAXException [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-359[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m384[0m[39m,[0m[1;36m6[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[95mswallow[0m                                                              [2m                [0m
[2;36m                    [0m         [39m             return;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-        int added = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m-        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [39m-            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                                  [2m                [0m
[2;36m                    [0m         [39m         Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                           [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-377[0m[39m,[0m[1;36m97[0m[39m +[0m[1;36m398[0m[39m,[0m[1;36m8[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, true[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, metadata[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [39m-                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-    private int [0m[1;35mconfigureExifTool[0m[1;39m([0m[39mString path[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [39m-        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m-        int retVal = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m-        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m-            CompositeExternalParser exParser =[0m                                     [2m                [0m
[2;36m                    [0m         [39m-                    [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [39m-                            context[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m-            if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-                [0m[35m/[0m[35m/[0m[95mlasciate[0m[39m ogne speranza[0m                                           [2m                [0m
[2;36m                    [0m         [39m-                return [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-            exifToolParser = new [0m[1;35mExternalParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m-            retVal = [0m[1;36m1[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m-            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;35mparsers.put[0m[1;39m([0m[39mJPEG, exifToolParser[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-        Set<MediaType> supported = new [0m                                            [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35msupported.add[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[39mpath, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39msupported[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m-        return retVal;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-    private void [0m[1;35mresetExifTool[0m[1;39m([0m[39mint added[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [39m-        if [0m[1;39m([0m[39madded == [0m[1;36m2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [39m-            return;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-        CompositeExternalParser exParser =[0m                                         [2m                [0m
[2;36m                    [0m         [39m-                [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [39m-                        context[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m-        if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [39m-            return;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-        if [0m[1;39m([0m[39madded == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [39m-            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;35mparsers.remove[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m-            return;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m-        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m-            return;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-        Set<MediaType> supported = new [0m                                            [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m-        Set<MediaType> newSupported = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m-        for [0m[1;39m([0m[39mMediaType m : supported[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [39m-            if [0m[1;39m([0m[39m![0m[1;35mm.getSubtype[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"jpeg"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [39m-                [0m[1;35mnewSupported.add[0m[1;39m([0m[39mm[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[32m"exiftool"[0m[39m, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39mnewSupported[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmetadata.remove[0m[1;39m([0m[32m"exiftool_path"[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m-        Map<MediaType, Parser> updated = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m-        for [0m[1;39m([0m[39mMap.Entry<MediaType, Parser> e : [0m[1;35mexParser.getParsers[0m[1;39m([0m[1;39m)[0m[1;35m.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [39m-            if [0m[1;39m([0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m instanceof ExternalParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [39m-                ExternalParser p = [0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m [0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m-                if [0m[1;39m([0m[1;35mExternalParser.check[0m[1;39m([0m[1;35mp.getCommand[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [39m-                    for [0m[1;39m([0m[39mMediaType mediaType : [0m[1;35mp.getSupportedTypes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [39m-                        [0m[1;35mupdated.put[0m[1;39m([0m[39mmediaType, p[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m-                    [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [39m-                [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-    private ExternalParser [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [39m-        CompositeExternalParser exParser =[0m                                         [2m                [0m
[2;36m                    [0m         [39m-                [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [39m-                        context[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m-        if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [39m-            return null;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-        for [0m[1;39m([0m[39mParser p : [0m[1;35mexParser.getAllComponentParsers[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [39m-            if [0m[1;39m([0m[39mp instanceof ExternalParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [39m-                String[0m[1;39m[[0m[1;39m][0m[39m args = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m p[0m[1;39m)[0m[1;35m.getCommand[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m-                for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < args.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [39m-                    if [0m[1;39m([0m[39margs[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[32m"exiftool"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [39m-                        return [0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m p;[0m                                 [2m                [0m
[2;36m                    [0m         [39m-                    [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [39m-                [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-        return null;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.jav[0m[1;92ma:63[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:594[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:453[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:314[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:274[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1;39m([0m[39mParserDecorator.jav[0m[1;92ma:153[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1;39m([0m[39mDelegatingParser.jav[0m[1;92ma:71[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mParsingEmb[0m [2m                [0m
[2;36m                    [0m         [39meddedDocumentExtractor.jav[0m[1;92ma:101[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:377[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1;39m([0m[39mContentHandlerDecorator.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:125[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1;39m([0m[39mXHTMLDowngradeHandle[0m [2m                [0m
[2;36m                    [0m         [39mr.jav[0m[1;92ma:59[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.html.JSoupParser$[0m[1;35mTikaNodeFilter.head[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:211[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.jsoup.select.NodeTraversor.filter[0m[1;39m([0m[39mNodeTraversor.jav[0m[1;92ma:92[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:137[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:69[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 3c99eeb1380e104c[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue reports an OS Command Injection vulnerability [0m                    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mcom.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical[0m[1;39m)[0m[39m detected during [0m     [2m                [0m
[2;36m                    [0m         [39mfuzzing of Apache Tika's HTML parser. The vulnerability occurs when [0m                [2m                [0m
[2;36m                    [0m         [39mattacker-controlled data from HTML metadata is used to configure external parser [0m   [2m                [0m
[2;36m                    [0m         [39mcommands, potentially leading to remote code execution. The patch attempt aimed to [0m [2m                [0m
[2;36m                    [0m         [39mprevent metadata keys from influencing parser configuration and improve command [0m    [2m                [0m
[2;36m                    [0m         [39mexecution security, but resulted in a compilation error due to a missing LOG [0m       [2m                [0m
[2;36m                    [0m         [39mvariable reference in the HtmlHandler class.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fuzzing process detected a critical security issue where OS commands are [0m       [2m                [0m
[2;36m                    [0m         [39mexecuted with attacker-controlled data. The stack trace reveals the following [0m      [2m                [0m
[2;36m                    [0m         [39mexecution path:[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The fuzzer invokes [0m[1;35mHtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m which calls [0m[1;35mparseOne[0m[1;39m([0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. [0m[1;35mAutoDetectParser.parse[0m[1;39m([0m[1;39m)[0m[39m processes the input through JSoupParser[0m                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. [0m[1;35mHtmlHandler.startElement[0m[1;39m([0m[1;39m)[0m[39m processes HTML elements and calls [0m                    [2m                [0m
[2;36m                    [0m         [1;35mhandleDataURIScheme[0m[1;39m([0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. [0m[1;35mParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[1;39m)[0m[39m is invoked[0m                      [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Eventually, [0m[1;35mExternalParser.parse[0m[1;39m([0m[1;39m)[0m[39m executes [0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m at line [0m[1;36m314[0m           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. The command injection hook triggers at [0m[1;35mProcessBuilder.start[0m[1;39m([0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is flagged at the OsCommandInjection sanitizer level, indicating [0m [2m                [0m
[2;36m                    [0m         [39mthat untrusted input data is reaching command execution points. The key observation[0m [2m                [0m
[2;36m                    [0m         [39mis that the HTML handler processes data URIs and metadata, which can contain [0m       [2m                [0m
[2;36m                    [0m         [39membedded documents that trigger external parser invocation.[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch modifies two files:[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**HtmlHandler.java modifications:**[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Added dangerous metadata key filtering:**[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Introduces a static Set called DANGEROUS_METADATA_KEYS containing: [0m            [2m                [0m
[2;36m                    [0m         [32m"exiftool_path"[0m[39m, [0m[32m"command"[0m[39m, [0m[32m"parser_command"[0m[39m, [0m[32m"external_command"[0m[39m, [0m[32m"exec"[0m[39m, [0m[32m"shell"[0m   [2m                [0m
[2;36m                    [0m         [39m   - Implements [0m[1;35misDangerousMetadataKey[0m[1;39m([0m[1;39m)[0m[39m method that checks if metadata keys:[0m       [2m                [0m
[2;36m                    [0m         [39m     - Match entries in DANGEROUS_METADATA_KEYS [0m[1;39m([0m[39mcase-insensitive[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m     - Contain [0m[32m"command"[0m[39m or [0m[32m"exec"[0m[39m substrings[0m                                       [2m                [0m
[2;36m                    [0m         [39m     - Contain both [0m[32m"path"[0m[39m and either [0m[32m"tool"[0m[39m or [0m[32m"parser"[0m[39m substrings[0m                 [2m                [0m
[2;36m                    [0m         [39m   - Adds validation at line [0m[1;36m203[0m[39m to reject dangerous metadata keys before [0m          [2m                [0m
[2;36m                    [0m         [39mprocessing[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Removed exiftool configuration code:**[0m                                         [2m                [0m
[2;36m                    [0m         [39m   - Deleted lines that checked for [0m[32m"html_meta:exiftool_path"[0m[39m metadata[0m              [2m                [0m
[2;36m                    [0m         [39m   - Removed calls to [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;39m)[0m[39m and [0m[1;35mresetExifTool[0m[1;39m([0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m   - Eliminated the ability to dynamically configure external tools via metadata[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**ExternalParser.java modifications:**[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Changed command checking process:**[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Modified [0m[1;35mcheck[0m[1;39m([0m[1;39m)[0m[39m method to use ProcessBuilder instead of [0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m for [0m   [2m                [0m
[2;36m                    [0m         [39mthe check command[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Enhanced command execution security:**[0m                                         [2m                [0m
[2;36m                    [0m         [39m   - Removed logic that splits single-string commands by spaces [0m[1;39m([0m[39mcommand.length == [0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m branch[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - Forces all commands to use the array form of [0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [39m   - Added security warning in JavaDoc for [0m[1;35msetCommand[0m[1;39m([0m[1;39m)[0m[39m method[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Command processing simplification:**[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Ensures commands are always treated as pre-tokenized arrays[0m                    [2m                [0m
[2;36m                    [0m         [39m   - Prevents shell interpretation of command strings[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Compilation Error[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch resulted in a compilation failure in HtmlHandler.java at line [0m[1;36m203[0m[39m:[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mcannot find symbol[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m  symbol:   variable LOG[0m                                                            [2m                [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.html.HtmlHandler[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch introduces a [0m[1;35mLOG.warn[0m[1;39m([0m[1;39m)[0m[39m statement to log rejected metadata keys, but the [0m [2m                [0m
[2;36m                    [0m         [39mLOG variable [0m[1;39m([0m[39mtypically a logger instance[0m[1;39m)[0m[39m is not defined or imported in the [0m       [2m                [0m
[2;36m                    [0m         [39mHtmlHandler class. The original code does not show any logger initialization, [0m      [2m                [0m
[2;36m                    [0m         [39mindicating this was an oversight in the patch.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Further Investigation[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Logger Implementation in HtmlHandler:** Examine the complete HtmlHandler class[0m [2m                [0m
[2;36m                    [0m         [39mto determine if a logger is already present but not visible in the patch context, [0m  [2m                [0m
[2;36m                    [0m         [39mor if one needs to be added [0m[1;39m([0m[39me.g., using SLF4J or java.util.logging[0m[1;39m)[0m[39m.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Metadata Processing Flow:** Investigate the complete metadata handling [0m        [2m                [0m
[2;36m                    [0m         [39mpipeline to understand:[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - Where metadata originates [0m[1;39m([0m[39mHTML meta tags, embedded documents, data URIs[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m   - How metadata keys and values flow through different parser components[0m          [2m                [0m
[2;36m                    [0m         [39m   - Whether other parsers besides HTML can inject dangerous metadata[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **ExternalParser Configuration:** Review how ExternalParser instances are [0m       [2m                [0m
[2;36m                    [0m         [39mconfigured:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   - Where [0m[1;35msetCommand[0m[1;39m([0m[1;39m)[0m[39m is called and by what components[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Whether configuration can come from document content or only from static [0m      [2m                [0m
[2;36m                    [0m         [39mconfiguration[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   - What other parsers use ExternalParser and might be affected[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Removed ExifTool Functionality:** Understand the purpose of the removed [0m       [2m                [0m
[2;36m                    [0m         [1;35mconfigureExifTool[0m[1;39m([0m[1;39m)[0m[39m and [0m[1;35mresetExifTool[0m[1;39m([0m[1;39m)[0m[39m methods:[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - What functionality is lost by removing this code[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Whether this was a legitimate feature being exploited or an unintended [0m        [2m                [0m
[2;36m                    [0m         [39mvulnerability[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   - Impact on users who may rely on this functionality[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Command Tokenization Logic:** Verify the implications of removing command [0m     [2m                [0m
[2;36m                    [0m         [39mstring splitting:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - Whether legitimate use cases exist where commands are provided as single [0m      [2m                [0m
[2;36m                    [0m         [39mstrings[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - If configuration files or APIs need updates to provide pre-tokenized commands[0m  [2m                [0m
[2;36m                    [0m         [39m   - Backward compatibility concerns for existing Tika deployments[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Data URI Handling:** The stack trace shows [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[1;39m)[0m[39m in the call [0m  [2m                [0m
[2;36m                    [0m         [39mpath, suggesting investigation of:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - How data URIs are parsed and what content types they can contain[0m               [2m                [0m
[2;36m                    [0m         [39m   - Whether data URIs can carry metadata that influences parser behavior[0m           [2m                [0m
[2;36m                    [0m         [39m   - Security boundaries between embedded document extraction and main document [0m    [2m                [0m
[2;36m                    [0m         [39mparsing[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.jav[0m[1;92ma:63[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:594[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:453[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:314[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:274[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1;39m([0m[39mParserDecorator.jav[0m[1;92ma:153[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1;39m([0m[39mDelegatingParser.jav[0m[1;92ma:71[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mParsingEmb[0m [2m                [0m
[2;36m                    [0m         [39meddedDocumentExtractor.jav[0m[1;92ma:101[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:377[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1;39m([0m[39mContentHandlerDecorator.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:125[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1;39m([0m[39mXHTMLDowngradeHandle[0m [2m                [0m
[2;36m                    [0m         [39mr.jav[0m[1;92ma:59[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.html.JSoupParser$[0m[1;35mTikaNodeFilter.head[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:211[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.jsoup.select.NodeTraversor.filter[0m[1;39m([0m[39mNodeTraversor.jav[0m[1;92ma:92[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:137[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:69[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 3c99eeb1380e104c[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m COMPILATION ERROR : [0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-m[0m [2m                [0m
[2;36m                    [0m         [35modules/tika-parser-html-module/src/main/java/org/apache/tika/parser/html/[0m[95mHtmlHandle[0m [2m                [0m
[2;36m                    [0m         [95mr.java[0m[39m:[0m[1;39m[[0m[1;36m203[0m[39m,[0m[1;36m13[0m[1;39m][0m[39m cannot find symbol[0m                                                  [2m                [0m
[2;36m                    [0m         [39m  symbol:   variable LOG[0m                                                            [2m                [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.html.HtmlHandler[0m                           [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m1[0m[39m error[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Summary for Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT:[0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m [0m[1;36m11.643[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m9.606[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.755[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.038[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package [0m[33m...[0m[39m. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.114[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.019[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.736[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.503[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.621[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m  [0m[1;36m0.541[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m FAILURE [0m[1;39m[[0m[39m  [0m[1;36m0.195[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module SKIPPED[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD FAILURE[0m                                                                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m33.503[0m[39m s[0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-06T[0m[1;92m18:31:12[0m[39mZ[0m                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Failed to execute goal [0m                                                     [2m                [0m
[2;36m                    [0m         [39morg.apache.maven.plugins:maven-compiler-plugin:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m on [0m [2m                [0m
[2;36m                    [0m         [39mproject tika-parser-html-module: Compilation failure[0m                                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-m[0m [2m                [0m
[2;36m                    [0m         [35modules/tika-parser-html-module/src/main/java/org/apache/tika/parser/html/[0m[95mHtmlHandle[0m [2m                [0m
[2;36m                    [0m         [95mr.java[0m[39m:[0m[1;39m[[0m[1;36m203[0m[39m,[0m[1;36m13[0m[1;39m][0m[39m cannot find symbol[0m                                                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   variable LOG[0m                                                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.html.HtmlHandler[0m                   [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m -> [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m                                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m To see the full stack trace of the errors, re-run Maven with the -e switch.[0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Re-run Maven using the -X switch to enable full debug logging.[0m              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m For more information about the errors[0m                                       [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:19[0m[39m-[0m[1;36m53[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.net.MalformedURLException;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.xml.sax.Attributes;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.xml.sax.helpers.AttributesImpl;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.metadata.HTML;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.metadata.Office;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.parser.external.CompositeExternalParser;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.parser.external.ExternalParser;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.sax.TextContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:55[0m[39m-[0m[1;36m100[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m55:c[0m[39mlass HtmlHandler extends TextContentHandler [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[35m/[0m[35m/[0m[39m List of attributes that need to be resolved.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    private static final Set<String> URI_ATTRIBUTES =[0m                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            new HashSet<>[0m[1;39m([0m[1;35mArrays.asList[0m[1;39m([0m[32m"src"[0m[39m, [0m[32m"href"[0m[39m, [0m[32m"longdesc"[0m[39m, [0m[32m"cite"[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private static final Pattern ICBM =[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            [0m[1;35mPattern.compile[0m[1;39m([0m[32m"\\s*[0m[32m([0m[32m-?\\d+\\.\\d+[0m[32m)[0m[32m[[0m[32m,\\s[0m[32m][0m[32m+[0m[32m([0m[32m-?\\d+\\.\\d+[0m[32m)[0m[32m\\s*"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final Map<String, Property> META_[0m[1;33mHEAD[0m[39mER_MAPPINGS = new [0m       [2m                [0m
[2;36m                    [0m         [39mHashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    private static final MediaType JPEG = [0m[1;35mMediaType.image[0m[1;39m([0m[32m"jpeg"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    static [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"author"[0m[39m, TikaCoreProperties.CREATOR[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"title"[0m[39m, TikaCoreProperties.TITLE[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"subject"[0m[39m, TikaCoreProperties.SUBJECT[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"keywords"[0m[39m, Office.KEYWORDS[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"description"[0m[39m, TikaCoreProperties.DESCRIPTION[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    private static final Attributes EMPTY_ATTS = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private final HtmlMapper mapper;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    private final XHTMLContentHandler xhtml;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private final Metadata metadata;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private final ParseContext context;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private final boolean extractScripts;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private final StringBuilder title = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    private final DataURISchemeUtil dataURISchemeUtil = new [0m[1;35mDataURISchemeUtil[0m[1;39m([0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private final StringBuilder script = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private int bodyLevel = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    private int discardLevel = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    private int titleLevel = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    private int scriptLevel = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private Attributes scriptAtts = EMPTY_ATTS;[0m[35m/[0m[35m/[0m[95mattributes[0m[39m from outermost [0m      [2m                [0m
[2;36m                    [0m         [39mscript element[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    private boolean isTitleSetToMetadata = false;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    private [0m[1;35mHtmlHandler[0m[1;39m([0m[39mHtmlMapper mapper, XHTMLContentHandler xhtml, Metadata [0m  [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                        ParseContext context, boolean extractScripts[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mxhtml[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        this.mapper = mapper;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        this.xhtml = xhtml;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        this.metadata = metadata;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        this.context = context;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        this.extractScripts = extractScripts;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[35m/[0m[35m/[0m[39m Try to determine the default base URL, if one has not been given[0m      [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[39mMetadata.CONTENT_LOCATION[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                name = [0m[1;35mname.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:190[0m[39m-[0m[1;36m236[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    private void [0m[1;35maddHtmlMetadata[0m[1;39m([0m[39mString name, String value[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        [0m[35m/[0m[35m/[0m[95mnote[0m[39m that [0m[32m"name"[0m[39m derives from attributes and is not uppercased[0m        [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[35m/[0m[35m/[0m[95mlike[0m[39m the elements by the XHTMLDowngradeHandler[0m                        [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || [0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[32m"ICBM"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            Matcher m = [0m[1;35mICBM.matcher[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            if [0m[1;39m([0m[1;35mm.matches[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[32m"ICBM"[0m[39m, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m + [0m[32m", "[0m[39m + [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.LATITUDE, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.LONGITUDE, [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[32m"ICBM"[0m[39m, value[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[39mMetadata.CONTENT_TYPE[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[35m/[0m[35m/[0m[95mdon[0m[39m't overwrite Metadata.CONTENT_TYPE![0m                            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            MediaType type = [0m[1;35mMediaType.parse[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_HINT, [0m             [2m                [0m
[2;36m                    [0m         [1;35mtype.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_HINT, value[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        String lcName = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.US[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        if [0m[1;39m([0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.containsKey[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            Property property = [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.get[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            if [0m[1;39m([0m[1;35mproperty.equals[0m[1;39m([0m[39mTikaCoreProperties.TITLE[0m[1;39m)[0m[39m && [0m                   [2m                [0m
[2;36m                    [0m         [39misTitleSetToMetadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                [0m[35m/[0m[35m/[0m[95mprefer[0m[39m the title element if it is already set[0m                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                [0m[35m/[0m[35m/[0m[95mdo[0m[39m nothing[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + [0m                           [2m                [0m
[2;36m                    [0m         [1;35mTikaCoreProperties.TITLE.getName[0m[1;39m([0m[1;39m)[0m[39m, value[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mproperty.isMultiValuePermitted[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + name, value[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/metadata/HTML.jav[0m[1;92ma:1[0m[39m-[0m[1;36m29[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:package org.apache.tika.metadata; [0m[35m/[0m[39m*[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: * [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:public interface HTML [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:    String PREFIX_HTML_META = [0m[32m"html_meta"[0m[39m + [0m                                     [2m                [0m
[2;36m                    [0m         [39mTikaCoreProperties.NAMESPACE_PREFIX_DELIMITER;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:     * If a script element contains a src value, this value[0m                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:     * is set in the embedded document's metadata[0m                                [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:    Property SCRIPT_SOURCE = [0m[1;35mProperty.internalText[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:            PREFIX_HTML_META + [0m[32m"scriptSrc"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m61[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.external;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedReader;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.FileInputStream;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.InputStreamReader;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.Reader;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.concurrent.TimeoutException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.io.output.NullOutputStream;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.io.TemporaryResources;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m: * Parser that uses an external program [0m[1;39m([0m[39mlike catdoc or pdf2txt[0m[1;39m)[0m[39m to extract[0m      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m: * text content and metadata from a given document.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:public class ExternalParser implements Parser [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final Logger LOG = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mExternalParser.class[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:68[0m[39m-[0m[1;36m94[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    public static final String IN[0m[1;33mPUT[0m[39m_FILE_TOKEN = [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * The token, which if present in the Command string, will[0m                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * be replaced with the output filename.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * Alternately, the output data can be collected on STDOUT.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public static final String OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN = [0m[32m"$[0m[32m{[0m[32mOUT[0m[1;33mPUT[0m[32m}[0m[32m"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private static final long serialVersionUID = -1079128990650687037L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[35m/[0m[35m/[0m[95mmake[0m[39m this parameterizable[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private final long timeoutMs = [0m[1;36m60000[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * Media types supported by the external program.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private Set<MediaType> supportedTypes = [0m[1;35mCollections.emptySet[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     * Regular Expressions to run over STDOUT to[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * extract Metadata.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    private Map<Pattern, String> metadataPatterns = null;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * The external command to invoke.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    private String[0m[1;39m[[0m[1;39m][0m[39m command = new String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[32m"cat"[0m[1;39m}[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:215[0m[39m-[0m[1;36m228[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    public String[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetCommand[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        return command;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:     * Sets the command to be run. This can include either of[0m                   [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:     * [0m[1;39m{[0m[39m@link #IN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m[39m or [0m[1;39m{[0m[39m@link #OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m                  [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:     * if the command needs filenames.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:     * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    public void [0m[1;35msetCommand[0m[1;39m([0m[39mString[0m[33m...[0m[39m command[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        this.command = command;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:280[0m[39m-[0m[1;36m318[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    private void [0m[1;35mparse[0m[1;39m([0m[39mTikaInputStream stream, XHTMLContentHandler xhtml, [0m      [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                       TemporaryResources tmp[0m[1;39m)[0m[39m throws IOException, [0m             [2m                [0m
[2;36m                    [0m         [39mSAXException, TikaException [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        boolean inputToStdIn = true;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        boolean outputFromStdOut = true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        boolean hasPatterns = [0m[1;39m([0m[39mmetadataPatterns != null && [0m                     [2m                [0m
[2;36m                    [0m         [39m![0m[1;35mmetadataPatterns.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:        File output = null;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build our command[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                inputToStdIn = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                output = [0m[1;35mtmp.createTemporaryFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                outputFromStdOut = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m[1;35moutput.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:354[0m[39m-[0m[1;36m408[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    private void [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        DataURIScheme dataURIScheme = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            dataURIScheme = [0m[1;35mdataURISchemeUtil.parse[0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mDataURISchemeParseException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    private int [0m[1;35mconfigureExifTool[0m[1;39m([0m[39mString path[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:        int retVal = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:            CompositeExternalParser exParser =[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:                    [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:                            context[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:            if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:                [0m[35m/[0m[35m/[0m[95mlasciate[0m[39m ogne speranza[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:                return [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:            exifToolParser = new [0m[1;35mExternalParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:            retVal = [0m[1;36m1[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:            [0m[1;35mparsers.put[0m[1;39m([0m[39mJPEG, exifToolParser[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:            [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:        Set<MediaType> supported = new [0m                                         [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:        [0m[1;35msupported.add[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[39mpath, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39msupported[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:        return retVal;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/CompositeExternalParser.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:19[0m[39m-[0m[1;36m44[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.tika.mime.MediaTypeRegistry;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.tika.parser.CompositeParser;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m: * A Composite Parser that wraps up all the available External Parsers,[0m          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: * and provides an easy way to access them.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * Parser that uses an external program [0m[1;39m([0m[39mlike catdoc or pdf2txt[0m[1;39m)[0m[39m to extract[0m      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: * text content and metadata from a given document.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:public class CompositeExternalParser extends CompositeParser [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private static final long serialVersionUID = 6962436916649024024L;[0m           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    public [0m[1;35mCompositeExternalParser[0m[1;39m([0m[1;39m)[0m[39m throws IOException, TikaException [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public [0m[1;35mCompositeExternalParser[0m[1;39m([0m[39mMediaTypeRegistry registry[0m[1;39m)[0m[39m throws [0m           [2m                [0m
[2;36m                    [0m         [39mIOException, TikaException [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mregistry, [0m[1;39m([0m[39mList<Parser>[0m[1;39m)[0m[39m [0m[1;39m([0m[39mList<? extends Parser>[0m[1;39m)[0m[39m [0m                 [2m                [0m
[2;36m                    [0m         [1;35mExternalParsersFactory.create[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/EmbeddedDocumentUtil.jav[0m[1;92ma:239[0m[39m-[0m[1;36m261[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    public static Parser [0m[1;35mtryToFindExistingLeafParser[0m[1;39m([0m[39mClass clazz, ParseContext [0m [2m                [0m
[2;36m                    [0m         [39mcontext[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:        Parser p = [0m[1;35mcontext.get[0m[1;39m([0m[39mParser.class[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:        if [0m[1;39m([0m[1;35mequals[0m[1;39m([0m[39mp, clazz[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:            return p;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:        Parser returnParser = null;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:        if [0m[1;39m([0m[39mp != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:            if [0m[1;39m([0m[39mp instanceof ParserDecorator[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:                p = [0m[1;35mfindInDecorated[0m[1;39m([0m[1;39m([0m[39mParserDecorator[0m[1;39m)[0m[39m p, clazz[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:            if [0m[1;39m([0m[1;35mequals[0m[1;39m([0m[39mp, clazz[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:                return p;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:            if [0m[1;39m([0m[39mp instanceof CompositeParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:                returnParser = [0m[1;35mfindInComposite[0m[1;39m([0m[1;39m([0m[39mCompositeParser[0m[1;39m)[0m[39m p, clazz, [0m     [2m                [0m
[2;36m                    [0m         [39mcontext[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:        if [0m[1;39m([0m[39mreturnParser != null && [0m[1;35mequals[0m[1;39m([0m[39mreturnParser, clazz[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:            return returnParser;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:116[0m[39m-[0m[1;36m184[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    public void [0m[1;35mstartElement[0m[1;39m([0m[39mString uri, String local, String name, Attributes [0m [2m                [0m
[2;36m                    [0m         [39matts[0m[1;39m)[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            throws SAXException [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        if [0m[1;39m([0m[32m"HTML"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m && [0m[1;35matts.getValue[0m[1;39m([0m[32m"lang"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_LANGUAGE, [0m[1;35matts.getValue[0m[1;39m([0m[32m"lang"[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        if [0m[1;39m([0m[32m"SCRIPT"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            scriptLevel++;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        if [0m[1;39m([0m[32m"TITLE"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || titleLevel > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            titleLevel++;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        if [0m[1;39m([0m[32m"BODY"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || [0m[1;39m([0m[32m"FRAMESET"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m || bodyLevel > [0m[1;36m0[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            bodyLevel++;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        if [0m[1;39m([0m[1;35mmapper.isDiscardElement[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || discardLevel > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            discardLevel++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        if [0m[1;39m([0m[39mbodyLevel == [0m[1;36m0[0m[39m && discardLevel == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            if [0m[1;39m([0m[32m"META"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m && [0m[1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                [0m[35m/[0m[35m/[0m[39m TIKA-[0m[1;36m478[0m[39m: For cases where we have either a name or[0m           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                [0m[35m/[0m[35m/[0m[39m [0m[32m"http-equiv"[0m[39m, assume that XHTMLContentHandler will emit[0m      [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                [0m[35m/[0m[35m/[0m[39m these in the <head>, thus passing them through safely.[0m       [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                if [0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"http-equiv"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:                    [0m[1;35maddHtmlMetadata[0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"http-equiv"[0m[1;39m)[0m[39m, [0m               [2m                [0m
[2;36m                    [0m         [1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"name"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                    [0m[35m/[0m[35m/[0m[39m Record the meta tag in the metadata[0m                      [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:                    [0m[1;35maddHtmlMetadata[0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"name"[0m[1;39m)[0m[39m, [0m                     [2m                [0m
[2;36m                    [0m         [1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"property"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                    [0m[35m/[0m[35m/[0m[39m TIKA-[0m[1;36m983[0m[39m: Handle <meta [0m[33mproperty[0m[39m=[0m[32m"og[0m[32m:xxx"[0m[39m [0m[33mcontent[0m[39m=[0m[32m"yyy"[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [35m/[0m[39m> tags[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:                    [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + [0m                       [2m                [0m
[2;36m                    [0m         [1;35matts.getValue[0m[1;39m([0m[32m"property"[0m[1;39m)[0m[39m, [0m[1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[32m"BASE"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m && [0m[1;35matts.getValue[0m[1;39m([0m[32m"href"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:                [0m[1;35mstartElementWithSafeAttributes[0m[1;39m([0m[32m"base"[0m[39m, atts[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:                [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"base"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_LOCATION, [0m                        [2m                [0m
[2;36m                    [0m         [1;35mresolve[0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"href"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[32m"LINK"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                [0m[1;35mstartElementWithSafeAttributes[0m[1;39m([0m[32m"link"[0m[39m, atts[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"link"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[32m"SCRIPT"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:                scriptAtts = atts;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        if [0m[1;39m([0m[39mbodyLevel > [0m[1;36m0[0m[39m && discardLevel == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            String safe = [0m[1;35mmapper.mapSafeElement[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            if [0m[1;39m([0m[39msafe != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                [0m[1;35mstartElementWithSafeAttributes[0m[1;39m([0m[39msafe, atts[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        [0m[1;35mtitle.setLength[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        String value = [0m[1;35matts.getValue[0m[1;39m([0m[32m"src"[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:        if [0m[1;39m([0m[39mvalue != null && [0m[1;35mvalue.startsWith[0m[1;39m([0m[32m"data:"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[35m/[0m[35m/[0m[95mdon[0m[39m't extract data if we're in a script[0m                           [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            [0m[35m/[0m[35m/[0m[95mand[0m[39m the user doesn't want to extract scripts[0m                      [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            if [0m[1;39m([0m[39mscriptLevel == [0m[1;36m0[0m[39m || extractScripts[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        if [0m[1;39m([0m[32m"IFRAME"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:            String srcDoc = [0m[1;35matts.getValue[0m[1;39m([0m[32m"srcdoc"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39msrcDoc[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:                [0m[1;35mhandleSrcDoc[0m[1;39m([0m[39msrcDoc[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:80[0m[39m-[0m[1;36m120[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public void [0m[1;35mparseEmbedded[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            TikaInputStream tis, ContentHandler handler, Metadata metadata, [0m     [2m                [0m
[2;36m                    [0m         [39mboolean outputHtml[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            throws SAXException, IOException [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            AttributesImpl attributes = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            [0m[1;35mattributes.addAttribute[0m[1;39m([0m[32m""[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"CDATA"[0m[39m, [0m              [2m                [0m
[2;36m                    [0m         [32m"package-entry"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            [0m[1;35mhandler.startElement[0m[1;39m([0m[39mXHTML, [0m[32m"div"[0m[39m, [0m[32m"div"[0m[39m, attributes[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        if [0m[1;39m([0m[39mwriteFileNameToContent && name != null && [0m[1;35mname.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[39m && [0m      [2m                [0m
[2;36m                    [0m         [39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            [0m[1;35mhandler.startElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[39m, new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            char[0m[1;39m[[0m[1;39m][0m[39m chars = [0m[1;35mname.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            [0m[1;35mhandler.characters[0m[1;39m([0m[39mchars, [0m[1;36m0[0m[39m, chars.length[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[35m/[0m[35m/[0m[39m Use the delegate parser to parse this entry[0m                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            [0m[1;35mtis.setCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            [0m[1;35mDELEGATING_PARSER.parse[0m[1;39m([0m[39mtis, new [0m[1;35mEmbeddedContentHandler[0m[1;39m([0m[39mnew [0m        [2m                [0m
[2;36m                    [0m         [1;35mBodyContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[1;39m)[0m[39m,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                    metadata, context[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mEncryptedDocumentException ede[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[1;35mrecordException[0m[1;39m([0m[39mede, context[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mCorruptedFileException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[35m/[0m[35m/[0m[95mnecessary[0m[39m to stop the parse to avoid infinite loops[0m               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            [0m[35m/[0m[35m/[0m[95mon[0m[39m corrupt sqlite3 files[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            [0m[1;35mrecordException[0m[1;39m([0m[39me, context[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[1;35mtis.removeCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"div"[0m[39m, [0m[32m"div"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    void [0m[1;35mrecordException[0m[1;39m([0m[39mException e, ParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/DelegatingParser.jav[0m[1;92ma:59[0m[39m-[0m[1;36m72[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Looks up the delegate parser from the parsing context and[0m                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * delegates the parse operation to it. If a delegate parser is not[0m          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * found, then an empty XHTML document is returned.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * Subclasses should override this method to parse the top level[0m             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * structure of the given document stream. Parsed sub-streams can[0m            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * be passed to this base class method to be parsed by the configured[0m        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * delegate parser.[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws SAXException, IOException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35mgetDelegateParser[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;35m.parse[0m[1;39m([0m[39mstream, handler, metadata, context[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:280[0m[39m-[0m[1;36m310[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        Parser parser = [0m[1;35mgetParser[0m[1;39m([0m[39mmetadata, context[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        TemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        ParseRecord parserRecord = [0m[1;35mcontext.get[0m[1;39m([0m[39mParseRecord.class[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:        if [0m[1;39m([0m[39mparserRecord == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:            parserRecord = new [0m[1;35mParseRecord[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:            [0m[1;35mcontext.set[0m[1;39m([0m[39mParseRecord.class, parserRecord[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:            TikaInputStream taggedStream = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mstream, tmp, [0m    [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            TaggedContentHandler taggedHandler =[0m                                [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:                    handler != null ? new [0m[1;35mTaggedContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[39m : null;[0m [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            String parserClassname = [0m[1;35mParserUtils.getParserClassname[0m[1;39m([0m[39mparser[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mparserRecord.addParserClass[0m[1;39m([0m[39mparserClassname[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:            [0m[1;35mParserUtils.recordParserDetails[0m[1;39m([0m[39mparserClassname, metadata[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:            [0m[1;35mparserRecord.beforeParse[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                [0m[1;35mparser.parse[0m[1;39m([0m[39mtaggedStream, taggedHandler, metadata, context[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSecurityException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:                [0m[35m/[0m[35m/[0m[95mrethrow[0m[39m security exceptions[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:                throw e;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                [0m[1;35mtaggedStream.throwIfCauseOf[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"TIKA-198: Illegal IOException from "[0m[39m +[0m [2m                [0m
[2;36m                    [0m         [39mparser, e[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:                [0m[1;35mWriteLimitReachedException.throwIfWriteLimitReached[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:                if [0m[1;39m([0m[39mtaggedHandler != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:                    [0m[1;35mtaggedHandler.throwIfCauseOf[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"TIKA-237: Illegal SAXException from "[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m+ parser, e[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external2/ExternalParser.jav[0m[1;92ma:100[0m[39m-[0m[1;36m14[0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[35m/[0m[35m/[0m[95mthis[0m[39m may remain null, depending on whether the external parser writes[0m [2m                [0m
[2;36m                    [0m         [39mto a file[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        Path outFile = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        try [0m[1;39m([0m[39mTemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            TikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mstream, tmp, metadata[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            Path p = [0m[1;35mtis.getPath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            List<String> thisCommandLine = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            Matcher inputMatcher = [0m[1;35mIN[0m[1;33mPUT[0m[1;35m_TOKEN_MATCHER.matcher[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            Matcher outputMatcher = [0m[1;35mOUT[0m[1;33mPUT[0m[1;35m_TOKEN_MATCHER.matcher[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            boolean outputFileInCommandline = false;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            for [0m[1;39m([0m[39mString c : commandLine[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                if [0m[1;39m([0m[1;35minputMatcher.reset[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;35m.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                    String updated = [0m[1;35mc.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN,[0m                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                            [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[1;35mp.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35moutputMatcher.reset[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;35m.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:                    outFile = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[32m"tika-external2-"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                    String updated = [0m[1;35mc.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN,[0m               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:                            [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[1;35moutFile.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                    outputFileInCommandline = true;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            FileProcessResult result = null;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            long localTimeoutMillis = [0m[1;35mTikaTaskTimeout.getTimeoutMillis[0m[1;39m([0m[39mcontext,[0m [2m                [0m
[2;36m                    [0m         [39mtimeoutMs[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            if [0m[1;39m([0m[39moutputFileInCommandline[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mnew [0m                              [2m                [0m
[2;36m                    [0m         [1;35mProcessBuilder[0m[1;39m([0m[39mthisCommandLine[0m[1;39m)[0m[39m,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                        localTimeoutMillis, maxStdOut, maxStdErr[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                outFile = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[32m"tika-external2-"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mnew [0m                              [2m                [0m
[2;36m                    [0m         [1;35mProcessBuilder[0m[1;39m([0m[39mthisCommandLine[0m[1;39m)[0m[39m,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                        localTimeoutMillis, outFile, maxStdErr[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.IS_TIMEOUT, [0m[1;35mresult.isTimeout[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.EXIT_VALUE, [0m[1;35mresult.getExitValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_OUT_LENGTH, [0m                       [2m                [0m
[2;36m                    [0m         [1;35mresult.getStdoutLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_OUT_IS_TRUNCATED,[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/ProcessUtils.jav[0m[1;92ma:48[0m[39m-[0m[1;36m76[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * This should correctly put double-quotes around an argument if[0m             [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * ProcessBuilder doesn't seem to work [0m[1;39m([0m[39mas it doesn't[0m                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * on paths with spaces on Windows[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * @param arg[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * @return[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    public static String [0m[1;35mescapeCommandLine[0m[1;39m([0m[39mString arg[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        if [0m[1;39m([0m[39marg == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:            return arg;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        [0m[35m/[0m[35m/[0m[95mneed[0m[39m to test for [0m[32m" "[0m[39m on windows, can't just add double quotes[0m          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[35m/[0m[35m/[0m[95macross[0m[39m platforms.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        if [0m[1;39m([0m[1;35marg.contains[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m && SystemUtils.IS_OS_WINDOWS &&[0m                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:                [0m[1;39m([0m[39m![0m[1;35marg.startsWith[0m[1;39m([0m[32m"\""[0m[1;39m)[0m[39m && ![0m[1;35marg.endsWith[0m[1;39m([0m[32m"\""[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            arg = [0m[32m"\""[0m[39m + arg + [0m[32m"\""[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        return arg;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    public static String [0m[1;35munescapeCommandLine[0m[1;39m([0m[39mString arg[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        if [0m[1;39m([0m[1;35marg.contains[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m && SystemUtils.IS_OS_WINDOWS &&[0m                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                [0m[1;39m([0m[1;35marg.startsWith[0m[1;39m([0m[32m"\""[0m[1;39m)[0m[39m && [0m[1;35marg.endsWith[0m[1;39m([0m[32m"\""[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            arg = [0m[1;35marg.substring[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35marg.length[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        return arg;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:59[0m[39m-[0m[1;36m94[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:public class ExternalParser implements Parser [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final Logger LOG = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mExternalParser.class[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * The token, which if present in the Command string, will[0m                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * be replaced with the input filename.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * Alternately, the input data can be streamed over STDIN.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    public static final String IN[0m[1;33mPUT[0m[39m_FILE_TOKEN = [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * The token, which if present in the Command string, will[0m                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * be replaced with the output filename.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * Alternately, the output data can be collected on STDOUT.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public static final String OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN = [0m[32m"$[0m[32m{[0m[32mOUT[0m[1;33mPUT[0m[32m}[0m[32m"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private static final long serialVersionUID = -1079128990650687037L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[35m/[0m[35m/[0m[95mmake[0m[39m this parameterizable[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private final long timeoutMs = [0m[1;36m60000[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * Media types supported by the external program.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private Set<MediaType> supportedTypes = [0m[1;35mCollections.emptySet[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     * Regular Expressions to run over STDOUT to[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * extract Metadata.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    private Map<Pattern, String> metadataPatterns = null;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * The external command to invoke.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    private String[0m[1;39m[[0m[1;39m][0m[39m command = new String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[32m"cat"[0m[1;39m}[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-eval/tika-eval-app/src/main/java/org/apache/tika/eval/app/AbstractProfiler.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:85[0m[39m-[0m[1;36m95[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    protected static final AtomicInteger ID = new [0m[1;35mAtomicInteger[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    static final long NON_EXISTENT_FILE_LENGTH = -1l;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    final static int FILE_PATH_MAX_LEN = [0m[1;36m1024[0m[39m;[0m[35m/[0m[35m/[0m[95mmax[0m[39m len for varchar for [0m         [2m                [0m
[2;36m                    [0m         [39mfile_path[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[35m/[0m[95mContainer[0m[39m exception key from the [0m[1;36m1.[0m[39mx branch[0m                                [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    private static final Property CONTAINER_EXCEPTION_1X = [0m                      [2m                [0m
[2;36m                    [0m         [1;35mProperty.externalText[0m[1;39m([0m[32m"X-TIKA"[0m[39m + [0m[32m":EXCEPTION:runtime"[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    private static final Logger LOG = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mAbstractProfiler.class[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    private static final String[0m[1;39m[[0m[1;39m][0m[39m EXTRACT_EXTENSIONS = [0m[1;39m{[0m[32m".json"[0m[39m, [0m[32m".txt"[0m[39m, [0m[32m""[0m[1;39m}[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    private static final String[0m[1;39m[[0m[1;39m][0m[39m COMPRESSION_EXTENSIONS = [0m[1;39m{[0m[32m""[0m[39m, [0m[32m".bz2"[0m[39m, [0m[32m".gzip"[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [32m".zip"[0m[39m,[0m[1;39m}[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    private static final String ZERO = [0m[32m"0"[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    private static final String UNKNOWN_EXTENSION = [0m[32m"unk"[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[35m/[0m[35m/[0m[95mmake[0m[39m this configurable[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:410[0m[39m-[0m[1;36m451[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:    private void [0m[1;35mresetExifTool[0m[1;39m([0m[39mint added[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:        if [0m[1;39m([0m[39madded == [0m[1;36m2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:        CompositeExternalParser exParser =[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:                [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:                        context[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:        if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        if [0m[1;39m([0m[39madded == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:            [0m[1;35mparsers.remove[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:        Set<MediaType> supported = new [0m                                         [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:        Set<MediaType> newSupported = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:        for [0m[1;39m([0m[39mMediaType m : supported[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mm.getSubtype[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"jpeg"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:                [0m[1;35mnewSupported.add[0m[1;39m([0m[39mm[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[32m"exiftool"[0m[39m, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39mnewSupported[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:        [0m[1;35mmetadata.remove[0m[1;39m([0m[32m"exiftool_path"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:        Map<MediaType, Parser> updated = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:        for [0m[1;39m([0m[39mMap.Entry<MediaType, Parser> e : [0m[1;35mexParser.getParsers[0m[1;39m([0m[1;39m)[0m[1;35m.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:            if [0m[1;39m([0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m instanceof ExternalParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:                ExternalParser p = [0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m [0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:                if [0m[1;39m([0m[1;35mExternalParser.check[0m[1;39m([0m[1;35mp.getCommand[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:                    for [0m[1;39m([0m[39mMediaType mediaType : [0m[1;35mp.getSupportedTypes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:                        [0m[1;35mupdated.put[0m[1;39m([0m[39mmediaType, p[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:        [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m451[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:150[0m[39m-[0m[1;36m200[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        return [0m[1;35mcheck[0m[1;39m([0m[39mnew String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[39mcheckCmd[0m[1;39m}[0m[39m, errorValue[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:        if [0m[1;39m([0m[39merrorValue.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            errorValue = new int[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[1;36m127[0m[1;39m}[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            Thread stdErrSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            Thread stdOutSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getInputStream[0m[1;39m([0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;35mstdErrSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:            [0m[1;35mstdOutSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            [0m[35m/[0m[35m/[0m[95mmake[0m[39m the timeout parameterizable[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            boolean finished = [0m[1;35mprocess.waitFor[0m[1;39m([0m[1;36m60000[0m[39m, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39m!finished[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                throw new [0m[1;35mTimeoutException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            int result = [0m[1;35mprocess.exitValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"exit value for [0m[32m{[0m[32m}[0m[32m: [0m[32m{[0m[32m}[0m[32m"[0m[39m, checkCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, result[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            for [0m[1;39m([0m[39mint err : errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                if [0m[1;39m([0m[39mresult == err[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                    return false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:            return true;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException | InterruptedException | TimeoutException e[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"exception trying to run  "[0m[39m + checkCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, e[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            [0m[35m/[0m[35m/[0m[39m Some problem, command is there or is broken[0m                      [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            return false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSecurityException se[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:            [0m[35m/[0m[35m/[0m[39m External process execution is banned by the security manager[0m     [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:            throw se;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mError err[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            if [0m[1;39m([0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[39m != null && [0m                                    [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"posix_spawn"[0m[1;39m)[0m[39m ||[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:                    [0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"UNIXProcess"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                [0m[1;35mLOG.debug[0m[1;39m([0m[32m"[0m[32m([0m[32mTIKA-1526[0m[32m)[0m[32m: exception trying to run: "[0m[39m + [0m           [2m                [0m
[2;36m                    [0m         [39mcheckCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, err[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:                [0m[35m/[0m[35m/[0m[39m"Error forking command due to JVM locale bug[0m                  [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                [0m[35m/[0m[35m/[0m[1;39m([0m[39msee TIKA-[0m[1;36m1526[0m[39m and SOLR-[0m[1;36m6387[0m[1;39m)[0m[39m"[0m                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                return false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            [0m[35m/[0m[35m/[0m[95mthrow[0m[39m if a different kind of error[0m                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            throw err;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:            if [0m[1;39m([0m[39mprocess != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;35mprocess.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:215[0m[39m-[0m[1;36m228[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    public String[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetCommand[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        return command;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:     * Sets the command to be run. This can include either of[0m                   [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:     * [0m[1;39m{[0m[39m@link #IN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m[39m or [0m[1;39m{[0m[39m@link #OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m                  [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:     * if the command needs filenames.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:     * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    public void [0m[1;35msetCommand[0m[1;39m([0m[39mString[0m[33m...[0m[39m command[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        this.command = command;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:453[0m[39m-[0m[1;36m471[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m453[0m[39m:    private ExternalParser [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m454[0m[39m:        CompositeExternalParser exParser =[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m455[0m[39m:                [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m456[0m[39m:                        context[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m457[0m[39m:        if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m458[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:        for [0m[1;39m([0m[39mParser p : [0m[1;35mexParser.getAllComponentParsers[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:            if [0m[1;39m([0m[39mp instanceof ExternalParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:                String[0m[1;39m[[0m[1;39m][0m[39m args = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m p[0m[1;39m)[0m[1;35m.getCommand[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m463[0m[39m:                for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < args.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m464[0m[39m:                    if [0m[1;39m([0m[39margs[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[32m"exiftool"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m465[0m[39m:                        return [0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m p;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m467[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:386[0m[39m-[0m[1;36m408[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    private int [0m[1;35mconfigureExifTool[0m[1;39m([0m[39mString path[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:        int retVal = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:            CompositeExternalParser exParser =[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:                    [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:                            context[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:            if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:                [0m[35m/[0m[35m/[0m[95mlasciate[0m[39m ogne speranza[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:                return [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:            exifToolParser = new [0m[1;35mExternalParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:            retVal = [0m[1;36m1[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:            [0m[1;35mparsers.put[0m[1;39m([0m[39mJPEG, exifToolParser[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:            [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:        Set<MediaType> supported = new [0m                                         [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:        [0m[1;35msupported.add[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[39mpath, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39msupported[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:        return retVal;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/AutoDetectParserConfig.jav[0m[1;92ma:1[0m[39m-[0m[1;36m100[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.w3c.dom.Element;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.tika.config.ConfigBase;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.tika.exception.TikaConfigException;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractorFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.metadata.writefilter.MetadataWriteFilterFactory;[0m          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.sax.ContentHandlerDecoratorFactory;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: * This config object can be used to tune how conservative we want to be[0m         [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * when parsing data that is extremely compressible and resembles a ZIP[0m          [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: * bomb. Null values will be ignored and will not affect the default values[0m      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: * in SecureContentHandler.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m: * <p>[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m: *     See <a [0m                                                                   [2m                [0m
[2;36m                    [0m         [33mhref[0m[39m=[0m[32m"https[0m[32m://cwiki.apache.org/confluence/display/TIKA/ModifyingContentWithHandlers[0m [2m                [0m
[2;36m                    [0m         [32mAndMetadataFilters"[0m[35m/[0m[39m>ModifyingContentWithHandlersAndMetadataFilters<[0m[35m/[0m[95ma[0m[39m>[0m             [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m: *     for documentation and examples for configuring this with a [0m               [2m                [0m
[2;36m                    [0m         [39mtika-config.xml file.[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:public class AutoDetectParserConfig extends ConfigBase implements Serializable [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private static ContentHandlerDecoratorFactory [0m                               [2m                [0m
[2;36m                    [0m         [39mNOOP_CONTENT_HANDLER_DECORATOR_FACTORY =[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:            new [0m[1;35mContentHandlerDecoratorFactory[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                @Override[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                public ContentHandler [0m[1;35mdecorate[0m[1;39m([0m[39mContentHandler contentHandler, [0m   [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                                               ParseContext parseContext[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                    return contentHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            [0m[1;39m}[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public static AutoDetectParserConfig DEFAULT = new [0m[1;35mAutoDetectParserConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public static AutoDetectParserConfig [0m[1;35mload[0m[1;39m([0m[39mElement element[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            throws TikaConfigException, IOException [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mAutoDetectParserConfig.buildSingle[0m[1;39m([0m[32m"autoDetectParserConfig"[0m[39m,[0m      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:                AutoDetectParserConfig.class, element, [0m                          [2m                [0m
[2;36m                    [0m         [39mAutoDetectParserConfig.DEFAULT[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * If this is not null and greater than [0m[1;36m-1[0m[39m, the AutoDetectParser[0m             [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * will spool the stream to disk if the length of the stream is known[0m        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * ahead of time.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private Long spoolToDisk = null;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * SecureContentHandler -- Desired output threshold in characters.[0m           [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    private Long outputThreshold = null;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * SecureContentHandler -- Desired maximum compression ratio.[0m                [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private Long maximumCompressionRatio = null;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     * SecureContentHandler -- Desired maximum XML nesting level.[0m                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private Integer maximumDepth = null;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * SecureContentHandler -- Desired maximum package entry nesting level.[0m      [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private Integer maximumPackageEntryDepth = null;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    private MetadataWriteFilterFactory metadataWriteFilterFactory = null;[0m        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    private EmbeddedDocumentExtractorFactory embeddedDocumentExtractorFactory = [0m [2m                [0m
[2;36m                    [0m         [39mnull;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    private ContentHandlerDecoratorFactory contentHandlerDecoratorFactory =[0m      [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            NOOP_CONTENT_HANDLER_DECORATOR_FACTORY;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    private DigestingParser.DigesterFactory digesterFactory = null;[0m              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    private boolean throwOnZeroBytes = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * Creates a SecureContentHandlerConfig using the passed in parameters.[0m      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:19[0m[39m-[0m[1;36m53[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.net.MalformedURLException;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.xml.sax.Attributes;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.xml.sax.helpers.AttributesImpl;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.metadata.HTML;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.metadata.Office;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.parser.external.CompositeExternalParser;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.parser.external.ExternalParser;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.sax.TextContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:55[0m[39m-[0m[1;36m100[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m55:c[0m[39mlass HtmlHandler extends TextContentHandler [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[35m/[0m[35m/[0m[39m List of attributes that need to be resolved.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    private static final Set<String> URI_ATTRIBUTES =[0m                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            new HashSet<>[0m[1;39m([0m[1;35mArrays.asList[0m[1;39m([0m[32m"src"[0m[39m, [0m[32m"href"[0m[39m, [0m[32m"longdesc"[0m[39m, [0m[32m"cite"[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private static final Pattern ICBM =[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            [0m[1;35mPattern.compile[0m[1;39m([0m[32m"\\s*[0m[32m([0m[32m-?\\d+\\.\\d+[0m[32m)[0m[32m[[0m[32m,\\s[0m[32m][0m[32m+[0m[32m([0m[32m-?\\d+\\.\\d+[0m[32m)[0m[32m\\s*"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final Map<String, Property> META_[0m[1;33mHEAD[0m[39mER_MAPPINGS = new [0m       [2m                [0m
[2;36m                    [0m         [39mHashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    private static final MediaType JPEG = [0m[1;35mMediaType.image[0m[1;39m([0m[32m"jpeg"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    static [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"author"[0m[39m, TikaCoreProperties.CREATOR[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"title"[0m[39m, TikaCoreProperties.TITLE[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"subject"[0m[39m, TikaCoreProperties.SUBJECT[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"keywords"[0m[39m, Office.KEYWORDS[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"description"[0m[39m, TikaCoreProperties.DESCRIPTION[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    private static final Attributes EMPTY_ATTS = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private final HtmlMapper mapper;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    private final XHTMLContentHandler xhtml;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private final Metadata metadata;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private final ParseContext context;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private final boolean extractScripts;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private final StringBuilder title = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    private final DataURISchemeUtil dataURISchemeUtil = new [0m[1;35mDataURISchemeUtil[0m[1;39m([0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private final StringBuilder script = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private int bodyLevel = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    private int discardLevel = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    private int titleLevel = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    private int scriptLevel = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private Attributes scriptAtts = EMPTY_ATTS;[0m[35m/[0m[35m/[0m[95mattributes[0m[39m from outermost [0m      [2m                [0m
[2;36m                    [0m         [39mscript element[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    private boolean isTitleSetToMetadata = false;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    private [0m[1;35mHtmlHandler[0m[1;39m([0m[39mHtmlMapper mapper, XHTMLContentHandler xhtml, Metadata [0m  [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                        ParseContext context, boolean extractScripts[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mxhtml[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        this.mapper = mapper;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        this.xhtml = xhtml;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        this.metadata = metadata;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        this.context = context;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        this.extractScripts = extractScripts;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[35m/[0m[35m/[0m[39m Try to determine the default base URL, if one has not been given[0m      [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[39mMetadata.CONTENT_LOCATION[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                name = [0m[1;35mname.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:190[0m[39m-[0m[1;36m236[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    private void [0m[1;35maddHtmlMetadata[0m[1;39m([0m[39mString name, String value[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        [0m[35m/[0m[35m/[0m[95mnote[0m[39m that [0m[32m"name"[0m[39m derives from attributes and is not uppercased[0m        [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[35m/[0m[35m/[0m[95mlike[0m[39m the elements by the XHTMLDowngradeHandler[0m                        [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || [0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[32m"ICBM"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            Matcher m = [0m[1;35mICBM.matcher[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            if [0m[1;39m([0m[1;35mm.matches[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[32m"ICBM"[0m[39m, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m + [0m[32m", "[0m[39m + [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.LATITUDE, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.LONGITUDE, [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[32m"ICBM"[0m[39m, value[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[39mMetadata.CONTENT_TYPE[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[35m/[0m[35m/[0m[95mdon[0m[39m't overwrite Metadata.CONTENT_TYPE![0m                            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            MediaType type = [0m[1;35mMediaType.parse[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_HINT, [0m             [2m                [0m
[2;36m                    [0m         [1;35mtype.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_HINT, value[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        String lcName = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.US[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        if [0m[1;39m([0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.containsKey[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            Property property = [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.get[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            if [0m[1;39m([0m[1;35mproperty.equals[0m[1;39m([0m[39mTikaCoreProperties.TITLE[0m[1;39m)[0m[39m && [0m                   [2m                [0m
[2;36m                    [0m         [39misTitleSetToMetadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                [0m[35m/[0m[35m/[0m[95mprefer[0m[39m the title element if it is already set[0m                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                [0m[35m/[0m[35m/[0m[95mdo[0m[39m nothing[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + [0m                           [2m                [0m
[2;36m                    [0m         [1;35mTikaCoreProperties.TITLE.getName[0m[1;39m([0m[1;39m)[0m[39m, value[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mproperty.isMultiValuePermitted[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + name, value[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:280[0m[39m-[0m[1;36m350[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    private void [0m[1;35mparse[0m[1;39m([0m[39mTikaInputStream stream, XHTMLContentHandler xhtml, [0m      [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                       TemporaryResources tmp[0m[1;39m)[0m[39m throws IOException, [0m             [2m                [0m
[2;36m                    [0m         [39mSAXException, TikaException [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        boolean inputToStdIn = true;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        boolean outputFromStdOut = true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        boolean hasPatterns = [0m[1;39m([0m[39mmetadataPatterns != null && [0m                     [2m                [0m
[2;36m                    [0m         [39m![0m[1;35mmetadataPatterns.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:        File output = null;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build our command[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                inputToStdIn = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                output = [0m[1;35mtmp.createTemporaryFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                outputFromStdOut = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m[1;35moutput.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:            if [0m[1;39m([0m[39minputToStdIn[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:                [0m[1;35msendInput[0m[1;39m([0m[39mprocess, stream[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:                [0m[1;35mprocess.getOutputStream[0m[1;39m([0m[1;39m)[0m[1;35m.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:            InputStream out = [0m[1;35mprocess.getInputStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:            InputStream err = [0m[1;35mprocess.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:            if [0m[1;39m([0m[39mhasPatterns[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:                [0m[1;35mextractMetadata[0m[1;39m([0m[39merr, metadata[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:                if [0m[1;39m([0m[39moutputFromStdOut[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:                    [0m[1;35mextractOutput[0m[1;39m([0m[39mout, xhtml[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:                    [0m[1;35mextractMetadata[0m[1;39m([0m[39mout, metadata[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:                [0m[1;35mignoreStream[0m[1;39m([0m[39merr[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:                if [0m[1;39m([0m[39moutputFromStdOut[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:                    [0m[1;35mextractOutput[0m[1;39m([0m[39mout, xhtml[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:                    [0m[1;35mignoreStream[0m[1;39m([0m[39mout[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:                [0m[1;35mprocess.waitFor[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException ignore[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/metadata/HTML.jav[0m[1;92ma:1[0m[39m-[0m[1;36m29[0m                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:package org.apache.tika.metadata; [0m[35m/[0m[39m*[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: * [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:public interface HTML [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:    String PREFIX_HTML_META = [0m[32m"html_meta"[0m[39m + [0m                                     [2m                [0m
[2;36m                    [0m         [39mTikaCoreProperties.NAMESPACE_PREFIX_DELIMITER;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:     * If a script element contains a src value, this value[0m                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:     * is set in the embedded document's metadata[0m                                [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:    Property SCRIPT_SOURCE = [0m[1;35mProperty.internalText[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:            PREFIX_HTML_META + [0m[32m"scriptSrc"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:136[0m[39m-[0m[1;36m150[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        if [0m[1;39m([0m[39mbodyLevel == [0m[1;36m0[0m[39m && discardLevel == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            if [0m[1;39m([0m[32m"META"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m && [0m[1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                [0m[35m/[0m[35m/[0m[39m TIKA-[0m[1;36m478[0m[39m: For cases where we have either a name or[0m           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                [0m[35m/[0m[35m/[0m[39m [0m[32m"http-equiv"[0m[39m, assume that XHTMLContentHandler will emit[0m      [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                [0m[35m/[0m[35m/[0m[39m these in the <head>, thus passing them through safely.[0m       [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                if [0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"http-equiv"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:                    [0m[1;35maddHtmlMetadata[0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"http-equiv"[0m[1;39m)[0m[39m, [0m               [2m                [0m
[2;36m                    [0m         [1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"name"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                    [0m[35m/[0m[35m/[0m[39m Record the meta tag in the metadata[0m                      [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:                    [0m[1;35maddHtmlMetadata[0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"name"[0m[1;39m)[0m[39m, [0m                     [2m                [0m
[2;36m                    [0m         [1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"property"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                    [0m[35m/[0m[35m/[0m[39m TIKA-[0m[1;36m983[0m[39m: Handle <meta [0m[33mproperty[0m[39m=[0m[32m"og[0m[32m:xxx"[0m[39m [0m[33mcontent[0m[39m=[0m[32m"yyy"[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [35m/[0m[39m> tags[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:                    [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + [0m                       [2m                [0m
[2;36m                    [0m         [1;35matts.getValue[0m[1;39m([0m[32m"property"[0m[1;39m)[0m[39m, [0m[1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[32m"BASE"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m && [0m[1;35matts.getValue[0m[1;39m([0m[32m"href"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:354[0m[39m-[0m[1;36m384[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    private void [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        DataURIScheme dataURIScheme = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            dataURIScheme = [0m[1;35mdataURISchemeUtil.parse[0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mDataURISchemeParseException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:362[0m[39m-[0m[1;36m408[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    private int [0m[1;35mconfigureExifTool[0m[1;39m([0m[39mString path[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:        int retVal = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:            CompositeExternalParser exParser =[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:                    [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:                            context[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:            if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:                [0m[35m/[0m[35m/[0m[95mlasciate[0m[39m ogne speranza[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:                return [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:            exifToolParser = new [0m[1;35mExternalParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:            retVal = [0m[1;36m1[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:            [0m[1;35mparsers.put[0m[1;39m([0m[39mJPEG, exifToolParser[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:            [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:        Set<MediaType> supported = new [0m                                         [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:        [0m[1;35msupported.add[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[39mpath, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39msupported[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:        return retVal;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:308[0m[39m-[0m[1;36m318[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:19[0m[39m-[0m[1;36m53[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.net.MalformedURLException;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.xml.sax.Attributes;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.xml.sax.helpers.AttributesImpl;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.metadata.HTML;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.metadata.Office;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.parser.external.CompositeExternalParser;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.parser.external.ExternalParser;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.sax.TextContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:190[0m[39m-[0m[1;36m236[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    private void [0m[1;35maddHtmlMetadata[0m[1;39m([0m[39mString name, String value[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        [0m[35m/[0m[35m/[0m[95mnote[0m[39m that [0m[32m"name"[0m[39m derives from attributes and is not uppercased[0m        [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[35m/[0m[35m/[0m[95mlike[0m[39m the elements by the XHTMLDowngradeHandler[0m                        [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || [0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[32m"ICBM"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            Matcher m = [0m[1;35mICBM.matcher[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            if [0m[1;39m([0m[1;35mm.matches[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[32m"ICBM"[0m[39m, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m + [0m[32m", "[0m[39m + [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.LATITUDE, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.LONGITUDE, [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[32m"ICBM"[0m[39m, value[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[39mMetadata.CONTENT_TYPE[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[35m/[0m[35m/[0m[95mdon[0m[39m't overwrite Metadata.CONTENT_TYPE![0m                            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            MediaType type = [0m[1;35mMediaType.parse[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_HINT, [0m             [2m                [0m
[2;36m                    [0m         [1;35mtype.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_HINT, value[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        String lcName = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.US[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        if [0m[1;39m([0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.containsKey[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            Property property = [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.get[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            if [0m[1;39m([0m[1;35mproperty.equals[0m[1;39m([0m[39mTikaCoreProperties.TITLE[0m[1;39m)[0m[39m && [0m                   [2m                [0m
[2;36m                    [0m         [39misTitleSetToMetadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                [0m[35m/[0m[35m/[0m[95mprefer[0m[39m the title element if it is already set[0m                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                [0m[35m/[0m[35m/[0m[95mdo[0m[39m nothing[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + [0m                           [2m                [0m
[2;36m                    [0m         [1;35mTikaCoreProperties.TITLE.getName[0m[1;39m([0m[1;39m)[0m[39m, value[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mproperty.isMultiValuePermitted[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + name, value[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:354[0m[39m-[0m[1;36m384[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    private void [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        DataURIScheme dataURIScheme = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            dataURIScheme = [0m[1;35mdataURISchemeUtil.parse[0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mDataURISchemeParseException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:386[0m[39m-[0m[1;36m408[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    private int [0m[1;35mconfigureExifTool[0m[1;39m([0m[39mString path[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:        int retVal = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:            CompositeExternalParser exParser =[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:                    [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:                            context[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:            if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:                [0m[35m/[0m[35m/[0m[95mlasciate[0m[39m ogne speranza[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:                return [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:            exifToolParser = new [0m[1;35mExternalParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:            retVal = [0m[1;36m1[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:            [0m[1;35mparsers.put[0m[1;39m([0m[39mJPEG, exifToolParser[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:            [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:        Set<MediaType> supported = new [0m                                         [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:        [0m[1;35msupported.add[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[39mpath, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39msupported[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:        return retVal;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:410[0m[39m-[0m[1;36m451[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:    private void [0m[1;35mresetExifTool[0m[1;39m([0m[39mint added[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:        if [0m[1;39m([0m[39madded == [0m[1;36m2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:        CompositeExternalParser exParser =[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:                [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:                        context[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:        if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        if [0m[1;39m([0m[39madded == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:            [0m[1;35mparsers.remove[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:        Set<MediaType> supported = new [0m                                         [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:        Set<MediaType> newSupported = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:        for [0m[1;39m([0m[39mMediaType m : supported[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mm.getSubtype[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"jpeg"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:                [0m[1;35mnewSupported.add[0m[1;39m([0m[39mm[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[32m"exiftool"[0m[39m, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39mnewSupported[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:        [0m[1;35mmetadata.remove[0m[1;39m([0m[32m"exiftool_path"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:        Map<MediaType, Parser> updated = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:        for [0m[1;39m([0m[39mMap.Entry<MediaType, Parser> e : [0m[1;35mexParser.getParsers[0m[1;39m([0m[1;39m)[0m[1;35m.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:            if [0m[1;39m([0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m instanceof ExternalParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:                ExternalParser p = [0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m [0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:                if [0m[1;39m([0m[1;35mExternalParser.check[0m[1;39m([0m[1;35mp.getCommand[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:                    for [0m[1;39m([0m[39mMediaType mediaType : [0m[1;35mp.getSupportedTypes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:                        [0m[1;35mupdated.put[0m[1;39m([0m[39mmediaType, p[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:        [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m451[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:280[0m[39m-[0m[1;36m318[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    private void [0m[1;35mparse[0m[1;39m([0m[39mTikaInputStream stream, XHTMLContentHandler xhtml, [0m      [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                       TemporaryResources tmp[0m[1;39m)[0m[39m throws IOException, [0m             [2m                [0m
[2;36m                    [0m         [39mSAXException, TikaException [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        boolean inputToStdIn = true;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        boolean outputFromStdOut = true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        boolean hasPatterns = [0m[1;39m([0m[39mmetadataPatterns != null && [0m                     [2m                [0m
[2;36m                    [0m         [39m![0m[1;35mmetadataPatterns.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:        File output = null;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build our command[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                inputToStdIn = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                output = [0m[1;35mtmp.createTemporaryFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                outputFromStdOut = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m[1;35moutput.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:150[0m[39m-[0m[1;36m200[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        return [0m[1;35mcheck[0m[1;39m([0m[39mnew String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[39mcheckCmd[0m[1;39m}[0m[39m, errorValue[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:        if [0m[1;39m([0m[39merrorValue.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            errorValue = new int[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[1;36m127[0m[1;39m}[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            Thread stdErrSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            Thread stdOutSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getInputStream[0m[1;39m([0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;35mstdErrSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:            [0m[1;35mstdOutSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            [0m[35m/[0m[35m/[0m[95mmake[0m[39m the timeout parameterizable[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            boolean finished = [0m[1;35mprocess.waitFor[0m[1;39m([0m[1;36m60000[0m[39m, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39m!finished[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                throw new [0m[1;35mTimeoutException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            int result = [0m[1;35mprocess.exitValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"exit value for [0m[32m{[0m[32m}[0m[32m: [0m[32m{[0m[32m}[0m[32m"[0m[39m, checkCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, result[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            for [0m[1;39m([0m[39mint err : errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                if [0m[1;39m([0m[39mresult == err[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                    return false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:            return true;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException | InterruptedException | TimeoutException e[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"exception trying to run  "[0m[39m + checkCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, e[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            [0m[35m/[0m[35m/[0m[39m Some problem, command is there or is broken[0m                      [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            return false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSecurityException se[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:            [0m[35m/[0m[35m/[0m[39m External process execution is banned by the security manager[0m     [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:            throw se;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mError err[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            if [0m[1;39m([0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[39m != null && [0m                                    [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"posix_spawn"[0m[1;39m)[0m[39m ||[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:                    [0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"UNIXProcess"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                [0m[1;35mLOG.debug[0m[1;39m([0m[32m"[0m[32m([0m[32mTIKA-1526[0m[32m)[0m[32m: exception trying to run: "[0m[39m + [0m           [2m                [0m
[2;36m                    [0m         [39mcheckCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, err[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:                [0m[35m/[0m[35m/[0m[39m"Error forking command due to JVM locale bug[0m                  [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                [0m[35m/[0m[35m/[0m[1;39m([0m[39msee TIKA-[0m[1;36m1526[0m[39m and SOLR-[0m[1;36m6387[0m[1;39m)[0m[39m"[0m                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                return false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            [0m[35m/[0m[35m/[0m[95mthrow[0m[39m if a different kind of error[0m                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            throw err;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:            if [0m[1;39m([0m[39mprocess != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;35mprocess.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:136[0m[39m-[0m[1;36m150[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        if [0m[1;39m([0m[39mbodyLevel == [0m[1;36m0[0m[39m && discardLevel == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            if [0m[1;39m([0m[32m"META"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m && [0m[1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                [0m[35m/[0m[35m/[0m[39m TIKA-[0m[1;36m478[0m[39m: For cases where we have either a name or[0m           [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                [0m[35m/[0m[35m/[0m[39m [0m[32m"http-equiv"[0m[39m, assume that XHTMLContentHandler will emit[0m      [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                [0m[35m/[0m[35m/[0m[39m these in the <head>, thus passing them through safely.[0m       [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                if [0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"http-equiv"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:                    [0m[1;35maddHtmlMetadata[0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"http-equiv"[0m[1;39m)[0m[39m, [0m               [2m                [0m
[2;36m                    [0m         [1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"name"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                    [0m[35m/[0m[35m/[0m[39m Record the meta tag in the metadata[0m                      [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:                    [0m[1;35maddHtmlMetadata[0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"name"[0m[1;39m)[0m[39m, [0m                     [2m                [0m
[2;36m                    [0m         [1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35matts.getValue[0m[1;39m([0m[32m"property"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                    [0m[35m/[0m[35m/[0m[39m TIKA-[0m[1;36m983[0m[39m: Handle <meta [0m[33mproperty[0m[39m=[0m[32m"og[0m[32m:xxx"[0m[39m [0m[33mcontent[0m[39m=[0m[32m"yyy"[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [35m/[0m[39m> tags[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:                    [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + [0m                       [2m                [0m
[2;36m                    [0m         [1;35matts.getValue[0m[1;39m([0m[32m"property"[0m[1;39m)[0m[39m, [0m[1;35matts.getValue[0m[1;39m([0m[32m"content"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[32m"BASE"[0m[1;35m.equals[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m && [0m[1;35matts.getValue[0m[1;39m([0m[32m"href"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:220[0m[39m-[0m[1;36m236[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        String lcName = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.US[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        if [0m[1;39m([0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.containsKey[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            Property property = [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.get[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            if [0m[1;39m([0m[1;35mproperty.equals[0m[1;39m([0m[39mTikaCoreProperties.TITLE[0m[1;39m)[0m[39m && [0m                   [2m                [0m
[2;36m                    [0m         [39misTitleSetToMetadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                [0m[35m/[0m[35m/[0m[95mprefer[0m[39m the title element if it is already set[0m                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                [0m[35m/[0m[35m/[0m[95mdo[0m[39m nothing[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + [0m                           [2m                [0m
[2;36m                    [0m         [1;35mTikaCoreProperties.TITLE.getName[0m[1;39m([0m[1;39m)[0m[39m, value[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mproperty.isMultiValuePermitted[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + name, value[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:55[0m[39m-[0m[1;36m100[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m55:c[0m[39mlass HtmlHandler extends TextContentHandler [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[35m/[0m[35m/[0m[39m List of attributes that need to be resolved.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    private static final Set<String> URI_ATTRIBUTES =[0m                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            new HashSet<>[0m[1;39m([0m[1;35mArrays.asList[0m[1;39m([0m[32m"src"[0m[39m, [0m[32m"href"[0m[39m, [0m[32m"longdesc"[0m[39m, [0m[32m"cite"[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private static final Pattern ICBM =[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            [0m[1;35mPattern.compile[0m[1;39m([0m[32m"\\s*[0m[32m([0m[32m-?\\d+\\.\\d+[0m[32m)[0m[32m[[0m[32m,\\s[0m[32m][0m[32m+[0m[32m([0m[32m-?\\d+\\.\\d+[0m[32m)[0m[32m\\s*"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final Map<String, Property> META_[0m[1;33mHEAD[0m[39mER_MAPPINGS = new [0m       [2m                [0m
[2;36m                    [0m         [39mHashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    private static final MediaType JPEG = [0m[1;35mMediaType.image[0m[1;39m([0m[32m"jpeg"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    static [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"author"[0m[39m, TikaCoreProperties.CREATOR[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"title"[0m[39m, TikaCoreProperties.TITLE[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"subject"[0m[39m, TikaCoreProperties.SUBJECT[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"keywords"[0m[39m, Office.KEYWORDS[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"description"[0m[39m, TikaCoreProperties.DESCRIPTION[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    private static final Attributes EMPTY_ATTS = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private final HtmlMapper mapper;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    private final XHTMLContentHandler xhtml;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private final Metadata metadata;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private final ParseContext context;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private final boolean extractScripts;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private final StringBuilder title = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    private final DataURISchemeUtil dataURISchemeUtil = new [0m[1;35mDataURISchemeUtil[0m[1;39m([0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private final StringBuilder script = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private int bodyLevel = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    private int discardLevel = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    private int titleLevel = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    private int scriptLevel = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private Attributes scriptAtts = EMPTY_ATTS;[0m[35m/[0m[35m/[0m[95mattributes[0m[39m from outermost [0m      [2m                [0m
[2;36m                    [0m         [39mscript element[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    private boolean isTitleSetToMetadata = false;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    private [0m[1;35mHtmlHandler[0m[1;39m([0m[39mHtmlMapper mapper, XHTMLContentHandler xhtml, Metadata [0m  [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                        ParseContext context, boolean extractScripts[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mxhtml[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        this.mapper = mapper;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        this.xhtml = xhtml;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        this.metadata = metadata;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        this.context = context;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        this.extractScripts = extractScripts;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[35m/[0m[35m/[0m[39m Try to determine the default base URL, if one has not been given[0m      [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[39mMetadata.CONTENT_LOCATION[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                name = [0m[1;35mname.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:190[0m[39m-[0m[1;36m196[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    private void [0m[1;35maddHtmlMetadata[0m[1;39m([0m[39mString name, String value[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        [0m[35m/[0m[35m/[0m[95mnote[0m[39m that [0m[32m"name"[0m[39m derives from attributes and is not uppercased[0m        [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[35m/[0m[35m/[0m[95mlike[0m[39m the elements by the XHTMLDowngradeHandler[0m                        [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || [0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:19[0m[39m-[0m[1;36m53[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.net.MalformedURLException;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.xml.sax.Attributes;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.xml.sax.helpers.AttributesImpl;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.metadata.HTML;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.metadata.Office;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.parser.external.CompositeExternalParser;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.parser.external.ExternalParser;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.sax.TextContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:55[0m[39m-[0m[1;36m100[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m55:c[0m[39mlass HtmlHandler extends TextContentHandler [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[35m/[0m[35m/[0m[39m List of attributes that need to be resolved.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    private static final Set<String> URI_ATTRIBUTES =[0m                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            new HashSet<>[0m[1;39m([0m[1;35mArrays.asList[0m[1;39m([0m[32m"src"[0m[39m, [0m[32m"href"[0m[39m, [0m[32m"longdesc"[0m[39m, [0m[32m"cite"[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private static final Pattern ICBM =[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            [0m[1;35mPattern.compile[0m[1;39m([0m[32m"\\s*[0m[32m([0m[32m-?\\d+\\.\\d+[0m[32m)[0m[32m[[0m[32m,\\s[0m[32m][0m[32m+[0m[32m([0m[32m-?\\d+\\.\\d+[0m[32m)[0m[32m\\s*"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final Map<String, Property> META_[0m[1;33mHEAD[0m[39mER_MAPPINGS = new [0m       [2m                [0m
[2;36m                    [0m         [39mHashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    private static final MediaType JPEG = [0m[1;35mMediaType.image[0m[1;39m([0m[32m"jpeg"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    static [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"author"[0m[39m, TikaCoreProperties.CREATOR[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"title"[0m[39m, TikaCoreProperties.TITLE[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"subject"[0m[39m, TikaCoreProperties.SUBJECT[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"keywords"[0m[39m, Office.KEYWORDS[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.put[0m[1;39m([0m[32m"description"[0m[39m, TikaCoreProperties.DESCRIPTION[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    private static final Attributes EMPTY_ATTS = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    private final HtmlMapper mapper;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    private final XHTMLContentHandler xhtml;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private final Metadata metadata;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private final ParseContext context;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private final boolean extractScripts;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    private final StringBuilder title = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    private final DataURISchemeUtil dataURISchemeUtil = new [0m[1;35mDataURISchemeUtil[0m[1;39m([0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private final StringBuilder script = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private int bodyLevel = [0m[1;36m0[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    private int discardLevel = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    private int titleLevel = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    private int scriptLevel = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private Attributes scriptAtts = EMPTY_ATTS;[0m[35m/[0m[35m/[0m[95mattributes[0m[39m from outermost [0m      [2m                [0m
[2;36m                    [0m         [39mscript element[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    private boolean isTitleSetToMetadata = false;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    private [0m[1;35mHtmlHandler[0m[1;39m([0m[39mHtmlMapper mapper, XHTMLContentHandler xhtml, Metadata [0m  [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                        ParseContext context, boolean extractScripts[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mxhtml[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        this.mapper = mapper;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        this.xhtml = xhtml;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        this.metadata = metadata;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        this.context = context;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        this.extractScripts = extractScripts;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[35m/[0m[35m/[0m[39m Try to determine the default base URL, if one has not been given[0m      [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[39mMetadata.CONTENT_LOCATION[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                name = [0m[1;35mname.trim[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:190[0m[39m-[0m[1;36m236[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:    private void [0m[1;35maddHtmlMetadata[0m[1;39m([0m[39mString name, String value[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:        [0m[35m/[0m[35m/[0m[95mnote[0m[39m that [0m[32m"name"[0m[39m derives from attributes and is not uppercased[0m        [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[35m/[0m[35m/[0m[95mlike[0m[39m the elements by the XHTMLDowngradeHandler[0m                        [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m || [0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[32m"ICBM"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            Matcher m = [0m[1;35mICBM.matcher[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:            if [0m[1;39m([0m[1;35mm.matches[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[32m"ICBM"[0m[39m, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m + [0m[32m", "[0m[39m + [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.LATITUDE, [0m[1;35mm.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.LONGITUDE, [0m[1;35mm.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[32m"ICBM"[0m[39m, value[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        if [0m[1;39m([0m[1;35mname.equalsIgnoreCase[0m[1;39m([0m[39mMetadata.CONTENT_TYPE[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[35m/[0m[35m/[0m[95mdon[0m[39m't overwrite Metadata.CONTENT_TYPE![0m                            [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            MediaType type = [0m[1;35mMediaType.parse[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_HINT, [0m             [2m                [0m
[2;36m                    [0m         [1;35mtype.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_HINT, value[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        String lcName = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.US[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        if [0m[1;39m([0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.containsKey[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            Property property = [0m[1;35mMETA_[0m[1;33mHEAD[0m[1;35mER_MAPPINGS.get[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            if [0m[1;39m([0m[1;35mproperty.equals[0m[1;39m([0m[39mTikaCoreProperties.TITLE[0m[1;39m)[0m[39m && [0m                   [2m                [0m
[2;36m                    [0m         [39misTitleSetToMetadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                [0m[35m/[0m[35m/[0m[95mprefer[0m[39m the title element if it is already set[0m                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                [0m[35m/[0m[35m/[0m[95mdo[0m[39m nothing[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + [0m                           [2m                [0m
[2;36m                    [0m         [1;35mTikaCoreProperties.TITLE.getName[0m[1;39m([0m[1;39m)[0m[39m, value[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mproperty.isMultiValuePermitted[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mmetadata.add[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mproperty, value[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;35mmetadata.add[0m[1;39m([0m[39mHTML.PREFIX_HTML_META + name, value[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:354[0m[39m-[0m[1;36m408[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    private void [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        DataURIScheme dataURIScheme = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            dataURIScheme = [0m[1;35mdataURISchemeUtil.parse[0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mDataURISchemeParseException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    private int [0m[1;35mconfigureExifTool[0m[1;39m([0m[39mString path[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:        ExternalParser exifToolParser = [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:        int retVal = [0m[1;36m0[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:        if [0m[1;39m([0m[39mexifToolParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:            CompositeExternalParser exParser =[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:                    [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:                            context[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:            if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:                [0m[35m/[0m[35m/[0m[95mlasciate[0m[39m ogne speranza[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:                return [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:            exifToolParser = new [0m[1;35mExternalParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:            retVal = [0m[1;36m1[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:            Map<MediaType, Parser> parsers = [0m[1;35mexParser.getParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:            [0m[1;35mparsers.put[0m[1;39m([0m[39mJPEG, exifToolParser[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:            [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:        Set<MediaType> supported = new [0m                                         [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mexifToolParser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:        [0m[1;35msupported.add[0m[1;39m([0m[39mJPEG[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[39mpath, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39msupported[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:        return retVal;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:59[0m[39m-[0m[1;36m94[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:public class ExternalParser implements Parser [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final Logger LOG = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mExternalParser.class[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * The token, which if present in the Command string, will[0m                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * be replaced with the input filename.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * Alternately, the input data can be streamed over STDIN.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    public static final String IN[0m[1;33mPUT[0m[39m_FILE_TOKEN = [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * The token, which if present in the Command string, will[0m                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * be replaced with the output filename.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * Alternately, the output data can be collected on STDOUT.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public static final String OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN = [0m[32m"$[0m[32m{[0m[32mOUT[0m[1;33mPUT[0m[32m}[0m[32m"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private static final long serialVersionUID = -1079128990650687037L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[35m/[0m[35m/[0m[95mmake[0m[39m this parameterizable[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private final long timeoutMs = [0m[1;36m60000[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * Media types supported by the external program.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private Set<MediaType> supportedTypes = [0m[1;35mCollections.emptySet[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     * Regular Expressions to run over STDOUT to[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * extract Metadata.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    private Map<Pattern, String> metadataPatterns = null;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * The external command to invoke.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    private String[0m[1;39m[[0m[1;39m][0m[39m command = new String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[32m"cat"[0m[1;39m}[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:215[0m[39m-[0m[1;36m228[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    public String[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetCommand[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        return command;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:     * Sets the command to be run. This can include either of[0m                   [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:     * [0m[1;39m{[0m[39m@link #IN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m[39m or [0m[1;39m{[0m[39m@link #OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m                  [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:     * if the command needs filenames.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:     * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    public void [0m[1;35msetCommand[0m[1;39m([0m[39mString[0m[33m...[0m[39m command[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        this.command = command;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:280[0m[39m-[0m[1;36m318[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    private void [0m[1;35mparse[0m[1;39m([0m[39mTikaInputStream stream, XHTMLContentHandler xhtml, [0m      [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                       TemporaryResources tmp[0m[1;39m)[0m[39m throws IOException, [0m             [2m                [0m
[2;36m                    [0m         [39mSAXException, TikaException [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        boolean inputToStdIn = true;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        boolean outputFromStdOut = true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        boolean hasPatterns = [0m[1;39m([0m[39mmetadataPatterns != null && [0m                     [2m                [0m
[2;36m                    [0m         [39m![0m[1;35mmetadataPatterns.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:        File output = null;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build our command[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                inputToStdIn = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                output = [0m[1;35mtmp.createTemporaryFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                outputFromStdOut = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m[1;35moutput.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mBased on the evaluation report and code analysis, I need to address both the [0m       [2m                [0m
[2;36m                    [0m         [39mcompilation error and the security vulnerability. The strategy consists of three [0m   [2m                [0m
[2;36m                    [0m         [39mmain components:[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Fix Compilation Error in HtmlHandler[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m`tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-[0m [2m                [0m
[2;36m                    [0m         [39mmodule/src/main/java/org/apache/tika/parser/html/HtmlHandler.java`[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Action:** Add missing logger imports and declaration[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Add imports after line [0m[1;36m31[0m[39m:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m  ```java[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  import org.slf4j.Logger;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m  import org.slf4j.LoggerFactory;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Add logger declaration after line [0m[1;36m64[0m[39m in the class static members area:[0m            [2m                [0m
[2;36m                    [0m         [39m  ```java[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  private static final Logger LOG = [0m[1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mHtmlHandler.class[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis follows the standard SLF4J logging pattern used throughout the Tika codebase [0m  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mas seen in ExternalParser.jav[0m[1;92ma:61[0m[1;39m)[0m[39m.[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Implement Dangerous Metadata Key Filtering in HtmlHandler[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Same file as above, in the `addHtmlMetadata` method[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Action:** Add the dangerous keys set and filtering logic from the previous patch,[0m [2m                [0m
[2;36m                    [0m         [39mwhich now will compile correctly with the logger present.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Add the static set after line [0m[1;36m64[0m[39m:[0m                                                 [2m                [0m
[2;36m                    [0m         [39m  ```java[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  private static final Set<String> DANGEROUS_METADATA_KEYS = new [0m                   [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[1;35mArrays.asList[0m[1;39m([0m                                                            [2m                [0m
[2;36m                    [0m         [39m      [0m[32m"exiftool_path"[0m[39m, [0m[32m"command"[0m[39m, [0m[32m"parser_command"[0m[39m, [0m[32m"external_command"[0m[39m, [0m[32m"exec"[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [32m"shell"[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m  [0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Add the `[0m[1;35misDangerousMetadataKey[0m[1;39m([0m[1;39m)[0m[39m` method after line [0m[1;36m236[0m[39m:[0m                         [2m                [0m
[2;36m                    [0m         [39m  ```java[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  private boolean [0m[1;35misDangerousMetadataKey[0m[1;39m([0m[39mString name[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m      String lcName = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.US[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m      if [0m[1;39m([0m[1;35mDANGEROUS_METADATA_KEYS.contains[0m[1;39m([0m[39mlcName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [39m          return true;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m      return [0m[1;35mlcName.contains[0m[1;39m([0m[32m"command"[0m[1;39m)[0m[39m || [0m                                         [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mlcName.contains[0m[1;39m([0m[32m"exec"[0m[1;39m)[0m[39m || [0m                                            [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m([0m[1;35mlcName.contains[0m[1;39m([0m[32m"path"[0m[1;39m)[0m[39m && [0m[1;39m([0m[1;35mlcName.contains[0m[1;39m([0m[32m"tool"[0m[1;39m)[0m[39m || [0m               [2m                [0m
[2;36m                    [0m         [1;35mlcName.contains[0m[1;39m([0m[32m"parser"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m  [0m[1;39m}[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Add the validation check in `addHtmlMetadata` after line [0m[1;36m196[0m[39m:[0m                     [2m                [0m
[2;36m                    [0m         [39m  ```java[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  if [0m[1;39m([0m[1;35misDangerousMetadataKey[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m      [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Rejected potentially dangerous HTML metadata key: [0m[32m{[0m[32m}[0m[32m"[0m[39m, name[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [39m      return;[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m  [0m[1;39m}[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale:** This prevents attacker-controlled HTML metadata keys from ever being[0m [2m                [0m
[2;36m                    [0m         [39mstored in the metadata object. By filtering at the entry point [0m[1;39m([0m[39maddHtmlMetadata[0m[1;39m)[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [39mwe ensure dangerous keys cannot influence parser configuration later.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Remove Vulnerable ExifTool Configuration Feature[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Same HtmlHandler.java file[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Action:** Remove the entire dynamic exiftool configuration mechanism that allows [0m [2m                [0m
[2;36m                    [0m         [39mHTML metadata to configure external parsers.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- In `handleDataURIScheme` method [0m[1;39m([0m[39mlines [0m[1;36m354[0m[39m-[0m[1;36m384[0m[1;39m)[0m[39m:[0m                                  [2m                [0m
[2;36m                    [0m         [39m  - Remove lines [0m[1;36m362[0m[39m-[0m[1;36m365[0m[39m [0m[1;39m([0m[39mthe check and call to configureExifTool[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m  - Remove the `added` variable declaration [0m[1;39m([0m[39mline [0m[1;36m362[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m  - Remove lines [0m[1;36m380[0m[39m-[0m[1;36m381[0m[39m [0m[1;39m([0m[39mthe finally block with resetExifTool call[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m  - The finally block should be removed entirely if resetExifTool was the only call[0m [2m                [0m
[2;36m                    [0m         [39min it[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Remove three entire methods:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m  - `[0m[1;35mconfigureExifTool[0m[1;39m([0m[39mString path[0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m386[0m[39m-[0m[1;36m408[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m  - `[0m[1;35mresetExifTool[0m[1;39m([0m[39mint added[0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m410[0m[39m-[0m[1;36m451[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [39m  - `[0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m453[0m[39m-[0m[1;36m471[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale:** This feature fundamentally violates security boundaries by allowing [0m [2m                [0m
[2;36m                    [0m         [39mdocument content to configure system-level commands. There is no legitimate use [0m    [2m                [0m
[2;36m                    [0m         [39mcase for HTML documents to specify external tool paths. Removing it eliminates the [0m [2m                [0m
[2;36m                    [0m         [39mentire attack surface.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Harden ExternalParser Command Execution[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m`tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java`[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Action:** Apply the command execution improvements from the previous patch to [0m    [2m                [0m
[2;36m                    [0m         [39mprevent command injection.[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- In the `parse` method [0m[1;39m([0m[39mlines [0m[1;36m280[0m[39m-[0m[1;36m318[0m[1;39m)[0m[39m:[0m                                            [2m                [0m
[2;36m                    [0m         [39m  - Remove the command string splitting logic [0m[1;39m([0m[39mlines [0m[1;36m290[0m[39m-[0m[1;36m291[0m[1;39m)[0m[39m:[0m                      [2m                [0m
[2;36m                    [0m         [39m    ```java[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m    ```[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    Replace with direct array copy for all cases:[0m                                   [2m                [0m
[2;36m                    [0m         [39m    ```java[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m    String[0m[1;39m[[0m[1;39m][0m[39m cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m    ```[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m  - Remove the dual execution path [0m[1;39m([0m[39mlines [0m[1;36m311[0m[39m-[0m[1;36m315[0m[1;39m)[0m[39m:[0m                                 [2m                [0m
[2;36m                    [0m         [39m    ```java[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [39m        process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    ```[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m    Replace with single safe execution:[0m                                             [2m                [0m
[2;36m                    [0m         [39m    ```java[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m    process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m    ```[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- In the `check` method [0m[1;39m([0m[39mlines [0m[1;36m154[0m[39m-[0m[1;36m161[0m[1;39m)[0m[39m:[0m                                            [2m                [0m
[2;36m                    [0m         [39m  - Replace `[0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m` with `ProcessBuilder`:[0m            [2m                [0m
[2;36m                    [0m         [39m    ```java[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m    process = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[1;35m.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m    ```[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Add security warning to `setCommand` JavaDoc [0m[1;39m([0m[39mlines [0m[1;36m219[0m[39m-[0m[1;36m225[0m[1;39m)[0m[39m:[0m                     [2m                [0m
[2;36m                    [0m         [39m  ```java[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  [0m[35m/[0m[39m**[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m   * Sets the command to be run. This can include either of[0m                         [2m                [0m
[2;36m                    [0m         [39m   * [0m[1;39m{[0m[39m@link #IN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m[39m or [0m[1;39m{[0m[39m@link #OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m                        [2m                [0m
[2;36m                    [0m         [39m   * if the command needs filenames.[0m                                                [2m                [0m
[2;36m                    [0m         [39m   * [0m                                                                               [2m                [0m
[2;36m                    [0m         [39m   * <p><strong>Security Warning:<[0m[35m/[0m[95mstrong[0m[39m> The command must be from a trusted [0m      [2m                [0m
[2;36m                    [0m         [39msource.[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   * Never set the command based on untrusted input such as document content or[0m     [2m                [0m
[2;36m                    [0m         [39m   * user-controlled metadata. Doing so can lead to arbitrary command execution.[0m    [2m                [0m
[2;36m                    [0m         [39m   *[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   *[0m[35m/[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale:** [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- Removing string splitting forces callers to provide pre-tokenized command arrays,[0m [2m                [0m
[2;36m                    [0m         [39mpreventing space-based injection[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- Using only the array form of Runtime.exec avoids shell interpretation[0m             [2m                [0m
[2;36m                    [0m         [39m- ProcessBuilder in the check method is safer than Runtime.exec[0m                     [2m                [0m
[2;36m                    [0m         [39m- The warning documents the security requirement for future developers[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Implementation Order[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mApply patches in this order to ensure clean compilation:[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Add logger imports and declaration to HtmlHandler [0m[1;39m([0m[39mfixes compilation[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Add dangerous metadata key filtering to HtmlHandler [0m[1;39m([0m[39mdefense-in-depth[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Remove exiftool configuration methods from HtmlHandler [0m[1;39m([0m[39mremoves vulnerable [0m      [2m                [0m
[2;36m                    [0m         [39mfeature[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Harden ExternalParser command execution [0m[1;39m([0m[39madditional security layer[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This is Optimal[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Addresses Root Cause:** The primary vulnerability is that HTML content [0m        [2m                [0m
[2;36m                    [0m         [39mcontrols system commands. Removing the exiftool configuration feature eliminates [0m   [2m                [0m
[2;36m                    [0m         [39mthis entirely.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Defense in Depth:** Metadata filtering provides an additional security layer [0m  [2m                [0m
[2;36m                    [0m         [39meven if similar vulnerabilities exist elsewhere in the codebase.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Minimal Breaking Changes:** The removed feature [0m[1;39m([0m[39mdynamic exiftool [0m             [2m                [0m
[2;36m                    [0m         [39mconfiguration via HTML metadata[0m[1;39m)[0m[39m has no legitimate use case - HTML documents should[0m [2m                [0m
[2;36m                    [0m         [39mnot configure system tools.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserves Existing Logic:** [0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - Normal HTML parsing continues to work[0m                                          [2m                [0m
[2;36m                    [0m         [39m   - Legitimate metadata [0m[1;39m([0m[39mauthor, title, keywords[0m[1;39m)[0m[39m is still extracted[0m               [2m                [0m
[2;36m                    [0m         [39m   - External parsers configured via system configuration still work[0m                [2m                [0m
[2;36m                    [0m         [39m   - Only the dangerous dynamic reconfiguration is removed[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Follows Existing Patterns:**[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - Logger pattern matches ExternalParser and other Tika classes[0m                   [2m                [0m
[2;36m                    [0m         [39m   - Metadata filtering follows the case-insensitive comparison pattern at line [0m[1;36m221[0m [2m                [0m
[2;36m                    [0m         [39m   - Uses existing imports [0m[1;39m([0m[39mLocale, HashSet, Arrays[0m[1;39m)[0m[39m already in the class[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses Issues[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Initial Issue [0m[1;39m([0m[39mCommand Injection[0m[1;39m)[0m[39m:**[0m                                              [2m                [0m
[2;36m                    [0m         [39m- Removing exiftool configuration eliminates the code path where HTML metadata [0m     [2m                [0m
[2;36m                    [0m         [39mreaches ExternalParser.setCommand[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- Filtering dangerous keys prevents similar vulnerabilities if other code paths [0m    [2m                [0m
[2;36m                    [0m         [39mexist[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- ExternalParser hardening prevents exploitation even if dangerous commands are set[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Compilation Error:**[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- Adding Logger and LoggerFactory imports/declaration fixes the missing symbol [0m     [2m                [0m
[2;36m                    [0m         [39merror[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- Follows standard SLF4J pattern used throughout the codebase[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Side Effects and Mitigation[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects:**[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Lost Functionality:** Users who relied on html_met[0m[1;92ma:e[0m[39mxiftool_path to configure[0m [2m                [0m
[2;36m                    [0m         [39mexiftool dynamically will need to use system configuration instead[0m                  [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation:** This is intentional - configuration should come from trusted [0m  [2m                [0m
[2;36m                    [0m         [39msources, not document content[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - **Impact:** Improves security posture significantly[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Metadata Filtering:** Some HTML meta tags with command-related names will be [0m  [2m                [0m
[2;36m                    [0m         [39mrejected[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation:** Only dangerous patterns are blocked; legitimate metadata like [0m [2m                [0m
[2;36m                    [0m         [32m"author"[0m[39m, [0m[32m"title"[0m[39m continues to work[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - **Impact:** Minimal - HTML documents shouldn't contain metadata keys like [0m     [2m                [0m
[2;36m                    [0m         [32m"exiftool_path"[0m[39m or [0m[32m"command"[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **ExternalParser Changes:** Commands must be pre-tokenized arrays, not [0m          [2m                [0m
[2;36m                    [0m         [39mspace-separated strings[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation:** This is safer and forces proper command construction[0m           [2m                [0m
[2;36m                    [0m         [39m   - **Impact:** Existing configuration files/code that use pre-tokenized arrays [0m   [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mthe recommended approach[0m[1;39m)[0m[39m continue to work[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe external2 package [0m[1;39m([0m[39mExternalParser.java in tika-core[0m[1;39m)[0m[39m already demonstrates the [0m  [2m                [0m
[2;36m                    [0m         [39msafer approach:[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- Uses ProcessBuilder [0m[1;39m([0m[39mline [0m[1;36m130[0m[39m, [0m[1;36m134[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39m- Uses ProcessUtils.escapeCommandLine for proper escaping [0m[1;39m([0m[39mlines [0m[1;36m115[0m[39m, [0m[1;36m120[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m- Requires pre-tokenized commands[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- This patch brings the older ExternalParser closer to the safer external2 [0m         [2m                [0m
[2;36m                    [0m         [39mimplementation[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=871189;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=994317;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=294289;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=915019;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpbgkl8xdg[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-delta-01_vuln_9/[0m[95magent[0m [2m               [0m
[2;36m                    [0m         [95m-output-1767724779.8105433[0m                                                           [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-no-delta/tika_tk-delta-01_vuln_9.toml   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/06/26 18:41:50][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mtika[0m           ]8;id=921070;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=640658;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=600469;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=554701;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m                  [2m               [0m
[2;36m[01/06/26 18:41:51][0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=552510;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=885472;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mtika[0m                   [2m               [0m
