{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-delta-07_vuln_013",
  "source_directory": "/home/qqor/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 1.730538,
    "prompt_tokens": 509716,
    "completion_tokens": 13426
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-gvcp.c\n+++ b/epan/dissectors/packet-gvcp.c\n@@ -981,6 +981,11 @@\n \tuint32_t value = 0;\n \t\n \tvalue = tvb_get_letohl(tvb, offset);\n+\t\n+\tif (gvcp_register_count >= GVCP_MAX_REGISTER_COUNT) {\n+\t\treturn 0;\n+\t}\n+\t\n \tgvcp_register_number[gvcp_register_count] = addr;\n \tgvcp_register_value[gvcp_register_count++] = value;\n \n@@ -1496,6 +1501,11 @@\n \tuint32_t value = 0;\n \t\n \tvalue = tvb_get_letohl(tvb, offset);\n+\t\n+\tif (gvcp_register_count >= GVCP_MAX_REGISTER_COUNT) {\n+\t\treturn 0;\n+\t}\n+\t\n \tgvcp_register_number[gvcp_register_count] = addr;\n \tgvcp_register_value[gvcp_register_count++] = value;\n \n@@ -1700,6 +1710,10 @@\n \tint offset = startoffset;\n \tint i;\n \tint num_registers = length / 4;\n+\t\n+\tif (num_registers > GVCP_MAX_REGISTER_COUNT) {\n+\t\tnum_registers = GVCP_MAX_REGISTER_COUNT;\n+\t}\n \n \taddr = tvb_get_ntohl(tvb, offset);\n \taddress_string = get_register_name_from_address(addr, pinfo->pool, gvcp_info, &is_custom_register);\n@@ -1782,6 +1796,10 @@\n \tbool is_custom_register = false;\n \tint num_registers = length / 8; /* divide by 8 because we are counting register-value pairs */\n \tproto_tree *subtree = NULL;\n+\n+\tif (num_registers > GVCP_MAX_REGISTER_COUNT) {\n+\t\tnum_registers = GVCP_MAX_REGISTER_COUNT;\n+\t}\n \n \tif (gvcp_trans)\n \t{\n@@ -2273,6 +2291,10 @@\n \n \toffset = startoffset;\n \tnum_registers = length / 4;\n+\t\n+\tif (num_registers > GVCP_MAX_REGISTER_COUNT) {\n+\t\tnum_registers = GVCP_MAX_REGISTER_COUNT;\n+\t}\n \n \tif (gvcp_trans && gvcp_trans->addr_list)\n \t{\n@@ -2733,6 +2755,9 @@\n \t\tgvcp_trans = wmem_new0(pinfo->pool, gvcp_transaction_t);\n \t}\n \n+\t/* Reset register count for each packet */\n+\tgvcp_register_count = 0;\n+\n \t/* Add telegram subtree */\n \tgvcp_telegram_tree = proto_item_add_subtree(gvcp_tree, ett_gvcp);\n \n",
  "stdout": "",
  "stderr": ""
}