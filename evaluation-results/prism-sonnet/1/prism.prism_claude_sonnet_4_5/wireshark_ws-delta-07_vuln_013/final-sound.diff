--- a/epan/dissectors/packet-gvcp.c
+++ b/epan/dissectors/packet-gvcp.c
@@ -981,6 +981,11 @@
 	uint32_t value = 0;
 	
 	value = tvb_get_letohl(tvb, offset);
+	
+	if (gvcp_register_count >= GVCP_MAX_REGISTER_COUNT) {
+		return 0;
+	}
+	
 	gvcp_register_number[gvcp_register_count] = addr;
 	gvcp_register_value[gvcp_register_count++] = value;
 
@@ -1496,6 +1501,11 @@
 	uint32_t value = 0;
 	
 	value = tvb_get_letohl(tvb, offset);
+	
+	if (gvcp_register_count >= GVCP_MAX_REGISTER_COUNT) {
+		return 0;
+	}
+	
 	gvcp_register_number[gvcp_register_count] = addr;
 	gvcp_register_value[gvcp_register_count++] = value;
 
@@ -1700,6 +1710,10 @@
 	int offset = startoffset;
 	int i;
 	int num_registers = length / 4;
+	
+	if (num_registers > GVCP_MAX_REGISTER_COUNT) {
+		num_registers = GVCP_MAX_REGISTER_COUNT;
+	}
 
 	addr = tvb_get_ntohl(tvb, offset);
 	address_string = get_register_name_from_address(addr, pinfo->pool, gvcp_info, &is_custom_register);
@@ -1782,6 +1796,10 @@
 	bool is_custom_register = false;
 	int num_registers = length / 8; /* divide by 8 because we are counting register-value pairs */
 	proto_tree *subtree = NULL;
+
+	if (num_registers > GVCP_MAX_REGISTER_COUNT) {
+		num_registers = GVCP_MAX_REGISTER_COUNT;
+	}
 
 	if (gvcp_trans)
 	{
@@ -2273,6 +2291,10 @@
 
 	offset = startoffset;
 	num_registers = length / 4;
+	
+	if (num_registers > GVCP_MAX_REGISTER_COUNT) {
+		num_registers = GVCP_MAX_REGISTER_COUNT;
+	}
 
 	if (gvcp_trans && gvcp_trans->addr_list)
 	{
@@ -2733,6 +2755,9 @@
 		gvcp_trans = wmem_new0(pinfo->pool, gvcp_transaction_t);
 	}
 
+	/* Reset register count for each packet */
+	gvcp_register_count = 0;
+
 	/* Add telegram subtree */
 	gvcp_telegram_tree = proto_item_add_subtree(gvcp_tree, ett_gvcp);
 
