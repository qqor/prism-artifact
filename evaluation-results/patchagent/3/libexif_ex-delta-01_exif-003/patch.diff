diff --git a/libexif/apple/exif-mnote-data-apple.c b/libexif/apple/exif-mnote-data-apple.c
index 83a9cb1..2af2cf1 100644
--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -235,12 +235,14 @@ exif_mnote_data_apple_get_value(ExifMnoteData *md, unsigned int i, char *val, un
 
 int
 exif_mnote_data_apple_identify(const ExifData *ed, const ExifEntry *e) {
-    int variant;
+    const char identifier[] = "Apple iOS";
+    size_t id_len = sizeof(identifier) - 1;
+    int variant = 0;
 
-    if (!strcmp((const char *) e->data, "Apple iOS")) {
+    /* Ensure data buffer is large enough before comparing */
+    if (e && e->data && e->size >= id_len &&
+        memcmp((const char *)e->data, identifier, id_len) == 0) {
         variant = 1;
-    } else {
-        variant = 0;
     }
 
     return variant;
