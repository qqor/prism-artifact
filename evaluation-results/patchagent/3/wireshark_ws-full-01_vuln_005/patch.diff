diff --git a/epan/dissectors/packet-bat.c b/epan/dissectors/packet-bat.c
index 06d8674..000332f 100644
--- a/epan/dissectors/packet-bat.c
+++ b/epan/dissectors/packet-bat.c
@@ -662,13 +662,14 @@ static void dissect_bat_vis_v24(tvbuff_t *tvb, packet_info *pinfo, proto_tree *t
 	vis_packeth->tq_max = tvb_get_uint8(tvb, offset++);
 	vis_packeth_raw_data_size = tvb_get_uint32(tvb, offset++, 0);
 	offset += 4;
-	if ((unsigned long)vis_packeth_raw_data_size > sizeof(vis_packeth_raw_data))
+    if ((unsigned long)vis_packeth_raw_data_size > sizeof(vis_packeth_raw_data) - 1)
 		return;
 
 	for (i=0; i < vis_packeth_raw_data_size; i++) {
 		vis_packeth_raw_data[i] = tvb_get_uint8(tvb, offset);
 		offset++;
 	}
+    vis_packeth_raw_data[vis_packeth_raw_data_size] = '\0';
 
 	/* set protocol name */
 	col_set_str(pinfo->cinfo, COL_PROTOCOL, "BAT_VIS");
@@ -701,8 +702,10 @@ static void dissect_bat_vis_v24(tvbuff_t *tvb, packet_info *pinfo, proto_tree *t
 		/*offset += 1;*/
 	}
 
-	if ((vis_packeth_raw_data_size > 4) && (strlen(vis_packeth_raw_data) > 4))
-		fprintf(stderr, d_output_buffer);
+    if ((vis_packeth_raw_data_size > 4) && (strlen(vis_packeth_raw_data) > 4)) {
+        /* Print output safely */
+        fprintf(stderr, "%s", d_output_buffer);
+    }
 
 	tap_queue_packet(bat_tap, pinfo, vis_packeth);
 
