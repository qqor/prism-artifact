diff --git a/libfreerdp/crypto/certificate.c b/libfreerdp/crypto/certificate.c
index 30820bb..e7dda3e 100644
--- a/libfreerdp/crypto/certificate.c
+++ b/libfreerdp/crypto/certificate.c
@@ -1534,9 +1534,9 @@ static BOOL freerdp_bio_read_pem_with_policy(BIO* bio, char** ppem, size_t* plen
 	WINPR_ASSERT(bio);
 	WINPR_ASSERT(ppem);
 
-	const uint16_t blocksize = 2048;
-	uint16_t offset = 0;
-	uint16_t length = blocksize;
+    const size_t blocksize = 2048;
+    size_t offset = 0;
+    size_t length = blocksize;
 	char* pem = NULL;
 
 	*ppem = NULL;
@@ -1545,7 +1545,7 @@ static BOOL freerdp_bio_read_pem_with_policy(BIO* bio, char** ppem, size_t* plen
 
 	while (status != 0)
 	{
-		char* tmp = realloc(pem, length + 1);
+        char* tmp = (char*)realloc(pem, length + 1);
 		if (!tmp)
 			goto fail;
 
@@ -1556,7 +1556,7 @@ static BOOL freerdp_bio_read_pem_with_policy(BIO* bio, char** ppem, size_t* plen
 		status = BIO_read(bio, &pem[offset], (int)(length - offset));
 		if (status < 0)
 		{
-			WLog_ERR(TAG, "failed to read certificate");
+            WLog_ERR(TAG, "failed to read certificate");
 			goto fail;
 		}
 
@@ -1564,13 +1564,13 @@ static BOOL freerdp_bio_read_pem_with_policy(BIO* bio, char** ppem, size_t* plen
 			break;
 
 		offset += (size_t)status;
-		length += blocksize;
+        length += blocksize;
 
 	}
 	pem[offset] = '\0';
 	*ppem = pem;
 	if (plength)
-		*plength = offset;
+        *plength = offset;
 	rc = TRUE;
 fail:
 	if (!rc)
