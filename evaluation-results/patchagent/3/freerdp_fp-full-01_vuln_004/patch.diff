diff --git a/libfreerdp/core/gcc.c b/libfreerdp/core/gcc.c
index d135d83..9657157 100644
--- a/libfreerdp/core/gcc.c
+++ b/libfreerdp/core/gcc.c
@@ -1854,16 +1854,23 @@ BOOL gcc_read_client_network_data(wStream* s, rdpMcs* mcs)
 	if (blockLength < 4)
 		return FALSE;
 
-	Stream_Read_UINT8(s, mcs->channelCount); /* channelCount */
+    /* Read channel count into local variable and validate bounds */
+    UINT8 channelCount = 0;
+    Stream_Read_UINT8(s, channelCount); /* channelCount */
+    if (channelCount > CHANNEL_MAX_COUNT)
+        return FALSE;
 
-	if (blockLength < 4 + (UINT8)mcs->channelCount * 12)
-		return FALSE;
+    /* Compute required buffer for all channel entries:
+       name[CHANNEL_NAME_LEN+1] + options (4 bytes) each */
+    const size_t perChannelSize = (CHANNEL_NAME_LEN + 1) + sizeof(UINT32);
+    if (blockLength < 4 + (size_t)channelCount * perChannelSize)
+        return FALSE;
 
-	if (mcs->channelCount > CHANNEL_MAX_COUNT)
-		return FALSE;
+    /* Store validated channel count in mcs */
+    mcs->channelCount = (INT8)channelCount;
 
-	/* channelDefArray */
-	for (UINT32 i = 0; i < mcs->channelCount; i++)
+
+    for (UINT32 i = 0; i < (UINT32)channelCount; i++)
 	{
 		/**
 		 * CHANNEL_DEF
