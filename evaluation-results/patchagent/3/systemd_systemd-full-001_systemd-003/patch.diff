diff --git a/src/libsystemd/sd-journal/catalog.c b/src/libsystemd/sd-journal/catalog.c
index a8d65ea..b534aa7 100644
--- a/src/libsystemd/sd-journal/catalog.c
+++ b/src/libsystemd/sd-journal/catalog.c
@@ -159,8 +159,14 @@ static int finish_item(
         assert(h);
         assert(payload);
         assert(payload_size > 0);
-        if (payload[0] == ((ILLEGAL_CAT_ENTRY%10) + '0')){
-                payload[ILLEGAL_CAT_ENTRY*100] = '\0';
+        /* Safely handle illegal catalog entries indicated by payload[0] */
+        {
+                int illegal = ILLEGAL_CAT_ENTRY;
+                if (payload[0] == ((illegal % 10) + '0')) {
+                        size_t offset = (size_t)illegal * 100;
+                        if (offset < payload_size)
+                                payload[offset] = '\0';
+                }
         }
 
         i = new0(CatalogItem, 1);
