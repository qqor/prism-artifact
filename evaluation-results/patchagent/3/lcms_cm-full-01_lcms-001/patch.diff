diff --git a/src/cmslut.c b/src/cmslut.c
index f117747..0ace86d 100644
--- a/src/cmslut.c
+++ b/src/cmslut.c
@@ -1227,7 +1227,11 @@ cmsUInt32Number  CMSEXPORT cmsStageOutputChannels(const cmsStage* mpe)
 
 cmsStageSignature CMSEXPORT cmsStageType(const cmsStage* mpe)
 {
-    return mpe -> Type;
+    if (mpe == NULL) {
+        // Avoid null dereference when stage pointer is NULL
+        return (cmsStageSignature)0;
+    }
+    return mpe->Type;
 }
 
 void* CMSEXPORT cmsStageData(const cmsStage* mpe)
diff --git a/src/cmsps2.c b/src/cmsps2.c
index cb2db85..0115168 100644
--- a/src/cmsps2.c
+++ b/src/cmsps2.c
@@ -756,9 +756,18 @@ int EmitCIEBasedDEF(cmsIOHANDLER* m, cmsPipeline* Pipeline, cmsUInt32Number Inte
     const char* PreMaj;
     const char* PostMaj;
     const char* PreMin, *PostMin;
-    cmsStage* mpe;
-        
-    mpe = Pipeline->Elements;
+    // Validate pipeline to prevent null dereference
+    if (Pipeline == NULL) {
+        cmsSignalError(m->ContextID, cmsERROR_COLORSPACE_CHECK,
+                       "EmitCIEBasedDEF: Pipeline is NULL");
+        return 0;
+    }
+    cmsStage* mpe = Pipeline->Elements;
+    if (mpe == NULL) {
+        cmsSignalError(m->ContextID, cmsERROR_COLORSPACE_CHECK,
+                       "EmitCIEBasedDEF: Pipeline has no stages");
+        return 0;
+    }
 
     switch (cmsStageInputChannels(mpe)) {
     case 3:
