diff --git a/lib/file.c b/lib/file.c
index 7440b3c..04ebbf7 100644
--- a/lib/file.c
+++ b/lib/file.c
@@ -491,9 +491,9 @@ static CURLcode file_do(struct Curl_easy *data, bool *done)
       return result;
 
     if(data->req.no_body) {
-      headerlen =
-      msnprintf(header, sizeof(no_body), "%s (%ld bytes) \r\n",
-                  no_body, expected_size);
+      /* prevent overflow: use proper buffer size */
+      headerlen = msnprintf(header, sizeof(header), "%s (%ld bytes) \r\n",
+                            no_body, expected_size);
       result = Curl_client_write(data, CLIENTWRITE_HEADER, header, headerlen);
     }
     else {
