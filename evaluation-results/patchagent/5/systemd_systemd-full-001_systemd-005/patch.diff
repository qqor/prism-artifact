diff --git a/src/basic/alloc-util.h b/src/basic/alloc-util.h
index ef92a95..9b35aa5 100644
--- a/src/basic/alloc-util.h
+++ b/src/basic/alloc-util.h
@@ -103,7 +103,12 @@ static inline void unsetp(void *p) {
 }
 
 static inline void freep(void *p) {
-        free(*(void**) p);
+        // Safely free the referenced pointer and reset to NULL to prevent double free or dangling pointer
+        void *ptr = *(void**) p;
+        if (ptr) {
+                free(ptr);
+                *(void**) p = NULL;
+        }
 }
 
 #define _cleanup_free_ _cleanup_(freep)
