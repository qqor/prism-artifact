diff --git a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java
index 4f30741..72ea2fe 100644
--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java
+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java
@@ -214,13 +214,21 @@ final class Type1Parser
             // 0 1 255 {1 index exch /.notdef put } for
             // we have to check "readonly" and "def" too
             // as some fonts don't provide any dup-values, see PDFBOX-2134
-            while (!(lexer.peekKind(Token.NAME)
-                    && (lexer.peekToken().getText().equals("dup")
-                            || lexer.peekToken().getText().equals("readonly")
-                            || lexer.peekToken().getText().equals("def"))))
+            while (lexer.peekToken() != null
+                   && !(lexer.peekKind(Token.NAME)
+                        && ("dup".equals(lexer.peekToken().getText())
+                            || "readonly".equals(lexer.peekToken().getText())
+                            || "def".equals(lexer.peekToken().getText()))))
             {
                 lexer.nextToken();
             }
+            if (!lexer.peekKind(Token.NAME)
+                || (!"dup".equals(lexer.peekToken().getText())
+                    && !"readonly".equals(lexer.peekToken().getText())
+                    && !"def".equals(lexer.peekToken().getText())))
+            {
+                throw new IOException("Missing 'dup', 'readonly' or 'def' in encoding array");
+            }
             
             Map<Integer, String> codeToName = new HashMap<>();
             while (lexer.peekKind(Token.NAME) &&
