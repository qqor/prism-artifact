diff --git a/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java b/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
index 0922124..d1c42ec 100644
--- a/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
@@ -31,8 +31,8 @@ import org.apache.commons.compress.archivers.tar.TarArchiveInputStream;
 public class TikaUntar {
 
     public static void main(String[] args) throws IOException {
-        Path inputFile = Paths.get(args[0]);
-        Path extractDir = Paths.get(args[1]);
+        Path inputFile = Paths.get(args[0]).toAbsolutePath().normalize();
+        Path extractDir = Paths.get(args[1]).toAbsolutePath().normalize();
         try (InputStream is = Files.newInputStream(inputFile);
                 TarArchiveInputStream tais = new TarArchiveInputStream(is)) {
 
@@ -41,6 +41,10 @@ public class TikaUntar {
             while (tae != null) {
                 if (tae.isFile()) {
                     Path target = extractDir.resolve(tae.getName()).normalize();
+                    if (!target.startsWith(extractDir)) {
+                        tae = tais.getNextEntry();
+                        continue;
+                    }
                     if (!Files.isDirectory(target.getParent())) {
                         Files.createDirectories(target.getParent());
                     }
