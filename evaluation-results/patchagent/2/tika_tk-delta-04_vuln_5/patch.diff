diff --git a/tika-pipes/tika-emitters/tika-emitter-fs/src/main/java/org/apache/tika/pipes/emitter/fs/FileSystemEmitter.java b/tika-pipes/tika-emitters/tika-emitter-fs/src/main/java/org/apache/tika/pipes/emitter/fs/FileSystemEmitter.java
index 9142c9b..3fdf9ca 100644
--- a/tika-pipes/tika-emitters/tika-emitter-fs/src/main/java/org/apache/tika/pipes/emitter/fs/FileSystemEmitter.java
+++ b/tika-pipes/tika-emitters/tika-emitter-fs/src/main/java/org/apache/tika/pipes/emitter/fs/FileSystemEmitter.java
@@ -84,7 +84,11 @@ public class FileSystemEmitter extends AbstractEmitter implements StreamEmitter
             emitKey += "." + fileExtension;
         }
         if (basePath != null) {
-            output = basePath.resolve(emitKey);
+            Path resolved = basePath.resolve(emitKey).toAbsolutePath().normalize();
+            if (!resolved.startsWith(basePath)) {
+                throw new TikaEmitterException("Invalid path traversal: " + emitKey);
+            }
+            output = resolved;
         } else {
             output = Paths.get(emitKey);
         }
@@ -144,7 +148,10 @@ public class FileSystemEmitter extends AbstractEmitter implements StreamEmitter
 
     @Override
     public void emit(String path, InputStream inputStream, Metadata userMetadata, ParseContext parseContext) throws IOException, TikaEmitterException {
-        Path target = basePath.resolve(path);
+        Path target = basePath.resolve(path).toAbsolutePath().normalize();
+        if (!target.startsWith(basePath)) {
+            throw new TikaEmitterException("Invalid path traversal: " + path);
+        }
 
         if (!Files.isDirectory(target.getParent())) {
             Files.createDirectories(target.getParent());
