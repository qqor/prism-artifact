diff --git a/src/cmsps2.c b/src/cmsps2.c
index cb2db85..dcb059a 100644
--- a/src/cmsps2.c
+++ b/src/cmsps2.c
@@ -757,7 +757,13 @@ int EmitCIEBasedDEF(cmsIOHANDLER* m, cmsPipeline* Pipeline, cmsUInt32Number Inte
     const char* PostMaj;
     const char* PreMin, *PostMin;
     cmsStage* mpe;
-        
+    /* Sanity check to avoid null pointer dereference if pipeline or elements are NULL */
+    if (Pipeline == NULL || Pipeline->Elements == NULL) {
+        /* No stages to emit */
+        return 0;
+    }
+    
+    
     mpe = Pipeline->Elements;
 
     switch (cmsStageInputChannels(mpe)) {
@@ -792,7 +798,8 @@ int EmitCIEBasedDEF(cmsIOHANDLER* m, cmsPipeline* Pipeline, cmsUInt32Number Inte
         mpe = mpe ->Next;
     }
 
-    if (cmsStageType(mpe) == cmsSigCLutElemType) {
+    /* Ensure mpe not null before type check to avoid null dereference */
+    if (mpe != NULL && cmsStageType(mpe) == cmsSigCLutElemType) {
 
             _cmsIOPrintf(m, "/Table ");
             WriteCLUT(m, mpe, PreMaj, PostMaj, PreMin, PostMin, FALSE, (cmsColorSpaceSignature) 0);
