diff --git a/libfreerdp/codec/rfx.c b/libfreerdp/codec/rfx.c
index 3b9168a..1130f72 100644
--- a/libfreerdp/codec/rfx.c
+++ b/libfreerdp/codec/rfx.c
@@ -670,14 +670,18 @@ static INLINE BOOL rfx_process_message_frame_begin(RFX_CONTEXT* WINPR_RESTRICT c
 
 	Stream_Read_UINT32(
 	    s, frameIdx); /* frameIdx (4 bytes), if codec is in video mode, must be ignored */
-	Stream_Read_UINT16(s, numRegions); /* numRegions (2 bytes) */
-	if (Stream_GetRemainingLength(s) >= 8)
-	{
-	        UINT64 blockOffset = 0;
-	        Stream_Read_UINT64(s, blockOffset);
-	        Stream_Read_UINT64(s, metadataData);
-	        metadataBlock += blockOffset;
-	}
+  Stream_Read_UINT16(s, numRegions); /* numRegions (2 bytes) */
+  /* Skip unsupported metadata: read and discard safely if present */
+  if (Stream_GetRemainingLength(s) >= (sizeof(UINT64) * 2))
+  {
+        UINT64 blockOffset = 0;
+        UINT64 metadataValue = 0;
+        Stream_Read_UINT64(s, blockOffset);
+        Stream_Read_UINT64(s, metadataValue);
+        /* Discard values to avoid invalid memory access */
+        (void)blockOffset;
+        (void)metadataValue;
+  }
 	WLog_Print(context->priv->log, WLOG_DEBUG,
 	           "RFX_FRAME_BEGIN: frameIdx: %" PRIu32 " numRegions: %" PRIu16 "", frameIdx,
 	           numRegions);
@@ -731,7 +735,11 @@ static INLINE BOOL rfx_process_message_metadata(RFX_CONTEXT* WINPR_RESTRICT cont
 		WLog_Print(context->priv->log, WLOG_ERROR, "invalid magic number 0x%08" PRIX32 "", magic);
 		return FALSE;
 	}
-	*(UINT64*)metadataBlock = metadataData;
+  /* Metadata write unsupported: skip writing to metadataBlock */
+  (void)metadataBlock;
+  (void)metadataData;
+  /* future implementation may handle metadata safely */
+  
 	return TRUE;
 }
 
