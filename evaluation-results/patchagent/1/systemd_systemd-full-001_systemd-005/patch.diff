diff --git a/src/basic/alloc-util.h b/src/basic/alloc-util.h
index ef92a95..88222ef 100644
--- a/src/basic/alloc-util.h
+++ b/src/basic/alloc-util.h
@@ -103,7 +103,10 @@ static inline void unsetp(void *p) {
 }
 
 static inline void freep(void *p) {
-        free(*(void**) p);
+        /* Free the pointer, then reset it to NULL to avoid dangling pointers and double frees */
+        void **pp = (void**) p;
+        free(*pp);
+        *pp = NULL;
 }
 
 #define _cleanup_free_ _cleanup_(freep)
