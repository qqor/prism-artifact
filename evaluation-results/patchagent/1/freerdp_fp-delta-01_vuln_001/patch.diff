diff --git a/libfreerdp/crypto/certificate.c b/libfreerdp/crypto/certificate.c
index 30820bb..95a6f39 100644
--- a/libfreerdp/crypto/certificate.c
+++ b/libfreerdp/crypto/certificate.c
@@ -1534,9 +1534,10 @@ static BOOL freerdp_bio_read_pem_with_policy(BIO* bio, char** ppem, size_t* plen
 	WINPR_ASSERT(bio);
 	WINPR_ASSERT(ppem);
 
-	const uint16_t blocksize = 2048;
-	uint16_t offset = 0;
-	uint16_t length = blocksize;
+    /* Use size_t for buffer lengths to safely handle large PEM data */
+    const size_t blocksize = 2048;
+    size_t offset = 0;
+    size_t length = blocksize;
 	char* pem = NULL;
 
 	*ppem = NULL;
