diff --git a/epan/dissectors/packet-zbee-zdp-management.c b/epan/dissectors/packet-zbee-zdp-management.c
index ab5f41d..2afec03 100644
--- a/epan/dissectors/packet-zbee-zdp-management.c
+++ b/epan/dissectors/packet-zbee-zdp-management.c
@@ -203,7 +203,7 @@ dissect_zbee_zdp_req_mgmt_nwk_disc(tvbuff_t *tvb, packet_info *pinfo, proto_tree
     channels = channels_and_flags & 0xff;
 
     /* bounds check */
-    if (channels > max_channel_count)
+    if (channels >= max_channel_count)
         return;
 
     channels_arr = (struct ZBChannel**)malloc(sizeof(struct ZBChannel*) * max_channel_count);
@@ -239,13 +239,16 @@ dissect_zbee_zdp_req_mgmt_nwk_disc(tvbuff_t *tvb, packet_info *pinfo, proto_tree
         if (first)
             proto_item_append_text(ti, "None");
         if (channels_and_flags & 0xfff4131b) {
-            for (i=0; i <= channels; i++) {
-                printf("DEBUG:\t(0x%x/0x%x)\t%d / 0x%x\t%s\n",
-                        i, channels,
-                        channels_arr[i]->channel_id,
-                        channels_arr[i]->channels,
-                        channels_arr[i]->free_text,
-                        channels_arr[i]->text);
+            for (i = 0; i <= channels; i++) {
+                const char *dbg_text = "";
+                if (channels_arr[i] && channels_arr[i]->text)
+                    dbg_text = channels_arr[i]->text;
+                printf("DEBUG:\t(0x%x/0x%x)\t%u / 0x%x\t%u\t%s\n",
+                       (unsigned)i, channels,
+                       channels_arr[i] ? channels_arr[i]->channel_id : 0u,
+                       channels_arr[i] ? channels_arr[i]->channels : 0u,
+                       channels_arr[i] ? channels_arr[i]->free_text : 0u,
+                       dbg_text);
             }
         }
     }
