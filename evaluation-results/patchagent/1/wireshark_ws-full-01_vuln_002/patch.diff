diff --git a/epan/dissectors/packet-telnet.c b/epan/dissectors/packet-telnet.c
index 9f003e3..f30cafd 100644
--- a/epan/dissectors/packet-telnet.c
+++ b/epan/dissectors/packet-telnet.c
@@ -636,8 +636,13 @@ static void
 dissect_linemode_subopt(packet_info *pinfo, const char *optname _U_, tvbuff_t *tvb _U_, int offset _U_,
                     int len _U_, proto_tree *tree _U_, proto_item *item _U_)
 {
-  if ( hf_telnet_naws_subopt_set )
-    wmem_free(pinfo->pool, hf_naws_data);
+    /* On linemode suboption, free any existing NAWS data to prevent use-after-free */
+    if (hf_telnet_naws_subopt_set) {
+        wmem_free(pinfo->pool, hf_naws_data);
+        hf_naws_data = NULL;
+        hf_telnet_naws_subopt_set = 0;
+        hf_telnet_line = 0;
+    }
 
   return;
 }
@@ -646,6 +651,12 @@ static void
 dissect_naws_subopt(packet_info *pinfo _U_, const char *optname _U_, tvbuff_t *tvb, int offset,
                     int len _U_, proto_tree *tree, proto_item *item _U_)
 {
+    /* Free previous NAWS data if already set, to avoid stale pointer and leaks */
+    if (hf_telnet_naws_subopt_set) {
+        wmem_free(pinfo->pool, hf_naws_data);
+        hf_naws_data = NULL;
+        hf_telnet_line = 0;
+    }
   hf_telnet_width = tvb_get_uint16(tvb, offset, ENC_BIG_ENDIAN);
   hf_telnet_height = tvb_get_uint16(tvb, offset + 2, ENC_BIG_ENDIAN);
 
