diff --git a/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java b/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
index 0922124..f9c4ac8 100644
--- a/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
@@ -41,8 +41,13 @@ public class TikaUntar {
             while (tae != null) {
                 if (tae.isFile()) {
                     Path target = extractDir.resolve(tae.getName()).normalize();
-                    if (!Files.isDirectory(target.getParent())) {
-                        Files.createDirectories(target.getParent());
+                    if (!target.startsWith(extractDir)) {
+                        tae = tais.getNextEntry();
+                        continue;
+                    }
+                    Path parent = target.getParent();
+                    if (parent != null && !Files.isDirectory(parent)) {
+                        Files.createDirectories(parent);
                     }
                     Files.write(target, tais.readAllBytes());
                 }
