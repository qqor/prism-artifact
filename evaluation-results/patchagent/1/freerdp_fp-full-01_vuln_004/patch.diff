diff --git a/libfreerdp/core/gcc.c b/libfreerdp/core/gcc.c
index d135d83..debfef2 100644
--- a/libfreerdp/core/gcc.c
+++ b/libfreerdp/core/gcc.c
@@ -1854,13 +1854,19 @@ BOOL gcc_read_client_network_data(wStream* s, rdpMcs* mcs)
 	if (blockLength < 4)
 		return FALSE;
 
-	Stream_Read_UINT8(s, mcs->channelCount); /* channelCount */
-
-	if (blockLength < 4 + (UINT8)mcs->channelCount * 12)
-		return FALSE;
-
-	if (mcs->channelCount > CHANNEL_MAX_COUNT)
-		return FALSE;
+   {
+       UINT8 channelCount = 0;
+       /* Read channel count */
+       Stream_Read_UINT8(s, channelCount); /* channelCount */
+       /* Validate channel count does not exceed limit */
+       if (channelCount > CHANNEL_MAX_COUNT)
+           return FALSE;
+       /* Validate total block length for channel definitions */
+       if (blockLength < 4 + (size_t)channelCount * 12)
+           return FALSE;
+       /* Assign validated channel count */
+       mcs->channelCount = (INT8)channelCount;
+   }
 
 	/* channelDefArray */
 	for (UINT32 i = 0; i < mcs->channelCount; i++)
